<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 2 Régression sur composantes | Régression en grande dimension</title>
  <meta name="description" content="Chapitre 2 Régression sur composantes | Régression en grande dimension" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 2 Régression sur composantes | Régression en grande dimension" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 2 Régression sur composantes | Régression en grande dimension" />
  
  
  

<meta name="author" content="Laurent Rouvière" />


<meta name="date" content="2020-06-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro-grande-dim.html"/>
<link rel="next" href="reg-pen.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Régression en grande dimension<br> <br> L. Rouvière</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Présentation</a></li>
<li class="chapter" data-level="1" data-path="intro-grande-dim.html"><a href="intro-grande-dim.html"><i class="fa fa-check"></i><b>1</b> Introduction à la grande dimension</a><ul>
<li class="chapter" data-level="1.1" data-path="intro-grande-dim.html"><a href="intro-grande-dim.html#fléau-de-la-dimension-pour-les-plus-proches-voisins"><i class="fa fa-check"></i><b>1.1</b> Fléau de la dimension pour les plus proches voisins</a></li>
<li class="chapter" data-level="1.2" data-path="intro-grande-dim.html"><a href="intro-grande-dim.html#influence-de-la-dimension-dans-le-modèle-linéaire"><i class="fa fa-check"></i><b>1.2</b> Influence de la dimension dans le modèle linéaire</a></li>
<li class="chapter" data-level="1.3" data-path="intro-grande-dim.html"><a href="intro-grande-dim.html#exercices"><i class="fa fa-check"></i><b>1.3</b> Exercices</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reg-comp.html"><a href="reg-comp.html"><i class="fa fa-check"></i><b>2</b> Régression sur composantes</a><ul>
<li class="chapter" data-level="2.1" data-path="reg-comp.html"><a href="reg-comp.html#sélection-de-variables"><i class="fa fa-check"></i><b>2.1</b> Sélection de variables</a></li>
<li class="chapter" data-level="2.2" data-path="reg-comp.html"><a href="reg-comp.html#régression-sur-composantes-principales-méthodo"><i class="fa fa-check"></i><b>2.2</b> Régression sur composantes principales (méthodo)</a></li>
<li class="chapter" data-level="2.3" data-path="reg-comp.html"><a href="reg-comp.html#régression-pls-méthodo"><i class="fa fa-check"></i><b>2.3</b> Régression PLS : méthodo</a></li>
<li class="chapter" data-level="2.4" data-path="reg-comp.html"><a href="reg-comp.html#comparaison-pcr-vs-pls."><i class="fa fa-check"></i><b>2.4</b> Comparaison : PCR vs PLS.</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="reg-pen.html"><a href="reg-pen.html"><i class="fa fa-check"></i><b>3</b> Régressions pénalisées (ou sous contraintes)</a><ul>
<li class="chapter" data-level="3.1" data-path="reg-pen.html"><a href="reg-pen.html#ridge-et-lasso-avec-glmnet"><i class="fa fa-check"></i><b>3.1</b> Ridge et lasso avec glmnet</a></li>
<li class="chapter" data-level="3.2" data-path="reg-pen.html"><a href="reg-pen.html#reconstruction-dun-signal"><i class="fa fa-check"></i><b>3.2</b> Reconstruction d’un signal</a></li>
<li class="chapter" data-level="3.3" data-path="reg-pen.html"><a href="reg-pen.html#régression-logistique-pénalisée"><i class="fa fa-check"></i><b>3.3</b> Régression logistique pénalisée</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mod-add.html"><a href="mod-add.html"><i class="fa fa-check"></i><b>4</b> Modèle additif</a><ul>
<li class="chapter" data-level="4.1" data-path="mod-add.html"><a href="mod-add.html#pseudo-backfitting"><i class="fa fa-check"></i><b>4.1</b> Pseudo backfitting</a></li>
<li class="chapter" data-level="4.2" data-path="mod-add.html"><a href="mod-add.html#modèle-gam"><i class="fa fa-check"></i><b>4.2</b> Modèle GAM</a></li>
<li class="chapter" data-level="4.3" data-path="mod-add.html"><a href="mod-add.html#régression-logistique-additive"><i class="fa fa-check"></i><b>4.3</b> Régression logistique additive</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="références.html"><a href="références.html"><i class="fa fa-check"></i>Références</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Régression en grande dimension</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="reg-comp" class="section level1">
<h1><span class="header-section-number">Chapitre 2</span> Régression sur composantes</h1>
<p>Les performances des estimateurs classiques (MCO) des paramètres du modèle linéaire</p>
<p><span class="math display">\[Y=\beta_0+\beta_1X_1+\dots+\beta_dX_d+\varepsilon\]</span>
peuvent se dégrader lorsque la dimension <span class="math inline">\(d\)</span> est grande ou en présence de dépendance linéaire entre les variables explicatives. Les régressions sur composantes consistent à trouver de nouvelles composantes <span class="math inline">\(Z_k,j=k,\dots,q\)</span> avec <span class="math inline">\(q\leq p\)</span> qui s’écrivent le plus souvent comme des combinaisons linéaires des <span class="math inline">\(X_j\)</span> dans l’idée de diminuer le nombre de paramètres du modèlé ou la dépendance entre les covariables. Il existe plusieurs façons de construire ces composantes, dans cette partie nous proposons :</p>
<ul>
<li>la <strong>régression sous composantes principales (PCR)</strong> : il s’agit de faire simplement une ACP sur la matrice des variables explicatives ;</li>
<li>la <strong>régression partial least square (PLS)</strong> qui fait intervenir la variable cible dans la construction des composantes.</li>
</ul>
<p>Nous commençons par un bref rappel sur la sélection de variables.</p>
<div id="sélection-de-variables" class="section level2">
<h2><span class="header-section-number">2.1</span> Sélection de variables</h2>
<p>On considère le jeu de données <code>ozone.txt</code> où on cherche à expliquer la concentration maximale en ozone relevée sur une journée (variable <code>maxO3</code>) par d’autres variables essentiellement météorologiques.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="reg-comp.html#cb18-1"></a><span class="op">&gt;</span><span class="st"> </span>ozone &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;data/ozone.txt&quot;</span>)</span>
<span id="cb18-2"><a href="reg-comp.html#cb18-2"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(ozone)</span>
<span id="cb18-3"><a href="reg-comp.html#cb18-3"></a>         maxO3   T9  T12  T15 Ne9 Ne12 Ne15     Vx9    Vx12    Vx15 maxO3v</span>
<span id="cb18-4"><a href="reg-comp.html#cb18-4"></a><span class="dv">20010601</span>    <span class="dv">87</span> <span class="fl">15.6</span> <span class="fl">18.5</span> <span class="fl">18.4</span>   <span class="dv">4</span>    <span class="dv">4</span>    <span class="dv">8</span>  <span class="fl">0.6946</span> <span class="fl">-1.7101</span> <span class="fl">-0.6946</span>     <span class="dv">84</span></span>
<span id="cb18-5"><a href="reg-comp.html#cb18-5"></a><span class="dv">20010602</span>    <span class="dv">82</span> <span class="fl">17.0</span> <span class="fl">18.4</span> <span class="fl">17.7</span>   <span class="dv">5</span>    <span class="dv">5</span>    <span class="dv">7</span> <span class="fl">-4.3301</span> <span class="fl">-4.0000</span> <span class="fl">-3.0000</span>     <span class="dv">87</span></span>
<span id="cb18-6"><a href="reg-comp.html#cb18-6"></a><span class="dv">20010603</span>    <span class="dv">92</span> <span class="fl">15.3</span> <span class="fl">17.6</span> <span class="fl">19.5</span>   <span class="dv">2</span>    <span class="dv">5</span>    <span class="dv">4</span>  <span class="fl">2.9544</span>  <span class="fl">1.8794</span>  <span class="fl">0.5209</span>     <span class="dv">82</span></span>
<span id="cb18-7"><a href="reg-comp.html#cb18-7"></a><span class="dv">20010604</span>   <span class="dv">114</span> <span class="fl">16.2</span> <span class="fl">19.7</span> <span class="fl">22.5</span>   <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">0</span>  <span class="fl">0.9848</span>  <span class="fl">0.3473</span> <span class="fl">-0.1736</span>     <span class="dv">92</span></span>
<span id="cb18-8"><a href="reg-comp.html#cb18-8"></a><span class="dv">20010605</span>    <span class="dv">94</span> <span class="fl">17.4</span> <span class="fl">20.5</span> <span class="fl">20.4</span>   <span class="dv">8</span>    <span class="dv">8</span>    <span class="dv">7</span> <span class="fl">-0.5000</span> <span class="fl">-2.9544</span> <span class="fl">-4.3301</span>    <span class="dv">114</span></span>
<span id="cb18-9"><a href="reg-comp.html#cb18-9"></a><span class="dv">20010606</span>    <span class="dv">80</span> <span class="fl">17.7</span> <span class="fl">19.8</span> <span class="fl">18.3</span>   <span class="dv">6</span>    <span class="dv">6</span>    <span class="dv">7</span> <span class="fl">-5.6382</span> <span class="fl">-5.0000</span> <span class="fl">-6.0000</span>     <span class="dv">94</span></span>
<span id="cb18-10"><a href="reg-comp.html#cb18-10"></a>          vent pluie</span>
<span id="cb18-11"><a href="reg-comp.html#cb18-11"></a><span class="dv">20010601</span>  Nord   Sec</span>
<span id="cb18-12"><a href="reg-comp.html#cb18-12"></a><span class="dv">20010602</span>  Nord   Sec</span>
<span id="cb18-13"><a href="reg-comp.html#cb18-13"></a><span class="dv">20010603</span>   Est   Sec</span>
<span id="cb18-14"><a href="reg-comp.html#cb18-14"></a><span class="dv">20010604</span>  Nord   Sec</span>
<span id="cb18-15"><a href="reg-comp.html#cb18-15"></a><span class="dv">20010605</span> Ouest   Sec</span>
<span id="cb18-16"><a href="reg-comp.html#cb18-16"></a><span class="dv">20010606</span> Ouest Pluie</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p>Ajuster un modèle linéaire avec <code>lm</code> et analyser la pertinence des variables explicatives dans le modèle.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="reg-comp.html#cb19-1"></a><span class="op">&gt;</span><span class="st"> </span>lin.complet &lt;-<span class="st"> </span><span class="kw">lm</span>(maxO3<span class="op">~</span>.,<span class="dt">data=</span>ozone)</span>
<span id="cb19-2"><a href="reg-comp.html#cb19-2"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">summary</span>(lin.complet)</span>
<span id="cb19-3"><a href="reg-comp.html#cb19-3"></a></span>
<span id="cb19-4"><a href="reg-comp.html#cb19-4"></a>Call<span class="op">:</span></span>
<span id="cb19-5"><a href="reg-comp.html#cb19-5"></a><span class="kw">lm</span>(<span class="dt">formula =</span> maxO3 <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> ozone)</span>
<span id="cb19-6"><a href="reg-comp.html#cb19-6"></a></span>
<span id="cb19-7"><a href="reg-comp.html#cb19-7"></a>Residuals<span class="op">:</span></span>
<span id="cb19-8"><a href="reg-comp.html#cb19-8"></a><span class="st">    </span>Min      1Q  Median      3Q     Max </span>
<span id="cb19-9"><a href="reg-comp.html#cb19-9"></a><span class="fl">-51.814</span>  <span class="fl">-8.695</span>  <span class="fl">-1.020</span>   <span class="fl">7.891</span>  <span class="fl">40.046</span> </span>
<span id="cb19-10"><a href="reg-comp.html#cb19-10"></a></span>
<span id="cb19-11"><a href="reg-comp.html#cb19-11"></a>Coefficients<span class="op">:</span></span>
<span id="cb19-12"><a href="reg-comp.html#cb19-12"></a><span class="st">            </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    </span>
<span id="cb19-13"><a href="reg-comp.html#cb19-13"></a>(Intercept) <span class="fl">16.26536</span>   <span class="fl">15.94398</span>   <span class="fl">1.020</span>   <span class="fl">0.3102</span>    </span>
<span id="cb19-14"><a href="reg-comp.html#cb19-14"></a>T9           <span class="fl">0.03917</span>    <span class="fl">1.16496</span>   <span class="fl">0.034</span>   <span class="fl">0.9732</span>    </span>
<span id="cb19-15"><a href="reg-comp.html#cb19-15"></a>T12          <span class="fl">1.97257</span>    <span class="fl">1.47570</span>   <span class="fl">1.337</span>   <span class="fl">0.1844</span>    </span>
<span id="cb19-16"><a href="reg-comp.html#cb19-16"></a>T15          <span class="fl">0.45031</span>    <span class="fl">1.18707</span>   <span class="fl">0.379</span>   <span class="fl">0.7053</span>    </span>
<span id="cb19-17"><a href="reg-comp.html#cb19-17"></a>Ne9         <span class="fl">-2.10975</span>    <span class="fl">0.95985</span>  <span class="fl">-2.198</span>   <span class="fl">0.0303</span> <span class="op">*</span><span class="st">  </span></span>
<span id="cb19-18"><a href="reg-comp.html#cb19-18"></a>Ne12        <span class="fl">-0.60559</span>    <span class="fl">1.42634</span>  <span class="fl">-0.425</span>   <span class="fl">0.6721</span>    </span>
<span id="cb19-19"><a href="reg-comp.html#cb19-19"></a>Ne15        <span class="fl">-0.01718</span>    <span class="fl">1.03589</span>  <span class="fl">-0.017</span>   <span class="fl">0.9868</span>    </span>
<span id="cb19-20"><a href="reg-comp.html#cb19-20"></a>Vx9          <span class="fl">0.48261</span>    <span class="fl">0.98762</span>   <span class="fl">0.489</span>   <span class="fl">0.6262</span>    </span>
<span id="cb19-21"><a href="reg-comp.html#cb19-21"></a>Vx12         <span class="fl">0.51379</span>    <span class="fl">1.24717</span>   <span class="fl">0.412</span>   <span class="fl">0.6813</span>    </span>
<span id="cb19-22"><a href="reg-comp.html#cb19-22"></a>Vx15         <span class="fl">0.72662</span>    <span class="fl">0.95198</span>   <span class="fl">0.763</span>   <span class="fl">0.4471</span>    </span>
<span id="cb19-23"><a href="reg-comp.html#cb19-23"></a>maxO3v       <span class="fl">0.34438</span>    <span class="fl">0.06699</span>   <span class="fl">5.141</span> <span class="fl">1.42e-06</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb19-24"><a href="reg-comp.html#cb19-24"></a>ventNord     <span class="fl">0.53956</span>    <span class="fl">6.69459</span>   <span class="fl">0.081</span>   <span class="fl">0.9359</span>    </span>
<span id="cb19-25"><a href="reg-comp.html#cb19-25"></a>ventOuest    <span class="fl">5.53632</span>    <span class="fl">8.24792</span>   <span class="fl">0.671</span>   <span class="fl">0.5037</span>    </span>
<span id="cb19-26"><a href="reg-comp.html#cb19-26"></a>ventSud      <span class="fl">5.42028</span>    <span class="fl">7.16180</span>   <span class="fl">0.757</span>   <span class="fl">0.4510</span>    </span>
<span id="cb19-27"><a href="reg-comp.html#cb19-27"></a>pluieSec     <span class="fl">3.24713</span>    <span class="fl">3.48251</span>   <span class="fl">0.932</span>   <span class="fl">0.3534</span>    </span>
<span id="cb19-28"><a href="reg-comp.html#cb19-28"></a><span class="op">---</span></span>
<span id="cb19-29"><a href="reg-comp.html#cb19-29"></a>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span>
<span id="cb19-30"><a href="reg-comp.html#cb19-30"></a></span>
<span id="cb19-31"><a href="reg-comp.html#cb19-31"></a>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">14.51</span> on <span class="dv">97</span> degrees of freedom</span>
<span id="cb19-32"><a href="reg-comp.html#cb19-32"></a>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.7686</span>,    Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.7352</span> </span>
<span id="cb19-33"><a href="reg-comp.html#cb19-33"></a>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">23.01</span> on <span class="dv">14</span> and <span class="dv">97</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="er">&lt;</span><span class="st"> </span><span class="fl">2.2e-16</span></span>
<span id="cb19-34"><a href="reg-comp.html#cb19-34"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">anova</span>(lin.complet)</span>
<span id="cb19-35"><a href="reg-comp.html#cb19-35"></a>Analysis of Variance Table</span>
<span id="cb19-36"><a href="reg-comp.html#cb19-36"></a></span>
<span id="cb19-37"><a href="reg-comp.html#cb19-37"></a>Response<span class="op">:</span><span class="st"> </span>maxO3</span>
<span id="cb19-38"><a href="reg-comp.html#cb19-38"></a>          Df Sum Sq Mean Sq  F value    <span class="kw">Pr</span>(<span class="op">&gt;</span>F)    </span>
<span id="cb19-39"><a href="reg-comp.html#cb19-39"></a>T9         <span class="dv">1</span>  <span class="dv">43138</span>   <span class="dv">43138</span> <span class="fl">205.0160</span> <span class="op">&lt;</span><span class="st"> </span><span class="fl">2.2e-16</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb19-40"><a href="reg-comp.html#cb19-40"></a>T12        <span class="dv">1</span>  <span class="dv">11125</span>   <span class="dv">11125</span>  <span class="fl">52.8706</span> <span class="fl">9.165e-11</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb19-41"><a href="reg-comp.html#cb19-41"></a>T15        <span class="dv">1</span>    <span class="dv">876</span>     <span class="dv">876</span>   <span class="fl">4.1619</span> <span class="fl">0.0440614</span> <span class="op">*</span><span class="st">  </span></span>
<span id="cb19-42"><a href="reg-comp.html#cb19-42"></a>Ne9        <span class="dv">1</span>   <span class="dv">3244</span>    <span class="dv">3244</span>  <span class="fl">15.4170</span> <span class="fl">0.0001613</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb19-43"><a href="reg-comp.html#cb19-43"></a>Ne12       <span class="dv">1</span>    <span class="dv">232</span>     <span class="dv">232</span>   <span class="fl">1.1035</span> <span class="fl">0.2961089</span>    </span>
<span id="cb19-44"><a href="reg-comp.html#cb19-44"></a>Ne15       <span class="dv">1</span>      <span class="dv">5</span>       <span class="dv">5</span>   <span class="fl">0.0248</span> <span class="fl">0.8752847</span>    </span>
<span id="cb19-45"><a href="reg-comp.html#cb19-45"></a>Vx9        <span class="dv">1</span>   <span class="dv">2217</span>    <span class="dv">2217</span>  <span class="fl">10.5355</span> <span class="fl">0.0016079</span> <span class="op">**</span><span class="st"> </span></span>
<span id="cb19-46"><a href="reg-comp.html#cb19-46"></a>Vx12       <span class="dv">1</span>      <span class="dv">1</span>       <span class="dv">1</span>   <span class="fl">0.0049</span> <span class="fl">0.9443039</span>    </span>
<span id="cb19-47"><a href="reg-comp.html#cb19-47"></a>Vx15       <span class="dv">1</span>     <span class="dv">67</span>      <span class="dv">67</span>   <span class="fl">0.3186</span> <span class="fl">0.5737491</span>    </span>
<span id="cb19-48"><a href="reg-comp.html#cb19-48"></a>maxO3v     <span class="dv">1</span>   <span class="dv">6460</span>    <span class="dv">6460</span>  <span class="fl">30.6993</span> <span class="fl">2.584e-07</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb19-49"><a href="reg-comp.html#cb19-49"></a>vent       <span class="dv">3</span>    <span class="dv">234</span>      <span class="dv">78</span>   <span class="fl">0.3709</span> <span class="fl">0.7741473</span>    </span>
<span id="cb19-50"><a href="reg-comp.html#cb19-50"></a>pluie      <span class="dv">1</span>    <span class="dv">183</span>     <span class="dv">183</span>   <span class="fl">0.8694</span> <span class="fl">0.3534399</span>    </span>
<span id="cb19-51"><a href="reg-comp.html#cb19-51"></a>Residuals <span class="dv">97</span>  <span class="dv">20410</span>     <span class="dv">210</span>                       </span>
<span id="cb19-52"><a href="reg-comp.html#cb19-52"></a><span class="op">---</span></span>
<span id="cb19-53"><a href="reg-comp.html#cb19-53"></a>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span></code></pre></div>
<div class="corR">
<p>
Il semble que quelques variables ne sont pas nécessaires dans le modèle.
</p>
</div></li>
<li><p>Expliquer les sorties de la commande</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="reg-comp.html#cb20-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(leaps)</span>
<span id="cb20-2"><a href="reg-comp.html#cb20-2"></a><span class="op">&gt;</span><span class="st"> </span>mod.sel &lt;-<span class="st"> </span><span class="kw">regsubsets</span>(maxO3<span class="op">~</span>.,<span class="dt">data=</span>ozone,<span class="dt">nvmax=</span><span class="dv">14</span>)</span>
<span id="cb20-3"><a href="reg-comp.html#cb20-3"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">summary</span>(mod.sel)</span>
<span id="cb20-4"><a href="reg-comp.html#cb20-4"></a>Subset selection object</span>
<span id="cb20-5"><a href="reg-comp.html#cb20-5"></a>Call<span class="op">:</span><span class="st"> </span><span class="kw">regsubsets.formula</span>(maxO3 <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> ozone, <span class="dt">nvmax =</span> <span class="dv">14</span>)</span>
<span id="cb20-6"><a href="reg-comp.html#cb20-6"></a><span class="dv">14</span> <span class="kw">Variables</span>  (and intercept)</span>
<span id="cb20-7"><a href="reg-comp.html#cb20-7"></a>          Forced <span class="cf">in</span> Forced out</span>
<span id="cb20-8"><a href="reg-comp.html#cb20-8"></a>T9            <span class="ot">FALSE</span>      <span class="ot">FALSE</span></span>
<span id="cb20-9"><a href="reg-comp.html#cb20-9"></a>T12           <span class="ot">FALSE</span>      <span class="ot">FALSE</span></span>
<span id="cb20-10"><a href="reg-comp.html#cb20-10"></a>T15           <span class="ot">FALSE</span>      <span class="ot">FALSE</span></span>
<span id="cb20-11"><a href="reg-comp.html#cb20-11"></a>Ne9           <span class="ot">FALSE</span>      <span class="ot">FALSE</span></span>
<span id="cb20-12"><a href="reg-comp.html#cb20-12"></a>Ne12          <span class="ot">FALSE</span>      <span class="ot">FALSE</span></span>
<span id="cb20-13"><a href="reg-comp.html#cb20-13"></a>Ne15          <span class="ot">FALSE</span>      <span class="ot">FALSE</span></span>
<span id="cb20-14"><a href="reg-comp.html#cb20-14"></a>Vx9           <span class="ot">FALSE</span>      <span class="ot">FALSE</span></span>
<span id="cb20-15"><a href="reg-comp.html#cb20-15"></a>Vx12          <span class="ot">FALSE</span>      <span class="ot">FALSE</span></span>
<span id="cb20-16"><a href="reg-comp.html#cb20-16"></a>Vx15          <span class="ot">FALSE</span>      <span class="ot">FALSE</span></span>
<span id="cb20-17"><a href="reg-comp.html#cb20-17"></a>maxO3v        <span class="ot">FALSE</span>      <span class="ot">FALSE</span></span>
<span id="cb20-18"><a href="reg-comp.html#cb20-18"></a>ventNord      <span class="ot">FALSE</span>      <span class="ot">FALSE</span></span>
<span id="cb20-19"><a href="reg-comp.html#cb20-19"></a>ventOuest     <span class="ot">FALSE</span>      <span class="ot">FALSE</span></span>
<span id="cb20-20"><a href="reg-comp.html#cb20-20"></a>ventSud       <span class="ot">FALSE</span>      <span class="ot">FALSE</span></span>
<span id="cb20-21"><a href="reg-comp.html#cb20-21"></a>pluieSec      <span class="ot">FALSE</span>      <span class="ot">FALSE</span></span>
<span id="cb20-22"><a href="reg-comp.html#cb20-22"></a><span class="dv">1</span> subsets of each size up to <span class="dv">14</span></span>
<span id="cb20-23"><a href="reg-comp.html#cb20-23"></a>Selection Algorithm<span class="op">:</span><span class="st"> </span>exhaustive</span>
<span id="cb20-24"><a href="reg-comp.html#cb20-24"></a>          T9  T12 T15 Ne9 Ne12 Ne15 Vx9 Vx12 Vx15 maxO3v ventNord ventOuest</span>
<span id="cb20-25"><a href="reg-comp.html#cb20-25"></a><span class="dv">1</span>  ( <span class="dv">1</span> )  <span class="st">&quot; &quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot; &quot;</span> <span class="st">&quot; &quot;</span> <span class="st">&quot; &quot;</span>  <span class="st">&quot; &quot;</span>  <span class="st">&quot; &quot;</span> <span class="st">&quot; &quot;</span>  <span class="st">&quot; &quot;</span>  <span class="st">&quot; &quot;</span>    <span class="st">&quot; &quot;</span>      <span class="st">&quot; &quot;</span>      </span>
<span id="cb20-26"><a href="reg-comp.html#cb20-26"></a><span class="dv">2</span>  ( <span class="dv">1</span> )  <span class="st">&quot; &quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot; &quot;</span> <span class="st">&quot; &quot;</span> <span class="st">&quot; &quot;</span>  <span class="st">&quot; &quot;</span>  <span class="st">&quot; &quot;</span> <span class="st">&quot; &quot;</span>  <span class="st">&quot; &quot;</span>  <span class="st">&quot;*&quot;</span>    <span class="st">&quot; &quot;</span>      <span class="st">&quot; &quot;</span>      </span>
<span id="cb20-27"><a href="reg-comp.html#cb20-27"></a><span class="dv">3</span>  ( <span class="dv">1</span> )  <span class="st">&quot; &quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot; &quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot; &quot;</span>  <span class="st">&quot; &quot;</span>  <span class="st">&quot; &quot;</span> <span class="st">&quot; &quot;</span>  <span class="st">&quot; &quot;</span>  <span class="st">&quot;*&quot;</span>    <span class="st">&quot; &quot;</span>      <span class="st">&quot; &quot;</span>      </span>
<span id="cb20-28"><a href="reg-comp.html#cb20-28"></a><span class="dv">4</span>  ( <span class="dv">1</span> )  <span class="st">&quot; &quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot; &quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot; &quot;</span>  <span class="st">&quot; &quot;</span>  <span class="st">&quot;*&quot;</span> <span class="st">&quot; &quot;</span>  <span class="st">&quot; &quot;</span>  <span class="st">&quot;*&quot;</span>    <span class="st">&quot; &quot;</span>      <span class="st">&quot; &quot;</span>      </span>
<span id="cb20-29"><a href="reg-comp.html#cb20-29"></a><span class="dv">5</span>  ( <span class="dv">1</span> )  <span class="st">&quot; &quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot; &quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot; &quot;</span>  <span class="st">&quot; &quot;</span>  <span class="st">&quot;*&quot;</span> <span class="st">&quot; &quot;</span>  <span class="st">&quot; &quot;</span>  <span class="st">&quot;*&quot;</span>    <span class="st">&quot; &quot;</span>      <span class="st">&quot; &quot;</span>      </span>
<span id="cb20-30"><a href="reg-comp.html#cb20-30"></a><span class="dv">6</span>  ( <span class="dv">1</span> )  <span class="st">&quot; &quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot; &quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot; &quot;</span>  <span class="st">&quot; &quot;</span>  <span class="st">&quot;*&quot;</span> <span class="st">&quot; &quot;</span>  <span class="st">&quot;*&quot;</span>  <span class="st">&quot;*&quot;</span>    <span class="st">&quot; &quot;</span>      <span class="st">&quot; &quot;</span>      </span>
<span id="cb20-31"><a href="reg-comp.html#cb20-31"></a><span class="dv">7</span>  ( <span class="dv">1</span> )  <span class="st">&quot; &quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot; &quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot; &quot;</span>  <span class="st">&quot; &quot;</span>  <span class="st">&quot;*&quot;</span> <span class="st">&quot; &quot;</span>  <span class="st">&quot;*&quot;</span>  <span class="st">&quot;*&quot;</span>    <span class="st">&quot;*&quot;</span>      <span class="st">&quot; &quot;</span>      </span>
<span id="cb20-32"><a href="reg-comp.html#cb20-32"></a><span class="dv">8</span>  ( <span class="dv">1</span> )  <span class="st">&quot; &quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot; &quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot; &quot;</span>  <span class="st">&quot; &quot;</span>  <span class="st">&quot;*&quot;</span> <span class="st">&quot; &quot;</span>  <span class="st">&quot;*&quot;</span>  <span class="st">&quot;*&quot;</span>    <span class="st">&quot; &quot;</span>      <span class="st">&quot;*&quot;</span>      </span>
<span id="cb20-33"><a href="reg-comp.html#cb20-33"></a><span class="dv">9</span>  ( <span class="dv">1</span> )  <span class="st">&quot; &quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot; &quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot;*&quot;</span>  <span class="st">&quot; &quot;</span>  <span class="st">&quot;*&quot;</span> <span class="st">&quot; &quot;</span>  <span class="st">&quot;*&quot;</span>  <span class="st">&quot;*&quot;</span>    <span class="st">&quot; &quot;</span>      <span class="st">&quot;*&quot;</span>      </span>
<span id="cb20-34"><a href="reg-comp.html#cb20-34"></a><span class="dv">10</span>  ( <span class="dv">1</span> ) <span class="st">&quot; &quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot;*&quot;</span>  <span class="st">&quot; &quot;</span>  <span class="st">&quot;*&quot;</span> <span class="st">&quot; &quot;</span>  <span class="st">&quot;*&quot;</span>  <span class="st">&quot;*&quot;</span>    <span class="st">&quot; &quot;</span>      <span class="st">&quot;*&quot;</span>      </span>
<span id="cb20-35"><a href="reg-comp.html#cb20-35"></a><span class="dv">11</span>  ( <span class="dv">1</span> ) <span class="st">&quot; &quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot;*&quot;</span>  <span class="st">&quot; &quot;</span>  <span class="st">&quot;*&quot;</span> <span class="st">&quot;*&quot;</span>  <span class="st">&quot;*&quot;</span>  <span class="st">&quot;*&quot;</span>    <span class="st">&quot; &quot;</span>      <span class="st">&quot;*&quot;</span>      </span>
<span id="cb20-36"><a href="reg-comp.html#cb20-36"></a><span class="dv">12</span>  ( <span class="dv">1</span> ) <span class="st">&quot; &quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot;*&quot;</span>  <span class="st">&quot; &quot;</span>  <span class="st">&quot;*&quot;</span> <span class="st">&quot;*&quot;</span>  <span class="st">&quot;*&quot;</span>  <span class="st">&quot;*&quot;</span>    <span class="st">&quot;*&quot;</span>      <span class="st">&quot;*&quot;</span>      </span>
<span id="cb20-37"><a href="reg-comp.html#cb20-37"></a><span class="dv">13</span>  ( <span class="dv">1</span> ) <span class="st">&quot;*&quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot;*&quot;</span>  <span class="st">&quot; &quot;</span>  <span class="st">&quot;*&quot;</span> <span class="st">&quot;*&quot;</span>  <span class="st">&quot;*&quot;</span>  <span class="st">&quot;*&quot;</span>    <span class="st">&quot;*&quot;</span>      <span class="st">&quot;*&quot;</span>      </span>
<span id="cb20-38"><a href="reg-comp.html#cb20-38"></a><span class="dv">14</span>  ( <span class="dv">1</span> ) <span class="st">&quot;*&quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot;*&quot;</span> <span class="st">&quot;*&quot;</span>  <span class="st">&quot;*&quot;</span>  <span class="st">&quot;*&quot;</span> <span class="st">&quot;*&quot;</span>  <span class="st">&quot;*&quot;</span>  <span class="st">&quot;*&quot;</span>    <span class="st">&quot;*&quot;</span>      <span class="st">&quot;*&quot;</span>      </span>
<span id="cb20-39"><a href="reg-comp.html#cb20-39"></a>          ventSud pluieSec</span>
<span id="cb20-40"><a href="reg-comp.html#cb20-40"></a><span class="dv">1</span>  ( <span class="dv">1</span> )  <span class="st">&quot; &quot;</span>     <span class="st">&quot; &quot;</span>     </span>
<span id="cb20-41"><a href="reg-comp.html#cb20-41"></a><span class="dv">2</span>  ( <span class="dv">1</span> )  <span class="st">&quot; &quot;</span>     <span class="st">&quot; &quot;</span>     </span>
<span id="cb20-42"><a href="reg-comp.html#cb20-42"></a><span class="dv">3</span>  ( <span class="dv">1</span> )  <span class="st">&quot; &quot;</span>     <span class="st">&quot; &quot;</span>     </span>
<span id="cb20-43"><a href="reg-comp.html#cb20-43"></a><span class="dv">4</span>  ( <span class="dv">1</span> )  <span class="st">&quot; &quot;</span>     <span class="st">&quot; &quot;</span>     </span>
<span id="cb20-44"><a href="reg-comp.html#cb20-44"></a><span class="dv">5</span>  ( <span class="dv">1</span> )  <span class="st">&quot; &quot;</span>     <span class="st">&quot;*&quot;</span>     </span>
<span id="cb20-45"><a href="reg-comp.html#cb20-45"></a><span class="dv">6</span>  ( <span class="dv">1</span> )  <span class="st">&quot; &quot;</span>     <span class="st">&quot;*&quot;</span>     </span>
<span id="cb20-46"><a href="reg-comp.html#cb20-46"></a><span class="dv">7</span>  ( <span class="dv">1</span> )  <span class="st">&quot; &quot;</span>     <span class="st">&quot;*&quot;</span>     </span>
<span id="cb20-47"><a href="reg-comp.html#cb20-47"></a><span class="dv">8</span>  ( <span class="dv">1</span> )  <span class="st">&quot;*&quot;</span>     <span class="st">&quot;*&quot;</span>     </span>
<span id="cb20-48"><a href="reg-comp.html#cb20-48"></a><span class="dv">9</span>  ( <span class="dv">1</span> )  <span class="st">&quot;*&quot;</span>     <span class="st">&quot;*&quot;</span>     </span>
<span id="cb20-49"><a href="reg-comp.html#cb20-49"></a><span class="dv">10</span>  ( <span class="dv">1</span> ) <span class="st">&quot;*&quot;</span>     <span class="st">&quot;*&quot;</span>     </span>
<span id="cb20-50"><a href="reg-comp.html#cb20-50"></a><span class="dv">11</span>  ( <span class="dv">1</span> ) <span class="st">&quot;*&quot;</span>     <span class="st">&quot;*&quot;</span>     </span>
<span id="cb20-51"><a href="reg-comp.html#cb20-51"></a><span class="dv">12</span>  ( <span class="dv">1</span> ) <span class="st">&quot;*&quot;</span>     <span class="st">&quot;*&quot;</span>     </span>
<span id="cb20-52"><a href="reg-comp.html#cb20-52"></a><span class="dv">13</span>  ( <span class="dv">1</span> ) <span class="st">&quot;*&quot;</span>     <span class="st">&quot;*&quot;</span>     </span>
<span id="cb20-53"><a href="reg-comp.html#cb20-53"></a><span class="dv">14</span>  ( <span class="dv">1</span> ) <span class="st">&quot;*&quot;</span>     <span class="st">&quot;*&quot;</span>     </span></code></pre></div>
<div class="corR">
<p>
On obtient une table avec des étoiles qui permettent de visualiser les meilleurs modèles à <span class="math inline"><span class="math inline">\(1,2,\dots,8\)</span></span> variables au sens du <span class="math inline"><span class="math inline">\(R^2\)</span></span>.
</p>
</div></li>
<li><p>Sélectionner le meilleur modèle au sens du <span class="math inline">\(R^2\)</span>. Que remarquez-vous ?</p></li>
</ol>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="reg-comp.html#cb21-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(mod.sel,<span class="dt">scale=</span><span class="st">&quot;r2&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_GRANDE_DIM_files/figure-html/unnamed-chunk-36-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>&lt;div class=&quot;corR&quot;&gt;
&lt;p&gt;Le meilleur modèle est le modèle complet. C’est logique puisque le &lt;span class=&quot;math inline&quot;&gt;\(R^2\)&lt;/span&gt; va toujours privilégier le modèle le plus complexe, c’est un critère &lt;code&gt;d&#39;ajustement&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;</code></pre>
<ol start="4" style="list-style-type: decimal">
<li><p>Faire de même pour le <span class="math inline">\(C_p\)</span> et le <span class="math inline">\(BIC\)</span>. Que remarquez-vous pour les variables explicatives qualitatives ?</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="reg-comp.html#cb23-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(mod.sel,<span class="dt">scale=</span><span class="st">&quot;bic&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_GRANDE_DIM_files/figure-html/unnamed-chunk-38-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="reg-comp.html#cb24-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(mod.sel,<span class="dt">scale=</span><span class="st">&quot;Cp&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_GRANDE_DIM_files/figure-html/unnamed-chunk-38-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="corR">
<p>
Ces critères choisissent ici le même modèle, avec 4 variables. On remarque que les variables qualitatives ne sont <code>pas réellement traitées comme des variables</code> : une modalité est égale à une variable. Par conséquent, cette procédure ne permet pas vraiment de sélectionner des variables qualitatives.
</p>
</div></li>
<li><p>Comparer cette méthode avec des modèles sélectionnées par la fonction <code>step</code> ou la fonction <code>bestglm</code> du package <code>bestglm</code>.</p>
<div class="corR">
<ul>
<li>
<p>La fonction <code>step</code> permet de faire de la sélection <strong>pas à pas</strong>. Par exemple, pour une procédure <code>descendante</code> avec le critère <span class="math inline"><span class="math inline">\(AIC\)</span></span> on utilisera :</p>
</li>
</ul>
</div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="reg-comp.html#cb25-1"></a> <span class="op">&gt;</span><span class="st"> </span>mod.step &lt;-<span class="st"> </span><span class="kw">step</span>(lin.complet,<span class="dt">direction=</span><span class="st">&quot;backward&quot;</span>,<span class="dt">trace=</span><span class="dv">0</span>)</span>
<span id="cb25-2"><a href="reg-comp.html#cb25-2"></a> <span class="op">&gt;</span><span class="st"> </span>mod.step</span>
<span id="cb25-3"><a href="reg-comp.html#cb25-3"></a></span>
<span id="cb25-4"><a href="reg-comp.html#cb25-4"></a> Call<span class="op">:</span></span>
<span id="cb25-5"><a href="reg-comp.html#cb25-5"></a><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> maxO3 <span class="op">~</span><span class="st"> </span>T12 <span class="op">+</span><span class="st"> </span>Ne9 <span class="op">+</span><span class="st"> </span>Vx9 <span class="op">+</span><span class="st"> </span>maxO3v, <span class="dt">data =</span> ozone)</span>
<span id="cb25-6"><a href="reg-comp.html#cb25-6"></a></span>
<span id="cb25-7"><a href="reg-comp.html#cb25-7"></a> Coefficients<span class="op">:</span></span>
<span id="cb25-8"><a href="reg-comp.html#cb25-8"></a><span class="st"> </span>(Intercept)          T12          Ne9          Vx9       maxO3v  </span>
<span id="cb25-9"><a href="reg-comp.html#cb25-9"></a>     <span class="fl">12.6313</span>       <span class="fl">2.7641</span>      <span class="fl">-2.5154</span>       <span class="fl">1.2929</span>       <span class="fl">0.3548</span>  </span></code></pre></div>
<div class="corR">
<ul>
<li>
<p>La fonction <code>bestglm</code> permet quant à elle de faire des sélections exhaustive ou pas à pas, on pour l’utiliser pour tous les <strong>glm</strong>. Attention les variables qualitatives doivent être des facteurs et la variable à expliquer doit être positionnée en dernière colonne pour cette fonction.</p>
</li>
</ul>
</div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="reg-comp.html#cb26-1"></a> <span class="op">&gt;</span><span class="st"> </span>ozone1 &lt;-<span class="st"> </span>ozone <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">vent=</span><span class="kw">as.factor</span>(vent),<span class="dt">pluie=</span><span class="kw">as.factor</span>(pluie)) <span class="op">%&gt;%</span></span>
<span id="cb26-2"><a href="reg-comp.html#cb26-2"></a><span class="st"> </span><span class="op">+</span><span class="st">   </span><span class="kw">select</span>(<span class="op">-</span>maxO3,<span class="kw">everything</span>())</span>
<span id="cb26-3"><a href="reg-comp.html#cb26-3"></a> <span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(bestglm)</span>
<span id="cb26-4"><a href="reg-comp.html#cb26-4"></a> <span class="op">&gt;</span><span class="st"> </span>model.bglm &lt;-<span class="st"> </span><span class="kw">bestglm</span>(ozone1,<span class="dt">IC=</span><span class="st">&quot;BIC&quot;</span>)</span>
<span id="cb26-5"><a href="reg-comp.html#cb26-5"></a> <span class="op">&gt;</span><span class="st"> </span>model.bglm<span class="op">$</span>BestModel <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>()</span>
<span id="cb26-6"><a href="reg-comp.html#cb26-6"></a></span>
<span id="cb26-7"><a href="reg-comp.html#cb26-7"></a> Call<span class="op">:</span></span>
<span id="cb26-8"><a href="reg-comp.html#cb26-8"></a><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> <span class="kw">data.frame</span>(Xy[, <span class="kw">c</span>(bestset[<span class="op">-</span><span class="dv">1</span>], <span class="ot">FALSE</span>), </span>
<span id="cb26-9"><a href="reg-comp.html#cb26-9"></a>     <span class="dt">drop =</span> <span class="ot">FALSE</span>], <span class="dt">y =</span> y))</span>
<span id="cb26-10"><a href="reg-comp.html#cb26-10"></a></span>
<span id="cb26-11"><a href="reg-comp.html#cb26-11"></a> Residuals<span class="op">:</span></span>
<span id="cb26-12"><a href="reg-comp.html#cb26-12"></a><span class="st">     </span>Min      1Q  Median      3Q     Max </span>
<span id="cb26-13"><a href="reg-comp.html#cb26-13"></a> <span class="fl">-52.396</span>  <span class="fl">-8.377</span>  <span class="fl">-1.086</span>   <span class="fl">7.951</span>  <span class="fl">40.933</span> </span>
<span id="cb26-14"><a href="reg-comp.html#cb26-14"></a></span>
<span id="cb26-15"><a href="reg-comp.html#cb26-15"></a> Coefficients<span class="op">:</span></span>
<span id="cb26-16"><a href="reg-comp.html#cb26-16"></a><span class="st">             </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    </span>
<span id="cb26-17"><a href="reg-comp.html#cb26-17"></a> (Intercept) <span class="fl">12.63131</span>   <span class="fl">11.00088</span>   <span class="fl">1.148</span> <span class="fl">0.253443</span>    </span>
<span id="cb26-18"><a href="reg-comp.html#cb26-18"></a> T12          <span class="fl">2.76409</span>    <span class="fl">0.47450</span>   <span class="fl">5.825</span> <span class="fl">6.07e-08</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb26-19"><a href="reg-comp.html#cb26-19"></a><span class="st"> </span>Ne9         <span class="fl">-2.51540</span>    <span class="fl">0.67585</span>  <span class="fl">-3.722</span> <span class="fl">0.000317</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb26-20"><a href="reg-comp.html#cb26-20"></a><span class="st"> </span>Vx9          <span class="fl">1.29286</span>    <span class="fl">0.60218</span>   <span class="fl">2.147</span> <span class="fl">0.034055</span> <span class="op">*</span><span class="st">  </span></span>
<span id="cb26-21"><a href="reg-comp.html#cb26-21"></a><span class="st"> </span>maxO3v       <span class="fl">0.35483</span>    <span class="fl">0.05789</span>   <span class="fl">6.130</span> <span class="fl">1.50e-08</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb26-22"><a href="reg-comp.html#cb26-22"></a><span class="st"> </span><span class="op">---</span></span>
<span id="cb26-23"><a href="reg-comp.html#cb26-23"></a><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span>
<span id="cb26-24"><a href="reg-comp.html#cb26-24"></a></span>
<span id="cb26-25"><a href="reg-comp.html#cb26-25"></a> Residual standard error<span class="op">:</span><span class="st"> </span><span class="dv">14</span> on <span class="dv">107</span> degrees of freedom</span>
<span id="cb26-26"><a href="reg-comp.html#cb26-26"></a> Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.7622</span>,    Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.7533</span> </span>
<span id="cb26-27"><a href="reg-comp.html#cb26-27"></a> F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">85.75</span> on <span class="dv">4</span> and <span class="dv">107</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="er">&lt;</span><span class="st"> </span><span class="fl">2.2e-16</span></span></code></pre></div></li>
</ol>
</div>
<div id="régression-sur-composantes-principales-méthodo" class="section level2">
<h2><span class="header-section-number">2.2</span> Régression sur composantes principales (méthodo)</h2>
<p>On considère le jeu de données <strong>Hitters</strong> dans lequel où on souhaite expliquer la variable <strong>Salary</strong> par les autres variables du jeu de données. On supprime les individus qui possèdent des données manquantes.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="reg-comp.html#cb27-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(ISLR)</span>
<span id="cb27-2"><a href="reg-comp.html#cb27-2"></a><span class="op">&gt;</span><span class="st"> </span>Hitters &lt;-<span class="st"> </span><span class="kw">na.omit</span>(Hitters)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p>Parmi les variables explicatives, certaines sont qualitatives. Expliquer comment, à l’aide de la fonction <strong>model.matrix</strong> on peut utiliser ces variables dans un modèle linéaire. On appellera <strong>X</strong> la matrice des variables explicatives construites avec cette variable.</p>
<div class="corR">
<p>
Comme pour le modèle linéaire, on utilise des contraintes identifiantes. Cela revient à prendre une modalité de référence et à coder les autres modalités par 0-1.
</p>
</div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="reg-comp.html#cb28-1"></a><span class="op">&gt;</span><span class="st"> </span>X &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(Salary<span class="op">~</span>.,<span class="dt">data=</span>Hitters)[,<span class="op">-</span><span class="dv">1</span>]</span></code></pre></div></li>
<li><p>Calculer la matrice <strong>Xcr</strong> qui correspond à la matrice <strong>X</strong> centrée réduite. On pourra utiliser la fonction <code>scale</code>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="reg-comp.html#cb29-1"></a><span class="op">&gt;</span><span class="st"> </span>Xcr &lt;-<span class="st"> </span><span class="kw">scale</span>(X)</span>
<span id="cb29-2"><a href="reg-comp.html#cb29-2"></a><span class="op">&gt;</span><span class="st"> </span>Xbar  &lt;-<span class="st"> </span><span class="kw">apply</span>(X,<span class="dv">2</span>,mean)</span>
<span id="cb29-3"><a href="reg-comp.html#cb29-3"></a><span class="op">&gt;</span><span class="st"> </span>stdX &lt;-<span class="st"> </span><span class="kw">apply</span>(X,<span class="dv">2</span>,sd)</span></code></pre></div></li>
<li><p>A l’aide de la fonction <code>PCA</code> du package <strong>FactoMineR</strong>, effectuer l’ACP du tableau <strong>Xcr</strong> avec l’option <code>scale.unit=FALSE</code>.</p>
<div class="corR">
<p>
On utilise ici <code>scale.unit=FALSE</code> car les données sont déjà centrées-réduites. Ca nous permet de contrôler cette étape.
</p>
</div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="reg-comp.html#cb30-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(FactoMineR)</span>
<span id="cb30-2"><a href="reg-comp.html#cb30-2"></a><span class="op">&gt;</span><span class="st"> </span>acp.hit &lt;-<span class="st"> </span><span class="kw">PCA</span>(Xcr,<span class="dt">scale.unit=</span><span class="ot">FALSE</span>,<span class="dt">graph=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="TUTO_GRANDE_DIM_files/figure-html/unnamed-chunk-48-1.png" width="672" style="display: block; margin: auto;" /><img src="TUTO_GRANDE_DIM_files/figure-html/unnamed-chunk-48-2.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Récupérer les coordonnées des individus sur les 5 premiers axes de l’ACP (variables <span class="math inline">\(Z\)</span> dans le cours).</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="reg-comp.html#cb31-1"></a><span class="op">&gt;</span><span class="st"> </span>Z &lt;-<span class="st"> </span>acp.hit<span class="op">$</span>ind<span class="op">$</span>coord</span></code></pre></div></li>
<li><p>Effectuer la régression linéaire sur les 5 premières composantes principales et calculer les estimateurs des MCO (<span class="math inline">\(\widehat\theta_k,k=1,\dots,5\)</span> dans le cours).</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="reg-comp.html#cb32-1"></a><span class="op">&gt;</span><span class="st"> </span>donnees &lt;-<span class="st"> </span><span class="kw">cbind.data.frame</span>(Z,<span class="dt">Salary=</span>Hitters<span class="op">$</span>Salary)</span>
<span id="cb32-2"><a href="reg-comp.html#cb32-2"></a><span class="op">&gt;</span><span class="st"> </span>mod &lt;-<span class="st"> </span><span class="kw">lm</span>(Salary<span class="op">~</span>.,<span class="dt">data=</span>donnees)</span>
<span id="cb32-3"><a href="reg-comp.html#cb32-3"></a><span class="op">&gt;</span><span class="st"> </span>theta &lt;-<span class="st"> </span><span class="kw">coef</span>(mod)</span>
<span id="cb32-4"><a href="reg-comp.html#cb32-4"></a><span class="op">&gt;</span><span class="st"> </span>theta</span>
<span id="cb32-5"><a href="reg-comp.html#cb32-5"></a>(Intercept)       Dim<span class="fl">.1</span>       Dim<span class="fl">.2</span>       Dim<span class="fl">.3</span>       Dim<span class="fl">.4</span>       Dim<span class="fl">.5</span> </span>
<span id="cb32-6"><a href="reg-comp.html#cb32-6"></a>  <span class="fl">535.92588</span>   <span class="fl">106.57139</span>    <span class="fl">21.64469</span>    <span class="fl">24.34057</span>    <span class="fl">37.05637</span>   <span class="fl">-58.52540</span> </span></code></pre></div>
<div class="corR">
<p>
<strong>Remarque</strong> : on peut aussi tout faire “à la main” (sans utiliser <strong>PCA</strong>)
</p>
</div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="reg-comp.html#cb33-1"></a><span class="op">&gt;</span><span class="st"> </span>acp.main &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">t</span>(Xcr)<span class="op">%*%</span>Xcr)</span>
<span id="cb33-2"><a href="reg-comp.html#cb33-2"></a><span class="op">&gt;</span><span class="st"> </span>U &lt;-<span class="st"> </span>acp.main<span class="op">$</span>vectors</span>
<span id="cb33-3"><a href="reg-comp.html#cb33-3"></a><span class="op">&gt;</span><span class="st"> </span>CC &lt;-<span class="st"> </span>Xcr<span class="op">%*%</span>(<span class="op">-</span>U[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</span>
<span id="cb33-4"><a href="reg-comp.html#cb33-4"></a><span class="op">&gt;</span><span class="st"> </span>D &lt;-<span class="st"> </span><span class="kw">cbind.data.frame</span>(CC,<span class="dt">Salary=</span>Hitters<span class="op">$</span>Salary)</span>
<span id="cb33-5"><a href="reg-comp.html#cb33-5"></a><span class="op">&gt;</span><span class="st"> </span>modS &lt;-<span class="st"> </span><span class="kw">lm</span>(Salary<span class="op">~</span>.,<span class="dt">data=</span>D)</span>
<span id="cb33-6"><a href="reg-comp.html#cb33-6"></a><span class="op">&gt;</span><span class="st"> </span>coefS &lt;-<span class="st"> </span>modS<span class="op">$</span>coefficients</span>
<span id="cb33-7"><a href="reg-comp.html#cb33-7"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">coef</span>(modS)</span>
<span id="cb33-8"><a href="reg-comp.html#cb33-8"></a>(Intercept)         <span class="st">`</span><span class="dt">1</span><span class="st">`</span>         <span class="st">`</span><span class="dt">2</span><span class="st">`</span>         <span class="st">`</span><span class="dt">3</span><span class="st">`</span>         <span class="st">`</span><span class="dt">4</span><span class="st">`</span>         <span class="st">`</span><span class="dt">5</span><span class="st">`</span> </span>
<span id="cb33-9"><a href="reg-comp.html#cb33-9"></a>  <span class="fl">535.92588</span>   <span class="fl">106.57139</span>    <span class="fl">21.64469</span>    <span class="fl">24.34057</span>    <span class="fl">37.05637</span>   <span class="fl">-58.52540</span> </span></code></pre></div></li>
<li><p>En déduire les estimateurs dans l’espace des données initiales pour les données centrées réduites, puis pour les données brutes. On pourra récupérer les vecteurs propres de l’ACP (<span class="math inline">\(u_k\)</span> dans le cours) dans la sortie <strong>svd</strong> de la fonction <strong>PCA</strong></p>
<div class="corR">
<ul>
<li>
<p>Pour les données centrées-réduites, les coefficients s’obtiennent avec les formules vues en cours</p>
</li>
</ul>
<p>
<p><span class="math display"><span class="math display">\[\widehat\beta_0=\bar y\quad\text{et}\quad \widehat\beta_j=\widehat{\theta}^\prime v_j.\]</span></span></p>
</p>
</div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="reg-comp.html#cb34-1"></a> <span class="op">&gt;</span><span class="st"> </span>U &lt;-<span class="st"> </span>acp.hit<span class="op">$</span>svd<span class="op">$</span>V</span>
<span id="cb34-2"><a href="reg-comp.html#cb34-2"></a> <span class="op">&gt;</span><span class="st"> </span>V &lt;-<span class="st"> </span><span class="kw">t</span>(U)</span>
<span id="cb34-3"><a href="reg-comp.html#cb34-3"></a> <span class="op">&gt;</span><span class="st"> </span>beta0.cr &lt;-<span class="st"> </span><span class="kw">mean</span>(Hitters<span class="op">$</span>Salary)</span>
<span id="cb34-4"><a href="reg-comp.html#cb34-4"></a> <span class="op">&gt;</span><span class="st"> </span>beta.cr &lt;-<span class="st"> </span><span class="kw">as.vector</span>(theta[<span class="dv">2</span><span class="op">:</span><span class="dv">6</span>])<span class="op">%*%</span>V</span>
<span id="cb34-5"><a href="reg-comp.html#cb34-5"></a> <span class="op">&gt;</span><span class="st"> </span>beta.cr</span>
<span id="cb34-6"><a href="reg-comp.html#cb34-6"></a>          [,<span class="dv">1</span>]     [,<span class="dv">2</span>]    [,<span class="dv">3</span>]     [,<span class="dv">4</span>]     [,<span class="dv">5</span>]     [,<span class="dv">6</span>]     [,<span class="dv">7</span>]     [,<span class="dv">8</span>]</span>
<span id="cb34-7"><a href="reg-comp.html#cb34-7"></a> [<span class="dv">1</span>,] <span class="fl">28.76604</span> <span class="fl">30.44702</span> <span class="fl">25.8445</span> <span class="fl">33.00088</span> <span class="fl">33.81997</span> <span class="fl">35.08779</span> <span class="fl">22.35103</span> <span class="fl">29.01477</span></span>
<span id="cb34-8"><a href="reg-comp.html#cb34-8"></a>          [,<span class="dv">9</span>]    [,<span class="dv">10</span>]    [,<span class="dv">11</span>]    [,<span class="dv">12</span>]    [,<span class="dv">13</span>]  [,<span class="dv">14</span>]     [,<span class="dv">15</span>]    [,<span class="dv">16</span>]</span>
<span id="cb34-9"><a href="reg-comp.html#cb34-9"></a> [<span class="dv">1</span>,] <span class="fl">29.78584</span> <span class="fl">30.00201</span> <span class="fl">32.06912</span> <span class="fl">31.11231</span> <span class="fl">31.48735</span> <span class="fl">19.439</span> <span class="fl">-63.20387</span> <span class="fl">17.36044</span></span>
<span id="cb34-10"><a href="reg-comp.html#cb34-10"></a>          [,<span class="dv">17</span>]     [,<span class="dv">18</span>]    [,<span class="dv">19</span>]</span>
<span id="cb34-11"><a href="reg-comp.html#cb34-11"></a> [<span class="dv">1</span>,] <span class="fl">-5.523264</span> <span class="fl">-6.044002</span> <span class="fl">21.74267</span></span></code></pre></div>
<div class="corR">
<ul>
<li>
<p>Pour les données brutes, on utilise les formules :</p>
</li>
</ul>
<p>
<p><span class="math display"><span class="math display">\[\widehat\beta_0=\bar y-\sum_{j=1}^p\widehat\theta^\prime v_j\frac{\bar x_j}{\sigma_{x_j}}\quad\text{et}\quad\widehat\beta_j=\frac{\widehat\theta^\prime v_j}{\sigma_{X_j}},j=1,\dots,p.\]</span></span></p>
</p>
</div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="reg-comp.html#cb35-1"></a> <span class="op">&gt;</span><span class="st"> </span>beta0 &lt;-<span class="st"> </span>beta0.cr<span class="op">-</span><span class="kw">sum</span>(beta.cr<span class="op">*</span>Xbar<span class="op">/</span>stdX)</span>
<span id="cb35-2"><a href="reg-comp.html#cb35-2"></a> <span class="op">&gt;</span><span class="st"> </span>beta &lt;-<span class="st"> </span>beta.cr<span class="op">/</span>stdX</span>
<span id="cb35-3"><a href="reg-comp.html#cb35-3"></a> <span class="op">&gt;</span><span class="st"> </span>beta0</span>
<span id="cb35-4"><a href="reg-comp.html#cb35-4"></a> [<span class="dv">1</span>] <span class="fl">-58.32022</span></span>
<span id="cb35-5"><a href="reg-comp.html#cb35-5"></a> <span class="op">&gt;</span><span class="st"> </span>beta</span>
<span id="cb35-6"><a href="reg-comp.html#cb35-6"></a>           [,<span class="dv">1</span>]      [,<span class="dv">2</span>]    [,<span class="dv">3</span>]     [,<span class="dv">4</span>]     [,<span class="dv">5</span>]     [,<span class="dv">6</span>]     [,<span class="dv">7</span>]       [,<span class="dv">8</span>]</span>
<span id="cb35-7"><a href="reg-comp.html#cb35-7"></a> [<span class="dv">1</span>,] <span class="fl">0.1952793</span> <span class="fl">0.6747214</span> <span class="fl">2.95126</span> <span class="fl">1.292134</span> <span class="fl">1.306662</span> <span class="fl">1.615605</span> <span class="fl">4.662667</span> <span class="fl">0.01268914</span></span>
<span id="cb35-8"><a href="reg-comp.html#cb35-8"></a>            [,<span class="dv">9</span>]     [,<span class="dv">10</span>]      [,<span class="dv">11</span>]      [,<span class="dv">12</span>]    [,<span class="dv">13</span>]    [,<span class="dv">14</span>]   [,<span class="dv">15</span>]</span>
<span id="cb35-9"><a href="reg-comp.html#cb35-9"></a> [<span class="dv">1</span>,] <span class="fl">0.04595165</span> <span class="fl">0.3649987</span> <span class="fl">0.09682748</span> <span class="fl">0.09621344</span> <span class="fl">0.119245</span> <span class="fl">38.86728</span> <span class="fl">-126.19</span></span>
<span id="cb35-10"><a href="reg-comp.html#cb35-10"></a>           [,<span class="dv">16</span>]       [,<span class="dv">17</span>]      [,<span class="dv">18</span>]    [,<span class="dv">19</span>]</span>
<span id="cb35-11"><a href="reg-comp.html#cb35-11"></a> [<span class="dv">1</span>,] <span class="fl">0.06201606</span> <span class="fl">-0.03807032</span> <span class="fl">-0.9148466</span> <span class="fl">43.51629</span></span></code></pre></div></li>
<li><p>Retrouver les estimateurs dans l’espace des données initiales pour les données centrées réduites à l’aide de la fonction <code>pcr</code> du package <strong>pls</strong>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="reg-comp.html#cb36-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(pls)</span>
<span id="cb36-2"><a href="reg-comp.html#cb36-2"></a><span class="op">&gt;</span><span class="st"> </span>pcr.fit &lt;-<span class="st"> </span><span class="kw">pcr</span>(Salary<span class="op">~</span>.,<span class="dt">data=</span>Hitters,<span class="dt">scale=</span><span class="ot">TRUE</span>,<span class="dt">ncomp=</span><span class="dv">19</span>)</span>
<span id="cb36-3"><a href="reg-comp.html#cb36-3"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">coefficients</span>(pcr.fit,<span class="dt">ncomp=</span><span class="dv">5</span>)</span>
<span id="cb36-4"><a href="reg-comp.html#cb36-4"></a>, , <span class="dv">5</span> comps</span>
<span id="cb36-5"><a href="reg-comp.html#cb36-5"></a></span>
<span id="cb36-6"><a href="reg-comp.html#cb36-6"></a>               Salary</span>
<span id="cb36-7"><a href="reg-comp.html#cb36-7"></a>AtBat       <span class="fl">28.766042</span></span>
<span id="cb36-8"><a href="reg-comp.html#cb36-8"></a>Hits        <span class="fl">30.447021</span></span>
<span id="cb36-9"><a href="reg-comp.html#cb36-9"></a>HmRun       <span class="fl">25.844498</span></span>
<span id="cb36-10"><a href="reg-comp.html#cb36-10"></a>Runs        <span class="fl">33.000876</span></span>
<span id="cb36-11"><a href="reg-comp.html#cb36-11"></a>RBI         <span class="fl">33.819966</span></span>
<span id="cb36-12"><a href="reg-comp.html#cb36-12"></a>Walks       <span class="fl">35.087794</span></span>
<span id="cb36-13"><a href="reg-comp.html#cb36-13"></a>Years       <span class="fl">22.351033</span></span>
<span id="cb36-14"><a href="reg-comp.html#cb36-14"></a>CAtBat      <span class="fl">29.014768</span></span>
<span id="cb36-15"><a href="reg-comp.html#cb36-15"></a>CHits       <span class="fl">29.785842</span></span>
<span id="cb36-16"><a href="reg-comp.html#cb36-16"></a>CHmRun      <span class="fl">30.002014</span></span>
<span id="cb36-17"><a href="reg-comp.html#cb36-17"></a>CRuns       <span class="fl">32.069124</span></span>
<span id="cb36-18"><a href="reg-comp.html#cb36-18"></a>CRBI        <span class="fl">31.112315</span></span>
<span id="cb36-19"><a href="reg-comp.html#cb36-19"></a>CWalks      <span class="fl">31.487349</span></span>
<span id="cb36-20"><a href="reg-comp.html#cb36-20"></a>LeagueN     <span class="fl">19.438996</span></span>
<span id="cb36-21"><a href="reg-comp.html#cb36-21"></a>DivisionW  <span class="fl">-63.203872</span></span>
<span id="cb36-22"><a href="reg-comp.html#cb36-22"></a>PutOuts     <span class="fl">17.360440</span></span>
<span id="cb36-23"><a href="reg-comp.html#cb36-23"></a>Assists     <span class="fl">-5.523264</span></span>
<span id="cb36-24"><a href="reg-comp.html#cb36-24"></a>Errors      <span class="fl">-6.044002</span></span>
<span id="cb36-25"><a href="reg-comp.html#cb36-25"></a>NewLeagueN  <span class="fl">21.742668</span></span></code></pre></div></li>
<li><p>On considère les individus suivants</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="reg-comp.html#cb37-1"></a><span class="op">&gt;</span><span class="st"> </span>df.new &lt;-<span class="st"> </span>Hitters[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">80</span>),]</span></code></pre></div>
<p>Calculer de 3 façons différentes les valeurs de salaire prédites par la régression sur 5 composantes principales.</p>
<div class="corR">
<ul>
<li>
<p>Approche classique : on utilise <code>predict.pcr</code> :</p>
</li>
</ul>
</div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="reg-comp.html#cb38-1"></a> <span class="op">&gt;</span><span class="st"> </span><span class="kw">predict</span>(pcr.fit,<span class="dt">newdata=</span>df.new,<span class="dt">ncomp=</span><span class="dv">5</span>)</span>
<span id="cb38-2"><a href="reg-comp.html#cb38-2"></a> , , <span class="dv">5</span> comps</span>
<span id="cb38-3"><a href="reg-comp.html#cb38-3"></a></span>
<span id="cb38-4"><a href="reg-comp.html#cb38-4"></a>                 Salary</span>
<span id="cb38-5"><a href="reg-comp.html#cb38-5"></a> <span class="op">-</span>Alan Ashby   <span class="fl">495.0068</span></span>
<span id="cb38-6"><a href="reg-comp.html#cb38-6"></a> <span class="op">-</span>Hubie Brooks <span class="fl">577.9581</span></span>
<span id="cb38-7"><a href="reg-comp.html#cb38-7"></a> <span class="op">-</span>George Bell  <span class="fl">822.0296</span></span></code></pre></div>
<div class="corR">
<ul>
<li>
<p>On considère les valeurs centrées réduites et on utilise :</p>
</li>
</ul>
<p>
<p><span class="math display"><span class="math display">\[\widehat y=\bar y+ \widehat\theta^\prime v_1\tilde x_1+\cdots+\widehat\theta^\prime v_p\tilde x_p\]</span></span></p>
</p>
</div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="reg-comp.html#cb39-1"></a> <span class="op">&gt;</span><span class="st"> </span><span class="kw">t</span>(<span class="kw">as.matrix</span>(<span class="kw">coefficients</span>(pcr.fit,<span class="dt">ncomp=</span><span class="dv">5</span>))) <span class="op">%*%</span><span class="st"> </span></span>
<span id="cb39-2"><a href="reg-comp.html#cb39-2"></a><span class="st"> </span><span class="op">+</span><span class="st">   </span><span class="kw">t</span>(<span class="kw">as.matrix</span>(Xcr[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">80</span>),]))<span class="op">+</span><span class="kw">mean</span>(Hitters<span class="op">$</span>Salary)</span>
<span id="cb39-3"><a href="reg-comp.html#cb39-3"></a>      <span class="op">-</span>Alan Ashby <span class="op">-</span>Hubie Brooks <span class="op">-</span>George Bell</span>
<span id="cb39-4"><a href="reg-comp.html#cb39-4"></a> [<span class="dv">1</span>,]    <span class="fl">495.0068</span>      <span class="fl">577.9581</span>     <span class="fl">822.0296</span></span>
<span id="cb39-5"><a href="reg-comp.html#cb39-5"></a> <span class="op">&gt;</span><span class="st"> </span><span class="co">#ou</span></span>
<span id="cb39-6"><a href="reg-comp.html#cb39-6"></a><span class="st"> </span><span class="er">&gt;</span><span class="st"> </span>beta0.cr<span class="op">+</span>beta.cr<span class="op">%*%</span><span class="kw">t</span>(<span class="kw">as.matrix</span>(Xcr[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">80</span>),]))</span>
<span id="cb39-7"><a href="reg-comp.html#cb39-7"></a>      <span class="op">-</span>Alan Ashby <span class="op">-</span>Hubie Brooks <span class="op">-</span>George Bell</span>
<span id="cb39-8"><a href="reg-comp.html#cb39-8"></a> [<span class="dv">1</span>,]    <span class="fl">495.0068</span>      <span class="fl">577.9581</span>     <span class="fl">822.0296</span></span></code></pre></div>
<div class="corR">
<ul>
<li>
<p>On considère les données brutes et on utilise :</p>
</li>
</ul>
<p>
<p><span class="math display"><span class="math display">\[\widehat y=\widehat\beta_0+\widehat\beta_1x_1+\cdots+\widehat\beta_px_p\]</span></span></p>
</p>
</div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="reg-comp.html#cb40-1"></a> <span class="op">&gt;</span><span class="st"> </span>beta0<span class="op">+</span>beta <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(<span class="kw">as.matrix</span>(X[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">80</span>),]))</span>
<span id="cb40-2"><a href="reg-comp.html#cb40-2"></a>      <span class="op">-</span>Alan Ashby <span class="op">-</span>Hubie Brooks <span class="op">-</span>George Bell</span>
<span id="cb40-3"><a href="reg-comp.html#cb40-3"></a> [<span class="dv">1</span>,]    <span class="fl">495.0068</span>      <span class="fl">577.9581</span>     <span class="fl">822.0296</span></span></code></pre></div></li>
</ol>
</div>
<div id="régression-pls-méthodo" class="section level2">
<h2><span class="header-section-number">2.3</span> Régression PLS : méthodo</h2>
<p>On considère les mêmes données que précédemment.</p>
<ol style="list-style-type: decimal">
<li><p>A l’aide du vecteur <span class="math inline">\(Y\)</span> (<em>Salary</em>) et de la matrice des <span class="math inline">\(X\)</span> centrées réduites calculées dans l’exercice précédent, calculer la première composante <strong>PLS</strong> <span class="math inline">\(Z_1\)</span>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="reg-comp.html#cb41-1"></a><span class="op">&gt;</span><span class="st"> </span>Y &lt;-<span class="st"> </span><span class="kw">as.vector</span>(Hitters<span class="op">$</span>Salary)</span>
<span id="cb41-2"><a href="reg-comp.html#cb41-2"></a><span class="op">&gt;</span><span class="st"> </span>w1 &lt;-<span class="st"> </span><span class="kw">t</span>(Xcr)<span class="op">%*%</span>Y</span>
<span id="cb41-3"><a href="reg-comp.html#cb41-3"></a><span class="op">&gt;</span><span class="st"> </span>w1</span>
<span id="cb41-4"><a href="reg-comp.html#cb41-4"></a>                  [,<span class="dv">1</span>]</span>
<span id="cb41-5"><a href="reg-comp.html#cb41-5"></a>AtBat       <span class="fl">46659.1995</span></span>
<span id="cb41-6"><a href="reg-comp.html#cb41-6"></a>Hits        <span class="fl">51848.3247</span></span>
<span id="cb41-7"><a href="reg-comp.html#cb41-7"></a>HmRun       <span class="fl">40543.5500</span></span>
<span id="cb41-8"><a href="reg-comp.html#cb41-8"></a>Runs        <span class="fl">49624.3823</span></span>
<span id="cb41-9"><a href="reg-comp.html#cb41-9"></a>RBI         <span class="fl">53122.7240</span></span>
<span id="cb41-10"><a href="reg-comp.html#cb41-10"></a>Walks       <span class="fl">52462.0450</span></span>
<span id="cb41-11"><a href="reg-comp.html#cb41-11"></a>Years       <span class="fl">47354.8899</span></span>
<span id="cb41-12"><a href="reg-comp.html#cb41-12"></a>CAtBat      <span class="fl">62185.5603</span></span>
<span id="cb41-13"><a href="reg-comp.html#cb41-13"></a>CHits       <span class="fl">64877.3193</span></span>
<span id="cb41-14"><a href="reg-comp.html#cb41-14"></a>CHmRun      <span class="fl">62043.1671</span></span>
<span id="cb41-15"><a href="reg-comp.html#cb41-15"></a>CRuns       <span class="fl">66504.6198</span></span>
<span id="cb41-16"><a href="reg-comp.html#cb41-16"></a>CRBI        <span class="fl">67011.4288</span></span>
<span id="cb41-17"><a href="reg-comp.html#cb41-17"></a>CWalks      <span class="fl">57893.5821</span></span>
<span id="cb41-18"><a href="reg-comp.html#cb41-18"></a>LeagueN     <span class="fl">-1688.0134</span></span>
<span id="cb41-19"><a href="reg-comp.html#cb41-19"></a>DivisionW  <span class="fl">-22753.8726</span></span>
<span id="cb41-20"><a href="reg-comp.html#cb41-20"></a>PutOuts     <span class="fl">35514.7030</span></span>
<span id="cb41-21"><a href="reg-comp.html#cb41-21"></a>Assists      <span class="fl">3006.3756</span></span>
<span id="cb41-22"><a href="reg-comp.html#cb41-22"></a>Errors       <span class="fl">-638.3256</span></span>
<span id="cb41-23"><a href="reg-comp.html#cb41-23"></a>NewLeagueN   <span class="fl">-335.0136</span></span>
<span id="cb41-24"><a href="reg-comp.html#cb41-24"></a><span class="op">&gt;</span><span class="st"> </span>Z1 &lt;-<span class="st"> </span>Xcr<span class="op">%*%</span>w1</span></code></pre></div></li>
<li><p>En déduire le coefficient associé à cette première composante en considérant le modèle
<span class="math display">\[Y=\alpha_1 Z_1+\varepsilon.\]</span></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="reg-comp.html#cb42-1"></a><span class="op">&gt;</span><span class="st"> </span>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Z1,Y)</span>
<span id="cb42-2"><a href="reg-comp.html#cb42-2"></a><span class="op">&gt;</span><span class="st"> </span>mod1 &lt;-<span class="st"> </span><span class="kw">lm</span>(Y<span class="op">~</span>Z1<span class="dv">-1</span>,<span class="dt">data=</span>df)</span>
<span id="cb42-3"><a href="reg-comp.html#cb42-3"></a><span class="op">&gt;</span><span class="st"> </span>alpha1 &lt;-<span class="st"> </span><span class="kw">coef</span>(mod1)</span>
<span id="cb42-4"><a href="reg-comp.html#cb42-4"></a><span class="op">&gt;</span><span class="st"> </span>alpha1</span>
<span id="cb42-5"><a href="reg-comp.html#cb42-5"></a>          Z1 </span>
<span id="cb42-6"><a href="reg-comp.html#cb42-6"></a><span class="fl">0.0005367014</span> </span></code></pre></div></li>
<li><p>En déduire les coefficients en fonction des variables initiales (centrées réduites) de la régression PLS à une composante
<span class="math display">\[Y=\beta_0+\beta_1X_1+\dots+\beta_pX_p+\varepsilon.\]</span></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="reg-comp.html#cb43-1"></a><span class="op">&gt;</span><span class="st"> </span>alpha1<span class="op">*</span>w1</span>
<span id="cb43-2"><a href="reg-comp.html#cb43-2"></a>                  [,<span class="dv">1</span>]</span>
<span id="cb43-3"><a href="reg-comp.html#cb43-3"></a>AtBat       <span class="fl">25.0420570</span></span>
<span id="cb43-4"><a href="reg-comp.html#cb43-4"></a>Hits        <span class="fl">27.8270677</span></span>
<span id="cb43-5"><a href="reg-comp.html#cb43-5"></a>HmRun       <span class="fl">21.7597795</span></span>
<span id="cb43-6"><a href="reg-comp.html#cb43-6"></a>Runs        <span class="fl">26.6334747</span></span>
<span id="cb43-7"><a href="reg-comp.html#cb43-7"></a>RBI         <span class="fl">28.5110396</span></span>
<span id="cb43-8"><a href="reg-comp.html#cb43-8"></a>Walks       <span class="fl">28.1564522</span></span>
<span id="cb43-9"><a href="reg-comp.html#cb43-9"></a>Years       <span class="fl">25.4154350</span></span>
<span id="cb43-10"><a href="reg-comp.html#cb43-10"></a>CAtBat      <span class="fl">33.3750764</span></span>
<span id="cb43-11"><a href="reg-comp.html#cb43-11"></a>CHits       <span class="fl">34.8197471</span></span>
<span id="cb43-12"><a href="reg-comp.html#cb43-12"></a>CHmRun      <span class="fl">33.2986538</span></span>
<span id="cb43-13"><a href="reg-comp.html#cb43-13"></a>CRuns       <span class="fl">35.6931216</span></span>
<span id="cb43-14"><a href="reg-comp.html#cb43-14"></a>CRBI        <span class="fl">35.9651267</span></span>
<span id="cb43-15"><a href="reg-comp.html#cb43-15"></a>CWalks      <span class="fl">31.0715657</span></span>
<span id="cb43-16"><a href="reg-comp.html#cb43-16"></a>LeagueN     <span class="fl">-0.9059591</span></span>
<span id="cb43-17"><a href="reg-comp.html#cb43-17"></a>DivisionW  <span class="fl">-12.2120349</span></span>
<span id="cb43-18"><a href="reg-comp.html#cb43-18"></a>PutOuts     <span class="fl">19.0607903</span></span>
<span id="cb43-19"><a href="reg-comp.html#cb43-19"></a>Assists      <span class="fl">1.6135259</span></span>
<span id="cb43-20"><a href="reg-comp.html#cb43-20"></a>Errors      <span class="fl">-0.3425902</span></span>
<span id="cb43-21"><a href="reg-comp.html#cb43-21"></a>NewLeagueN  <span class="fl">-0.1798022</span></span></code></pre></div></li>
<li><p>Retrouver ces coefficients en utilisant la fonction <code>plsr</code>.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="reg-comp.html#cb44-1"></a><span class="op">&gt;</span><span class="st"> </span>pls.fit &lt;-<span class="st"> </span><span class="kw">plsr</span>(Salary<span class="op">~</span>.,<span class="dt">data=</span>Hitters,<span class="dt">scale=</span><span class="ot">TRUE</span>)</span>
<span id="cb44-2"><a href="reg-comp.html#cb44-2"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">coefficients</span>(pls.fit,<span class="dt">ncomp =</span> <span class="dv">1</span>)</span>
<span id="cb44-3"><a href="reg-comp.html#cb44-3"></a>, , <span class="dv">1</span> comps</span>
<span id="cb44-4"><a href="reg-comp.html#cb44-4"></a></span>
<span id="cb44-5"><a href="reg-comp.html#cb44-5"></a>                Salary</span>
<span id="cb44-6"><a href="reg-comp.html#cb44-6"></a>AtBat       <span class="fl">25.0420570</span></span>
<span id="cb44-7"><a href="reg-comp.html#cb44-7"></a>Hits        <span class="fl">27.8270677</span></span>
<span id="cb44-8"><a href="reg-comp.html#cb44-8"></a>HmRun       <span class="fl">21.7597795</span></span>
<span id="cb44-9"><a href="reg-comp.html#cb44-9"></a>Runs        <span class="fl">26.6334747</span></span>
<span id="cb44-10"><a href="reg-comp.html#cb44-10"></a>RBI         <span class="fl">28.5110396</span></span>
<span id="cb44-11"><a href="reg-comp.html#cb44-11"></a>Walks       <span class="fl">28.1564522</span></span>
<span id="cb44-12"><a href="reg-comp.html#cb44-12"></a>Years       <span class="fl">25.4154350</span></span>
<span id="cb44-13"><a href="reg-comp.html#cb44-13"></a>CAtBat      <span class="fl">33.3750764</span></span>
<span id="cb44-14"><a href="reg-comp.html#cb44-14"></a>CHits       <span class="fl">34.8197471</span></span>
<span id="cb44-15"><a href="reg-comp.html#cb44-15"></a>CHmRun      <span class="fl">33.2986538</span></span>
<span id="cb44-16"><a href="reg-comp.html#cb44-16"></a>CRuns       <span class="fl">35.6931216</span></span>
<span id="cb44-17"><a href="reg-comp.html#cb44-17"></a>CRBI        <span class="fl">35.9651267</span></span>
<span id="cb44-18"><a href="reg-comp.html#cb44-18"></a>CWalks      <span class="fl">31.0715657</span></span>
<span id="cb44-19"><a href="reg-comp.html#cb44-19"></a>LeagueN     <span class="fl">-0.9059591</span></span>
<span id="cb44-20"><a href="reg-comp.html#cb44-20"></a>DivisionW  <span class="fl">-12.2120349</span></span>
<span id="cb44-21"><a href="reg-comp.html#cb44-21"></a>PutOuts     <span class="fl">19.0607903</span></span>
<span id="cb44-22"><a href="reg-comp.html#cb44-22"></a>Assists      <span class="fl">1.6135259</span></span>
<span id="cb44-23"><a href="reg-comp.html#cb44-23"></a>Errors      <span class="fl">-0.3425902</span></span>
<span id="cb44-24"><a href="reg-comp.html#cb44-24"></a>NewLeagueN  <span class="fl">-0.1798022</span></span></code></pre></div></li>
</ol>
</div>
<div id="comparaison-pcr-vs-pls." class="section level2">
<h2><span class="header-section-number">2.4</span> Comparaison : PCR vs PLS.</h2>
<ol style="list-style-type: decimal">
<li><p>Séparer le jeu de données en un échantillon d’apprentissage de taille 200 et un échantillon test de taille 63.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="reg-comp.html#cb45-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb45-2"><a href="reg-comp.html#cb45-2"></a><span class="op">&gt;</span><span class="st"> </span>perm &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">nrow</span>(Hitters))</span>
<span id="cb45-3"><a href="reg-comp.html#cb45-3"></a><span class="op">&gt;</span><span class="st"> </span>dapp &lt;-<span class="st"> </span>Hitters[perm[<span class="dv">1</span><span class="op">:</span><span class="dv">200</span>],]</span>
<span id="cb45-4"><a href="reg-comp.html#cb45-4"></a><span class="op">&gt;</span><span class="st"> </span>dtest &lt;-<span class="st"> </span>Hitters[perm[<span class="dv">201</span><span class="op">:</span><span class="kw">nrow</span>(Hitters)],]</span></code></pre></div></li>
<li><p>Avec les données d’apprentissage uniquement construire les régressions PCR et PLS. On choisira les nombres de composantes par validation croisée.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="reg-comp.html#cb46-1"></a><span class="op">&gt;</span><span class="st"> </span>choix.pcr &lt;-<span class="st"> </span><span class="kw">pcr</span>(Salary<span class="op">~</span>.,<span class="dt">data=</span>dapp,<span class="dt">validation=</span><span class="st">&quot;CV&quot;</span>)</span>
<span id="cb46-2"><a href="reg-comp.html#cb46-2"></a><span class="op">&gt;</span><span class="st"> </span>ncomp.pcr &lt;-<span class="st"> </span><span class="kw">which.min</span>(choix.pcr<span class="op">$</span>validation<span class="op">$</span>PRESS)</span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="reg-comp.html#cb47-1"></a><span class="op">&gt;</span><span class="st"> </span>choix.pls &lt;-<span class="st"> </span><span class="kw">plsr</span>(Salary<span class="op">~</span>.,<span class="dt">data=</span>dapp,<span class="dt">validation=</span><span class="st">&quot;CV&quot;</span>)</span>
<span id="cb47-2"><a href="reg-comp.html#cb47-2"></a><span class="op">&gt;</span><span class="st"> </span>ncomp.pls &lt;-<span class="st"> </span><span class="kw">which.min</span>(choix.pls<span class="op">$</span>validation<span class="op">$</span>PRESS)</span></code></pre></div></li>
<li><p>Comparer les deux méthodes en utilisant l’échantillon de validation. On pourra également utiliser un modèle linéaire classique.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="reg-comp.html#cb48-1"></a><span class="op">&gt;</span><span class="st"> </span>mod.lin &lt;-<span class="st"> </span><span class="kw">lm</span>(Salary<span class="op">~</span>.,<span class="dt">data=</span>dapp)</span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="reg-comp.html#cb49-1"></a><span class="op">&gt;</span><span class="st"> </span>prev &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb49-2"><a href="reg-comp.html#cb49-2"></a><span class="op">+</span><span class="st">   </span><span class="dt">lin=</span><span class="kw">predict</span>(mod.lin,<span class="dt">newdata=</span>dtest),</span>
<span id="cb49-3"><a href="reg-comp.html#cb49-3"></a><span class="op">+</span><span class="st">   </span><span class="dt">pcr=</span><span class="kw">as.vector</span>(<span class="kw">predict</span>(choix.pcr,<span class="dt">newdata =</span> dtest,<span class="dt">ncomp=</span>ncomp.pcr)),</span>
<span id="cb49-4"><a href="reg-comp.html#cb49-4"></a><span class="op">+</span><span class="st">   </span><span class="dt">pls=</span><span class="kw">as.vector</span>(<span class="kw">predict</span>(choix.pls,<span class="dt">newdata =</span> dtest,<span class="dt">ncomp=</span>ncomp.pls)),</span>
<span id="cb49-5"><a href="reg-comp.html#cb49-5"></a><span class="op">+</span><span class="st">   </span><span class="dt">obs=</span>dtest<span class="op">$</span>Salary</span>
<span id="cb49-6"><a href="reg-comp.html#cb49-6"></a><span class="op">+</span><span class="st"> </span>)</span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="reg-comp.html#cb50-1"></a><span class="op">&gt;</span><span class="st"> </span>prev <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize_at</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="op">~</span>(<span class="kw">mean</span>((.<span class="op">-</span>obs)<span class="op">^</span><span class="dv">2</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sqrt</span>()</span>
<span id="cb50-2"><a href="reg-comp.html#cb50-2"></a>       lin      pcr      pls</span>
<span id="cb50-3"><a href="reg-comp.html#cb50-3"></a><span class="dv">1</span> <span class="fl">334.8819</span> <span class="fl">348.3943</span> <span class="fl">342.7771</span></span></code></pre></div></li>
<li><p>Comparer ces méthodes en faisant une validation croisée 10 blocs.</p>
<div class="corR">
<p>
On définit d’abord les 10 blocs pour la validation croisée.
</p>
</div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="reg-comp.html#cb51-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb51-2"><a href="reg-comp.html#cb51-2"></a><span class="op">&gt;</span><span class="st"> </span>bloc &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="kw">nrow</span>(Hitters),<span class="dt">replace=</span><span class="ot">TRUE</span>)</span>
<span id="cb51-3"><a href="reg-comp.html#cb51-3"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">table</span>(bloc)</span>
<span id="cb51-4"><a href="reg-comp.html#cb51-4"></a>bloc</span>
<span id="cb51-5"><a href="reg-comp.html#cb51-5"></a> <span class="dv">1</span>  <span class="dv">2</span>  <span class="dv">3</span>  <span class="dv">4</span>  <span class="dv">5</span>  <span class="dv">6</span>  <span class="dv">7</span>  <span class="dv">8</span>  <span class="dv">9</span> <span class="dv">10</span> </span>
<span id="cb51-6"><a href="reg-comp.html#cb51-6"></a><span class="dv">19</span> <span class="dv">22</span> <span class="dv">31</span> <span class="dv">29</span> <span class="dv">28</span> <span class="dv">39</span> <span class="dv">19</span> <span class="dv">26</span> <span class="dv">25</span> <span class="dv">25</span> </span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="reg-comp.html#cb52-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">set.seed</span>(<span class="dv">4321</span>)</span>
<span id="cb52-2"><a href="reg-comp.html#cb52-2"></a><span class="op">&gt;</span><span class="st"> </span>prev &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="kw">nrow</span>(Hitters),<span class="dt">ncol=</span><span class="dv">3</span>))</span>
<span id="cb52-3"><a href="reg-comp.html#cb52-3"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">names</span>(prev) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;lin&quot;</span>,<span class="st">&quot;PCR&quot;</span>,<span class="st">&quot;PLS&quot;</span>)</span>
<span id="cb52-4"><a href="reg-comp.html#cb52-4"></a><span class="op">&gt;</span><span class="st"> </span><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</span>
<span id="cb52-5"><a href="reg-comp.html#cb52-5"></a><span class="op">+</span><span class="st"> </span><span class="co">#  print(k)</span></span>
<span id="cb52-6"><a href="reg-comp.html#cb52-6"></a><span class="op">+</span><span class="st">   </span>ind.test &lt;-<span class="st"> </span>bloc<span class="op">==</span>k</span>
<span id="cb52-7"><a href="reg-comp.html#cb52-7"></a><span class="op">+</span><span class="st">   </span>dapp &lt;-<span class="st"> </span>Hitters[<span class="op">!</span>ind.test,]</span>
<span id="cb52-8"><a href="reg-comp.html#cb52-8"></a><span class="op">+</span><span class="st">   </span>dtest &lt;-<span class="st"> </span>Hitters[ind.test,]</span>
<span id="cb52-9"><a href="reg-comp.html#cb52-9"></a><span class="op">+</span><span class="st">   </span>choix.pcr &lt;-<span class="st"> </span><span class="kw">pcr</span>(Salary<span class="op">~</span>.,<span class="dt">data=</span>dapp,<span class="dt">validation=</span><span class="st">&quot;CV&quot;</span>)</span>
<span id="cb52-10"><a href="reg-comp.html#cb52-10"></a><span class="op">+</span><span class="st">   </span>ncomp.pcr &lt;-<span class="st"> </span><span class="kw">which.min</span>(choix.pcr<span class="op">$</span>validation<span class="op">$</span>PRESS)</span>
<span id="cb52-11"><a href="reg-comp.html#cb52-11"></a><span class="op">+</span><span class="st">   </span>choix.pls &lt;-<span class="st"> </span><span class="kw">plsr</span>(Salary<span class="op">~</span>.,<span class="dt">data=</span>dapp,<span class="dt">validation=</span><span class="st">&quot;CV&quot;</span>)</span>
<span id="cb52-12"><a href="reg-comp.html#cb52-12"></a><span class="op">+</span><span class="st">   </span>ncomp.pls &lt;-<span class="st"> </span><span class="kw">which.min</span>(choix.pls<span class="op">$</span>validation<span class="op">$</span>PRESS)</span>
<span id="cb52-13"><a href="reg-comp.html#cb52-13"></a><span class="op">+</span><span class="st">   </span>mod.lin &lt;-<span class="st"> </span><span class="kw">lm</span>(Salary<span class="op">~</span>.,<span class="dt">data=</span>dapp)</span>
<span id="cb52-14"><a href="reg-comp.html#cb52-14"></a><span class="op">+</span><span class="st">   </span>prev[ind.test,] &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb52-15"><a href="reg-comp.html#cb52-15"></a><span class="op">+</span><span class="st"> </span><span class="dt">lin=</span><span class="kw">predict</span>(mod.lin,<span class="dt">newdata=</span>dtest),</span>
<span id="cb52-16"><a href="reg-comp.html#cb52-16"></a><span class="op">+</span><span class="st"> </span><span class="dt">PCR=</span><span class="kw">as.vector</span>(<span class="kw">predict</span>(choix.pcr,<span class="dt">newdata =</span> dtest,<span class="dt">ncomp=</span>ncomp.pcr)),</span>
<span id="cb52-17"><a href="reg-comp.html#cb52-17"></a><span class="op">+</span><span class="st"> </span><span class="dt">PLS=</span><span class="kw">as.vector</span>(<span class="kw">predict</span>(choix.pls,<span class="dt">newdata =</span> dtest,<span class="dt">ncomp=</span>ncomp.pls)))</span>
<span id="cb52-18"><a href="reg-comp.html#cb52-18"></a><span class="op">+</span><span class="st"> </span>}</span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="reg-comp.html#cb53-1"></a><span class="op">&gt;</span><span class="st"> </span>prev <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">obs=</span>Hitters<span class="op">$</span>Salary) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize_at</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="op">~</span>(<span class="kw">mean</span>((.<span class="op">-</span>obs)<span class="op">^</span><span class="dv">2</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sqrt</span>()</span>
<span id="cb53-2"><a href="reg-comp.html#cb53-2"></a>       lin      PCR      PLS</span>
<span id="cb53-3"><a href="reg-comp.html#cb53-3"></a><span class="dv">1</span> <span class="fl">340.0631</span> <span class="fl">343.8019</span> <span class="fl">350.6712</span></span></code></pre></div>
<div class="corR">
<p>
On compare à un modèle qui prédit toujours la moyenne :
</p>
</div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="reg-comp.html#cb54-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">var</span>(Hitters<span class="op">$</span>Salary) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sqrt</span>()</span>
<span id="cb54-2"><a href="reg-comp.html#cb54-2"></a>[<span class="dv">1</span>] <span class="fl">451.1187</span></span></code></pre></div>
<div class="corR">
<p>
On peut retenter l’analyse en considérant toutes les interactions d’ordre 2 :
</p>
</div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="reg-comp.html#cb55-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">set.seed</span>(<span class="dv">54321</span>)</span>
<span id="cb55-2"><a href="reg-comp.html#cb55-2"></a><span class="op">&gt;</span><span class="st"> </span>prev1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="kw">nrow</span>(Hitters),<span class="dt">ncol=</span><span class="dv">3</span>))</span>
<span id="cb55-3"><a href="reg-comp.html#cb55-3"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">names</span>(prev1) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;lin&quot;</span>,<span class="st">&quot;PCR&quot;</span>,<span class="st">&quot;PLS&quot;</span>)</span>
<span id="cb55-4"><a href="reg-comp.html#cb55-4"></a><span class="op">&gt;</span><span class="st"> </span><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</span>
<span id="cb55-5"><a href="reg-comp.html#cb55-5"></a><span class="op">+</span><span class="st"> </span><span class="co">#  print(k)</span></span>
<span id="cb55-6"><a href="reg-comp.html#cb55-6"></a><span class="op">+</span><span class="st">   </span>ind.test &lt;-<span class="st"> </span>bloc<span class="op">==</span>k</span>
<span id="cb55-7"><a href="reg-comp.html#cb55-7"></a><span class="op">+</span><span class="st">   </span>dapp &lt;-<span class="st"> </span>Hitters[<span class="op">!</span>ind.test,]</span>
<span id="cb55-8"><a href="reg-comp.html#cb55-8"></a><span class="op">+</span><span class="st">   </span>dtest &lt;-<span class="st"> </span>Hitters[ind.test,]</span>
<span id="cb55-9"><a href="reg-comp.html#cb55-9"></a><span class="op">+</span><span class="st">   </span>choix.pcr &lt;-<span class="st"> </span><span class="kw">pcr</span>(Salary<span class="op">~</span>.<span class="op">^</span><span class="dv">2</span>,<span class="dt">data=</span>dapp,<span class="dt">validation=</span><span class="st">&quot;CV&quot;</span>)</span>
<span id="cb55-10"><a href="reg-comp.html#cb55-10"></a><span class="op">+</span><span class="st">   </span>ncomp.pcr &lt;-<span class="st"> </span><span class="kw">which.min</span>(choix.pcr<span class="op">$</span>validation<span class="op">$</span>PRESS)</span>
<span id="cb55-11"><a href="reg-comp.html#cb55-11"></a><span class="op">+</span><span class="st">   </span>choix.pls &lt;-<span class="st"> </span><span class="kw">plsr</span>(Salary<span class="op">~</span>.<span class="op">^</span><span class="dv">2</span>,<span class="dt">data=</span>dapp,<span class="dt">validation=</span><span class="st">&quot;CV&quot;</span>)</span>
<span id="cb55-12"><a href="reg-comp.html#cb55-12"></a><span class="op">+</span><span class="st">   </span>ncomp.pls &lt;-<span class="st"> </span><span class="kw">which.min</span>(choix.pls<span class="op">$</span>validation<span class="op">$</span>PRESS)</span>
<span id="cb55-13"><a href="reg-comp.html#cb55-13"></a><span class="op">+</span><span class="st">   </span>mod.lin &lt;-<span class="st"> </span><span class="kw">lm</span>(Salary<span class="op">~</span>.<span class="op">^</span><span class="dv">2</span>,<span class="dt">data=</span>dapp)</span>
<span id="cb55-14"><a href="reg-comp.html#cb55-14"></a><span class="op">+</span><span class="st">   </span>prev1[ind.test,] &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb55-15"><a href="reg-comp.html#cb55-15"></a><span class="op">+</span><span class="st"> </span><span class="dt">lin=</span><span class="kw">predict</span>(mod.lin,<span class="dt">newdata=</span>dtest),</span>
<span id="cb55-16"><a href="reg-comp.html#cb55-16"></a><span class="op">+</span><span class="st"> </span><span class="dt">PCR=</span><span class="kw">as.vector</span>(<span class="kw">predict</span>(choix.pcr,<span class="dt">newdata =</span> dtest,<span class="dt">ncomp=</span>ncomp.pcr)),</span>
<span id="cb55-17"><a href="reg-comp.html#cb55-17"></a><span class="op">+</span><span class="st"> </span><span class="dt">PLS=</span><span class="kw">as.vector</span>(<span class="kw">predict</span>(choix.pls,<span class="dt">newdata =</span> dtest,<span class="dt">ncomp=</span>ncomp.pls)))</span>
<span id="cb55-18"><a href="reg-comp.html#cb55-18"></a><span class="op">+</span><span class="st"> </span>}</span></code></pre></div>
<div class="corR">
<p>
On obtient les performances suivantes :
</p>
</div>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="reg-comp.html#cb56-1"></a><span class="op">&gt;</span><span class="st"> </span>prev1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">obs=</span>Hitters<span class="op">$</span>Salary) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize_at</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="op">~</span>(<span class="kw">mean</span>((.<span class="op">-</span>obs)<span class="op">^</span><span class="dv">2</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sqrt</span>()</span>
<span id="cb56-2"><a href="reg-comp.html#cb56-2"></a>       lin      PCR      PLS</span>
<span id="cb56-3"><a href="reg-comp.html#cb56-3"></a><span class="dv">1</span> <span class="fl">1494.847</span> <span class="fl">330.0474</span> <span class="fl">349.1116</span></span></code></pre></div>
<div class="corR">
<p>
On mesure bien l’intérêt de réduire la dimension dans ce nouveau contexte.
</p>
</div></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro-grande-dim.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reg-pen.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["TUTO_GRANDE_DIM.pdf", "TUTO_GRANDE_DIM.epub"],
"toc": {
"collapse": "subsection",
"fontsettings": {
"theme": "white",
"size": 2,
"family": "sans"
},
"sharing": {
"facebook": true,
"github": true,
"twitter": true
}
},
"highlight": "default"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
