<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 2 Régression sur composantes | Régression en grande dimension</title>
  <meta name="description" content="Chapitre 2 Régression sur composantes | Régression en grande dimension" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 2 Régression sur composantes | Régression en grande dimension" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 2 Régression sur composantes | Régression en grande dimension" />
  
  
  

<meta name="author" content="Laurent Rouvière" />


<meta name="date" content="2020-06-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro-grande-dim.html"/>
<link rel="next" href="reg-pen.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Régression en grande dimension<br> <br> L. Rouvière</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Présentation</a></li>
<li class="chapter" data-level="1" data-path="intro-grande-dim.html"><a href="intro-grande-dim.html"><i class="fa fa-check"></i><b>1</b> Introduction à la grande dimension</a><ul>
<li class="chapter" data-level="1.1" data-path="intro-grande-dim.html"><a href="intro-grande-dim.html#fléau-de-la-dimension-pour-les-plus-proches-voisins"><i class="fa fa-check"></i><b>1.1</b> Fléau de la dimension pour les plus proches voisins</a></li>
<li class="chapter" data-level="1.2" data-path="intro-grande-dim.html"><a href="intro-grande-dim.html#influence-de-la-dimension-dans-le-modèle-linéaire"><i class="fa fa-check"></i><b>1.2</b> Influence de la dimension dans le modèle linéaire</a></li>
<li class="chapter" data-level="1.3" data-path="intro-grande-dim.html"><a href="intro-grande-dim.html#exercices"><i class="fa fa-check"></i><b>1.3</b> Exercices</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reg-comp.html"><a href="reg-comp.html"><i class="fa fa-check"></i><b>2</b> Régression sur composantes</a><ul>
<li class="chapter" data-level="2.1" data-path="reg-comp.html"><a href="reg-comp.html#régression-sur-composantes-principales-méthodo"><i class="fa fa-check"></i><b>2.1</b> Régression sur composantes principales (méthodo)</a></li>
<li class="chapter" data-level="2.2" data-path="reg-comp.html"><a href="reg-comp.html#régression-pls-méthodo"><i class="fa fa-check"></i><b>2.2</b> Régression PLS : méthodo</a></li>
<li class="chapter" data-level="2.3" data-path="reg-comp.html"><a href="reg-comp.html#comparaison-pcr-vs-pls."><i class="fa fa-check"></i><b>2.3</b> Comparaison : PCR vs PLS.</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="reg-pen.html"><a href="reg-pen.html"><i class="fa fa-check"></i><b>3</b> Régressions pénalisées (ou sous contraintes)</a><ul>
<li class="chapter" data-level="3.1" data-path="reg-pen.html"><a href="reg-pen.html#ridge-et-lasso-avec-glmnet"><i class="fa fa-check"></i><b>3.1</b> Ridge et lasso avec glmnet</a></li>
<li class="chapter" data-level="3.2" data-path="reg-pen.html"><a href="reg-pen.html#reconstruction-dun-signal"><i class="fa fa-check"></i><b>3.2</b> Reconstruction d’un signal</a></li>
<li class="chapter" data-level="3.3" data-path="reg-pen.html"><a href="reg-pen.html#régression-logistique-pénalisée"><i class="fa fa-check"></i><b>3.3</b> Régression logistique pénalisée</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mod-add.html"><a href="mod-add.html"><i class="fa fa-check"></i><b>4</b> Modèle additif</a><ul>
<li class="chapter" data-level="4.1" data-path="mod-add.html"><a href="mod-add.html#pseudo-backfitting"><i class="fa fa-check"></i><b>4.1</b> Pseudo backfitting</a></li>
<li class="chapter" data-level="4.2" data-path="mod-add.html"><a href="mod-add.html#modèle-gam"><i class="fa fa-check"></i><b>4.2</b> Modèle GAM</a></li>
<li class="chapter" data-level="4.3" data-path="mod-add.html"><a href="mod-add.html#régression-logistique-additive"><i class="fa fa-check"></i><b>4.3</b> Régression logistique additive</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="références.html"><a href="références.html"><i class="fa fa-check"></i>Références</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Régression en grande dimension</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="reg-comp" class="section level1">
<h1><span class="header-section-number">Chapitre 2</span> Régression sur composantes</h1>
<div id="régression-sur-composantes-principales-méthodo" class="section level2">
<h2><span class="header-section-number">2.1</span> Régression sur composantes principales (méthodo)</h2>
<p>On considère le jeu de données <strong>Hitters</strong> dans lequel où on souhaite expliquer la variable <strong>Salary</strong> par les autres variables du jeu de données. On supprime les individus qui possèdent des données manquantes.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="reg-comp.html#cb18-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(ISLR)</span>
<span id="cb18-2"><a href="reg-comp.html#cb18-2"></a><span class="op">&gt;</span><span class="st"> </span>Hitters &lt;-<span class="st"> </span><span class="kw">na.omit</span>(Hitters)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p>Parmi les variables explicatives, certaines sont qualitatives. Expliquer comment, à l’aide de la fonction <strong>model.matrix</strong> on peut utiliser ces variables dans un modèle linéaire. On appellera <strong>X</strong> la matrice des variables explicatives construites avec cette variable.</p>
<div class="corR">
<p>
Comme pour le modèle linéaire, on utilise des contraintes identifiantes. Cela revient à prendre une modalité de référence et à coder les autres modalités par 0-1.
</p>
</div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="reg-comp.html#cb19-1"></a><span class="op">&gt;</span><span class="st"> </span>X &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(Salary<span class="op">~</span>.,<span class="dt">data=</span>Hitters)[,<span class="op">-</span><span class="dv">1</span>]</span></code></pre></div></li>
<li><p>Calculer la matrice <strong>Xcr</strong> qui correspond à la matrice <strong>X</strong> centrée réduite. On pourra utiliser la fonction <code>scale</code>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="reg-comp.html#cb20-1"></a><span class="op">&gt;</span><span class="st"> </span>Xcr &lt;-<span class="st"> </span><span class="kw">scale</span>(X)</span>
<span id="cb20-2"><a href="reg-comp.html#cb20-2"></a><span class="op">&gt;</span><span class="st"> </span>Xbar  &lt;-<span class="st"> </span><span class="kw">apply</span>(X,<span class="dv">2</span>,mean)</span>
<span id="cb20-3"><a href="reg-comp.html#cb20-3"></a><span class="op">&gt;</span><span class="st"> </span>stdX &lt;-<span class="st"> </span><span class="kw">apply</span>(X,<span class="dv">2</span>,sd)</span></code></pre></div></li>
<li><p>A l’aide de la fonction <code>PCA</code> du package <strong>FactoMineR</strong>, effectuer l’ACP du tableau <strong>Xcr</strong> avec l’option <code>scale.unit=FALSE</code>.</p>
<div class="corR">
<p>
On utilise ici <code>scale.unit=FALSE</code> car les données sont déjà centrées-réduites. Ca nous permet de contrôler cette étape.
</p>
</div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="reg-comp.html#cb21-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(FactoMineR)</span>
<span id="cb21-2"><a href="reg-comp.html#cb21-2"></a><span class="op">&gt;</span><span class="st"> </span>acp.hit &lt;-<span class="st"> </span><span class="kw">PCA</span>(Xcr,<span class="dt">scale.unit=</span><span class="ot">FALSE</span>,<span class="dt">graph=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="TUTO_GRANDE_DIM_files/figure-html/unnamed-chunk-36-1.png" width="672" style="display: block; margin: auto;" /><img src="TUTO_GRANDE_DIM_files/figure-html/unnamed-chunk-36-2.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Récupérer les coordonnées des individus sur les 5 premiers axes de l’ACP (variables <span class="math inline">\(Z\)</span> dans le cours).</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="reg-comp.html#cb22-1"></a><span class="op">&gt;</span><span class="st"> </span>Z &lt;-<span class="st"> </span>acp.hit<span class="op">$</span>ind<span class="op">$</span>coord</span></code></pre></div></li>
<li><p>Effectuer la régression linéaire sur les 5 premières composantes principales et calculer les estimateurs des MCO (<span class="math inline">\(\widehat\theta_k,k=1,\dots,5\)</span> dans le cours).</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="reg-comp.html#cb23-1"></a><span class="op">&gt;</span><span class="st"> </span>donnees &lt;-<span class="st"> </span><span class="kw">cbind.data.frame</span>(Z,<span class="dt">Salary=</span>Hitters<span class="op">$</span>Salary)</span>
<span id="cb23-2"><a href="reg-comp.html#cb23-2"></a><span class="op">&gt;</span><span class="st"> </span>mod &lt;-<span class="st"> </span><span class="kw">lm</span>(Salary<span class="op">~</span>.,<span class="dt">data=</span>donnees)</span>
<span id="cb23-3"><a href="reg-comp.html#cb23-3"></a><span class="op">&gt;</span><span class="st"> </span>theta &lt;-<span class="st"> </span><span class="kw">coef</span>(mod)</span>
<span id="cb23-4"><a href="reg-comp.html#cb23-4"></a><span class="op">&gt;</span><span class="st"> </span>theta</span>
<span id="cb23-5"><a href="reg-comp.html#cb23-5"></a><span class="co">## (Intercept)       Dim.1       Dim.2       Dim.3       Dim.4       Dim.5 </span></span>
<span id="cb23-6"><a href="reg-comp.html#cb23-6"></a><span class="co">##   535.92588   106.57139    21.64469    24.34057    37.05637   -58.52540</span></span></code></pre></div>
<div class="corR">
<p>
<strong>Remarque</strong> : on peut aussi tout faire “à la main” (sans utiliser <strong>PCA</strong>)
</p>
</div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="reg-comp.html#cb24-1"></a><span class="op">&gt;</span><span class="st"> </span>acp.main &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">t</span>(Xcr)<span class="op">%*%</span>Xcr)</span>
<span id="cb24-2"><a href="reg-comp.html#cb24-2"></a><span class="op">&gt;</span><span class="st"> </span>U &lt;-<span class="st"> </span>acp.main<span class="op">$</span>vectors</span>
<span id="cb24-3"><a href="reg-comp.html#cb24-3"></a><span class="op">&gt;</span><span class="st"> </span>CC &lt;-<span class="st"> </span>Xcr<span class="op">%*%</span>(<span class="op">-</span>U[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</span>
<span id="cb24-4"><a href="reg-comp.html#cb24-4"></a><span class="op">&gt;</span><span class="st"> </span>D &lt;-<span class="st"> </span><span class="kw">cbind.data.frame</span>(CC,<span class="dt">Salary=</span>Hitters<span class="op">$</span>Salary)</span>
<span id="cb24-5"><a href="reg-comp.html#cb24-5"></a><span class="op">&gt;</span><span class="st"> </span>modS &lt;-<span class="st"> </span><span class="kw">lm</span>(Salary<span class="op">~</span>.,<span class="dt">data=</span>D)</span>
<span id="cb24-6"><a href="reg-comp.html#cb24-6"></a><span class="op">&gt;</span><span class="st"> </span>coefS &lt;-<span class="st"> </span>modS<span class="op">$</span>coefficients</span>
<span id="cb24-7"><a href="reg-comp.html#cb24-7"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">coef</span>(modS)</span>
<span id="cb24-8"><a href="reg-comp.html#cb24-8"></a><span class="co">## (Intercept)         `1`         `2`         `3`         `4`         `5` </span></span>
<span id="cb24-9"><a href="reg-comp.html#cb24-9"></a><span class="co">##   535.92588   106.57139    21.64469    24.34057    37.05637   -58.52540</span></span></code></pre></div></li>
<li><p>En déduire les estimateurs dans l’espace des données initiales pour les données centrées réduites, puis pour les données brutes. On pourra récupérer les vecteurs propres de l’ACP (<span class="math inline">\(u_k\)</span> dans le cours) dans la sortie <strong>svd</strong> de la fonction <strong>PCA</strong></p>
<div class="corR">
<ul>
<li>
<p>Pour les données centrées-réduites, les coefficients s’obtiennent avec les formules vues en cours</p>
</li>
</ul>
<p>
<p><span class="math display"><span class="math display">\[\widehat\beta_0=\bar y\quad\text{et}\quad \widehat\beta_j=\widehat{\theta}^\prime v_j.\]</span></span></p>
</p>
</div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="reg-comp.html#cb25-1"></a> <span class="op">&gt;</span><span class="st"> </span>U &lt;-<span class="st"> </span>acp.hit<span class="op">$</span>svd<span class="op">$</span>V</span>
<span id="cb25-2"><a href="reg-comp.html#cb25-2"></a> <span class="op">&gt;</span><span class="st"> </span>V &lt;-<span class="st"> </span><span class="kw">t</span>(U)</span>
<span id="cb25-3"><a href="reg-comp.html#cb25-3"></a> <span class="op">&gt;</span><span class="st"> </span>beta0.cr &lt;-<span class="st"> </span><span class="kw">mean</span>(Hitters<span class="op">$</span>Salary)</span>
<span id="cb25-4"><a href="reg-comp.html#cb25-4"></a> <span class="op">&gt;</span><span class="st"> </span>beta.cr &lt;-<span class="st"> </span><span class="kw">as.vector</span>(theta[<span class="dv">2</span><span class="op">:</span><span class="dv">6</span>])<span class="op">%*%</span>V</span>
<span id="cb25-5"><a href="reg-comp.html#cb25-5"></a> <span class="op">&gt;</span><span class="st"> </span>beta.cr</span>
<span id="cb25-6"><a href="reg-comp.html#cb25-6"></a> <span class="co">##          [,1]     [,2]    [,3]     [,4]     [,5]     [,6]     [,7]     [,8]</span></span>
<span id="cb25-7"><a href="reg-comp.html#cb25-7"></a> <span class="co">## [1,] 28.76604 30.44702 25.8445 33.00088 33.81997 35.08779 22.35103 29.01477</span></span>
<span id="cb25-8"><a href="reg-comp.html#cb25-8"></a> <span class="co">##          [,9]    [,10]    [,11]    [,12]    [,13]  [,14]     [,15]    [,16]</span></span>
<span id="cb25-9"><a href="reg-comp.html#cb25-9"></a> <span class="co">## [1,] 29.78584 30.00201 32.06912 31.11231 31.48735 19.439 -63.20387 17.36044</span></span>
<span id="cb25-10"><a href="reg-comp.html#cb25-10"></a> <span class="co">##          [,17]     [,18]    [,19]</span></span>
<span id="cb25-11"><a href="reg-comp.html#cb25-11"></a> <span class="co">## [1,] -5.523264 -6.044002 21.74267</span></span></code></pre></div>
<div class="corR">
<ul>
<li>
<p>Pour les données brutes, on utilise les formules :</p>
</li>
</ul>
<p>
<p><span class="math display"><span class="math display">\[\widehat\beta_0=\bar y-\sum_{j=1}^p\widehat\theta^\prime v_j\frac{\bar x_j}{\sigma_{x_j}}\quad\text{et}\quad\widehat\beta_j=\frac{\widehat\theta^\prime v_j}{\sigma_{X_j}},j=1,\dots,p.\]</span></span></p>
</p>
</div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="reg-comp.html#cb26-1"></a> <span class="op">&gt;</span><span class="st"> </span>beta0 &lt;-<span class="st"> </span>beta0.cr<span class="op">-</span><span class="kw">sum</span>(beta.cr<span class="op">*</span>Xbar<span class="op">/</span>stdX)</span>
<span id="cb26-2"><a href="reg-comp.html#cb26-2"></a> <span class="op">&gt;</span><span class="st"> </span>beta &lt;-<span class="st"> </span>beta.cr<span class="op">/</span>stdX</span>
<span id="cb26-3"><a href="reg-comp.html#cb26-3"></a> <span class="op">&gt;</span><span class="st"> </span>beta0</span>
<span id="cb26-4"><a href="reg-comp.html#cb26-4"></a> <span class="co">## [1] -58.32022</span></span>
<span id="cb26-5"><a href="reg-comp.html#cb26-5"></a> <span class="op">&gt;</span><span class="st"> </span>beta</span>
<span id="cb26-6"><a href="reg-comp.html#cb26-6"></a> <span class="co">##           [,1]      [,2]    [,3]     [,4]     [,5]     [,6]     [,7]       [,8]</span></span>
<span id="cb26-7"><a href="reg-comp.html#cb26-7"></a> <span class="co">## [1,] 0.1952793 0.6747214 2.95126 1.292134 1.306662 1.615605 4.662667 0.01268914</span></span>
<span id="cb26-8"><a href="reg-comp.html#cb26-8"></a> <span class="co">##            [,9]     [,10]      [,11]      [,12]    [,13]    [,14]   [,15]</span></span>
<span id="cb26-9"><a href="reg-comp.html#cb26-9"></a> <span class="co">## [1,] 0.04595165 0.3649987 0.09682748 0.09621344 0.119245 38.86728 -126.19</span></span>
<span id="cb26-10"><a href="reg-comp.html#cb26-10"></a> <span class="co">##           [,16]       [,17]      [,18]    [,19]</span></span>
<span id="cb26-11"><a href="reg-comp.html#cb26-11"></a> <span class="co">## [1,] 0.06201606 -0.03807032 -0.9148466 43.51629</span></span></code></pre></div></li>
<li><p>Retrouver les estimateurs dans l’espace des données initiales pour les données centrées réduites à l’aide de la fonction <code>pcr</code> du package <strong>pls</strong>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="reg-comp.html#cb27-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(pls)</span>
<span id="cb27-2"><a href="reg-comp.html#cb27-2"></a><span class="op">&gt;</span><span class="st"> </span>pcr.fit &lt;-<span class="st"> </span><span class="kw">pcr</span>(Salary<span class="op">~</span>.,<span class="dt">data=</span>Hitters,<span class="dt">scale=</span><span class="ot">TRUE</span>,<span class="dt">ncomp=</span><span class="dv">19</span>)</span>
<span id="cb27-3"><a href="reg-comp.html#cb27-3"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">coefficients</span>(pcr.fit,<span class="dt">ncomp=</span><span class="dv">5</span>)</span>
<span id="cb27-4"><a href="reg-comp.html#cb27-4"></a><span class="co">## , , 5 comps</span></span>
<span id="cb27-5"><a href="reg-comp.html#cb27-5"></a><span class="co">## </span></span>
<span id="cb27-6"><a href="reg-comp.html#cb27-6"></a><span class="co">##                Salary</span></span>
<span id="cb27-7"><a href="reg-comp.html#cb27-7"></a><span class="co">## AtBat       28.766042</span></span>
<span id="cb27-8"><a href="reg-comp.html#cb27-8"></a><span class="co">## Hits        30.447021</span></span>
<span id="cb27-9"><a href="reg-comp.html#cb27-9"></a><span class="co">## HmRun       25.844498</span></span>
<span id="cb27-10"><a href="reg-comp.html#cb27-10"></a><span class="co">## Runs        33.000876</span></span>
<span id="cb27-11"><a href="reg-comp.html#cb27-11"></a><span class="co">## RBI         33.819966</span></span>
<span id="cb27-12"><a href="reg-comp.html#cb27-12"></a><span class="co">## Walks       35.087794</span></span>
<span id="cb27-13"><a href="reg-comp.html#cb27-13"></a><span class="co">## Years       22.351033</span></span>
<span id="cb27-14"><a href="reg-comp.html#cb27-14"></a><span class="co">## CAtBat      29.014768</span></span>
<span id="cb27-15"><a href="reg-comp.html#cb27-15"></a><span class="co">## CHits       29.785842</span></span>
<span id="cb27-16"><a href="reg-comp.html#cb27-16"></a><span class="co">## CHmRun      30.002014</span></span>
<span id="cb27-17"><a href="reg-comp.html#cb27-17"></a><span class="co">## CRuns       32.069124</span></span>
<span id="cb27-18"><a href="reg-comp.html#cb27-18"></a><span class="co">## CRBI        31.112315</span></span>
<span id="cb27-19"><a href="reg-comp.html#cb27-19"></a><span class="co">## CWalks      31.487349</span></span>
<span id="cb27-20"><a href="reg-comp.html#cb27-20"></a><span class="co">## LeagueN     19.438996</span></span>
<span id="cb27-21"><a href="reg-comp.html#cb27-21"></a><span class="co">## DivisionW  -63.203872</span></span>
<span id="cb27-22"><a href="reg-comp.html#cb27-22"></a><span class="co">## PutOuts     17.360440</span></span>
<span id="cb27-23"><a href="reg-comp.html#cb27-23"></a><span class="co">## Assists     -5.523264</span></span>
<span id="cb27-24"><a href="reg-comp.html#cb27-24"></a><span class="co">## Errors      -6.044002</span></span>
<span id="cb27-25"><a href="reg-comp.html#cb27-25"></a><span class="co">## NewLeagueN  21.742668</span></span></code></pre></div></li>
<li><p>On considère les individus suivants</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="reg-comp.html#cb28-1"></a><span class="op">&gt;</span><span class="st"> </span>df.new &lt;-<span class="st"> </span>Hitters[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">80</span>),]</span></code></pre></div>
<p>Calculer de 3 façons différentes les valeurs de salaire prédites par la régression sur 5 composantes principales.</p>
<div class="corR">
<ul>
<li>
<p>Approche classique : on utilise <code>predict.pcr</code> :</p>
</li>
</ul>
</div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="reg-comp.html#cb29-1"></a> <span class="op">&gt;</span><span class="st"> </span><span class="kw">predict</span>(pcr.fit,<span class="dt">newdata=</span>df.new,<span class="dt">ncomp=</span><span class="dv">5</span>)</span>
<span id="cb29-2"><a href="reg-comp.html#cb29-2"></a> <span class="co">## , , 5 comps</span></span>
<span id="cb29-3"><a href="reg-comp.html#cb29-3"></a> <span class="co">## </span></span>
<span id="cb29-4"><a href="reg-comp.html#cb29-4"></a> <span class="co">##                 Salary</span></span>
<span id="cb29-5"><a href="reg-comp.html#cb29-5"></a> <span class="co">## -Alan Ashby   495.0068</span></span>
<span id="cb29-6"><a href="reg-comp.html#cb29-6"></a> <span class="co">## -Hubie Brooks 577.9581</span></span>
<span id="cb29-7"><a href="reg-comp.html#cb29-7"></a> <span class="co">## -George Bell  822.0296</span></span></code></pre></div>
<div class="corR">
<ul>
<li>
<p>On considère les valeurs centrées réduites et on utilise :</p>
</li>
</ul>
<p>
<p><span class="math display"><span class="math display">\[\widehat y=\bar y+ \widehat\theta^\prime v_1\tilde x_1+\cdots+\widehat\theta^\prime v_p\tilde x_p\]</span></span></p>
</p>
</div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="reg-comp.html#cb30-1"></a> <span class="op">&gt;</span><span class="st"> </span><span class="kw">t</span>(<span class="kw">as.matrix</span>(<span class="kw">coefficients</span>(pcr.fit,<span class="dt">ncomp=</span><span class="dv">5</span>))) <span class="op">%*%</span><span class="st"> </span></span>
<span id="cb30-2"><a href="reg-comp.html#cb30-2"></a><span class="st"> </span><span class="op">+</span><span class="st">   </span><span class="kw">t</span>(<span class="kw">as.matrix</span>(Xcr[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">80</span>),]))<span class="op">+</span><span class="kw">mean</span>(Hitters<span class="op">$</span>Salary)</span>
<span id="cb30-3"><a href="reg-comp.html#cb30-3"></a> <span class="co">##      -Alan Ashby -Hubie Brooks -George Bell</span></span>
<span id="cb30-4"><a href="reg-comp.html#cb30-4"></a> <span class="co">## [1,]    495.0068      577.9581     822.0296</span></span>
<span id="cb30-5"><a href="reg-comp.html#cb30-5"></a> <span class="op">&gt;</span><span class="st"> </span><span class="co">#ou</span></span>
<span id="cb30-6"><a href="reg-comp.html#cb30-6"></a><span class="st"> </span><span class="er">&gt;</span><span class="st"> </span>beta0.cr<span class="op">+</span>beta.cr<span class="op">%*%</span><span class="kw">t</span>(<span class="kw">as.matrix</span>(Xcr[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">80</span>),]))</span>
<span id="cb30-7"><a href="reg-comp.html#cb30-7"></a> <span class="co">##      -Alan Ashby -Hubie Brooks -George Bell</span></span>
<span id="cb30-8"><a href="reg-comp.html#cb30-8"></a> <span class="co">## [1,]    495.0068      577.9581     822.0296</span></span></code></pre></div>
<div class="corR">
<ul>
<li>
<p>On considère les données brutes et on utilise :</p>
</li>
</ul>
<p>
<p><span class="math display"><span class="math display">\[\widehat y=\widehat\beta_0+\widehat\beta_1x_1+\cdots+\widehat\beta_px_p\]</span></span></p>
</p>
</div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="reg-comp.html#cb31-1"></a> <span class="op">&gt;</span><span class="st"> </span>beta0<span class="op">+</span>beta <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(<span class="kw">as.matrix</span>(X[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">80</span>),]))</span>
<span id="cb31-2"><a href="reg-comp.html#cb31-2"></a> <span class="co">##      -Alan Ashby -Hubie Brooks -George Bell</span></span>
<span id="cb31-3"><a href="reg-comp.html#cb31-3"></a> <span class="co">## [1,]    495.0068      577.9581     822.0296</span></span></code></pre></div></li>
</ol>
</div>
<div id="régression-pls-méthodo" class="section level2">
<h2><span class="header-section-number">2.2</span> Régression PLS : méthodo</h2>
<p>On considère les mêmes données que précédemment.</p>
<ol style="list-style-type: decimal">
<li><p>A l’aide du vecteur <span class="math inline">\(Y\)</span> (<em>Salary</em>) et de la matrice des <span class="math inline">\(X\)</span> centrées réduites calculées dans l’exercice précédent, calculer la première composante <strong>PLS</strong> <span class="math inline">\(Z_1\)</span>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="reg-comp.html#cb32-1"></a><span class="op">&gt;</span><span class="st"> </span>Y &lt;-<span class="st"> </span><span class="kw">as.vector</span>(Hitters<span class="op">$</span>Salary)</span>
<span id="cb32-2"><a href="reg-comp.html#cb32-2"></a><span class="op">&gt;</span><span class="st"> </span>w1 &lt;-<span class="st"> </span><span class="kw">t</span>(Xcr)<span class="op">%*%</span>Y</span>
<span id="cb32-3"><a href="reg-comp.html#cb32-3"></a><span class="op">&gt;</span><span class="st"> </span>w1</span>
<span id="cb32-4"><a href="reg-comp.html#cb32-4"></a><span class="co">##                   [,1]</span></span>
<span id="cb32-5"><a href="reg-comp.html#cb32-5"></a><span class="co">## AtBat       46659.1995</span></span>
<span id="cb32-6"><a href="reg-comp.html#cb32-6"></a><span class="co">## Hits        51848.3247</span></span>
<span id="cb32-7"><a href="reg-comp.html#cb32-7"></a><span class="co">## HmRun       40543.5500</span></span>
<span id="cb32-8"><a href="reg-comp.html#cb32-8"></a><span class="co">## Runs        49624.3823</span></span>
<span id="cb32-9"><a href="reg-comp.html#cb32-9"></a><span class="co">## RBI         53122.7240</span></span>
<span id="cb32-10"><a href="reg-comp.html#cb32-10"></a><span class="co">## Walks       52462.0450</span></span>
<span id="cb32-11"><a href="reg-comp.html#cb32-11"></a><span class="co">## Years       47354.8899</span></span>
<span id="cb32-12"><a href="reg-comp.html#cb32-12"></a><span class="co">## CAtBat      62185.5603</span></span>
<span id="cb32-13"><a href="reg-comp.html#cb32-13"></a><span class="co">## CHits       64877.3193</span></span>
<span id="cb32-14"><a href="reg-comp.html#cb32-14"></a><span class="co">## CHmRun      62043.1671</span></span>
<span id="cb32-15"><a href="reg-comp.html#cb32-15"></a><span class="co">## CRuns       66504.6198</span></span>
<span id="cb32-16"><a href="reg-comp.html#cb32-16"></a><span class="co">## CRBI        67011.4288</span></span>
<span id="cb32-17"><a href="reg-comp.html#cb32-17"></a><span class="co">## CWalks      57893.5821</span></span>
<span id="cb32-18"><a href="reg-comp.html#cb32-18"></a><span class="co">## LeagueN     -1688.0134</span></span>
<span id="cb32-19"><a href="reg-comp.html#cb32-19"></a><span class="co">## DivisionW  -22753.8726</span></span>
<span id="cb32-20"><a href="reg-comp.html#cb32-20"></a><span class="co">## PutOuts     35514.7030</span></span>
<span id="cb32-21"><a href="reg-comp.html#cb32-21"></a><span class="co">## Assists      3006.3756</span></span>
<span id="cb32-22"><a href="reg-comp.html#cb32-22"></a><span class="co">## Errors       -638.3256</span></span>
<span id="cb32-23"><a href="reg-comp.html#cb32-23"></a><span class="co">## NewLeagueN   -335.0136</span></span>
<span id="cb32-24"><a href="reg-comp.html#cb32-24"></a><span class="op">&gt;</span><span class="st"> </span>Z1 &lt;-<span class="st"> </span>Xcr<span class="op">%*%</span>w1</span></code></pre></div></li>
<li><p>En déduire le coefficient associé à cette première composante en considérant le modèle
<span class="math display">\[Y=\alpha_1 Z_1+\varepsilon.\]</span></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="reg-comp.html#cb33-1"></a><span class="op">&gt;</span><span class="st"> </span>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Z1,Y)</span>
<span id="cb33-2"><a href="reg-comp.html#cb33-2"></a><span class="op">&gt;</span><span class="st"> </span>mod1 &lt;-<span class="st"> </span><span class="kw">lm</span>(Y<span class="op">~</span>Z1<span class="dv">-1</span>,<span class="dt">data=</span>df)</span>
<span id="cb33-3"><a href="reg-comp.html#cb33-3"></a><span class="op">&gt;</span><span class="st"> </span>alpha1 &lt;-<span class="st"> </span><span class="kw">coef</span>(mod1)</span>
<span id="cb33-4"><a href="reg-comp.html#cb33-4"></a><span class="op">&gt;</span><span class="st"> </span>alpha1</span>
<span id="cb33-5"><a href="reg-comp.html#cb33-5"></a><span class="co">##           Z1 </span></span>
<span id="cb33-6"><a href="reg-comp.html#cb33-6"></a><span class="co">## 0.0005367014</span></span></code></pre></div></li>
<li><p>En déduire les coefficients en fonction des variables initiales (centrées réduites) de la régression PLS à une composante
<span class="math display">\[Y=\beta_0+\beta_1X_1+\dots+\beta_pX_p+\varepsilon.\]</span></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="reg-comp.html#cb34-1"></a><span class="op">&gt;</span><span class="st"> </span>alpha1<span class="op">*</span>w1</span>
<span id="cb34-2"><a href="reg-comp.html#cb34-2"></a><span class="co">##                   [,1]</span></span>
<span id="cb34-3"><a href="reg-comp.html#cb34-3"></a><span class="co">## AtBat       25.0420570</span></span>
<span id="cb34-4"><a href="reg-comp.html#cb34-4"></a><span class="co">## Hits        27.8270677</span></span>
<span id="cb34-5"><a href="reg-comp.html#cb34-5"></a><span class="co">## HmRun       21.7597795</span></span>
<span id="cb34-6"><a href="reg-comp.html#cb34-6"></a><span class="co">## Runs        26.6334747</span></span>
<span id="cb34-7"><a href="reg-comp.html#cb34-7"></a><span class="co">## RBI         28.5110396</span></span>
<span id="cb34-8"><a href="reg-comp.html#cb34-8"></a><span class="co">## Walks       28.1564522</span></span>
<span id="cb34-9"><a href="reg-comp.html#cb34-9"></a><span class="co">## Years       25.4154350</span></span>
<span id="cb34-10"><a href="reg-comp.html#cb34-10"></a><span class="co">## CAtBat      33.3750764</span></span>
<span id="cb34-11"><a href="reg-comp.html#cb34-11"></a><span class="co">## CHits       34.8197471</span></span>
<span id="cb34-12"><a href="reg-comp.html#cb34-12"></a><span class="co">## CHmRun      33.2986538</span></span>
<span id="cb34-13"><a href="reg-comp.html#cb34-13"></a><span class="co">## CRuns       35.6931216</span></span>
<span id="cb34-14"><a href="reg-comp.html#cb34-14"></a><span class="co">## CRBI        35.9651267</span></span>
<span id="cb34-15"><a href="reg-comp.html#cb34-15"></a><span class="co">## CWalks      31.0715657</span></span>
<span id="cb34-16"><a href="reg-comp.html#cb34-16"></a><span class="co">## LeagueN     -0.9059591</span></span>
<span id="cb34-17"><a href="reg-comp.html#cb34-17"></a><span class="co">## DivisionW  -12.2120349</span></span>
<span id="cb34-18"><a href="reg-comp.html#cb34-18"></a><span class="co">## PutOuts     19.0607903</span></span>
<span id="cb34-19"><a href="reg-comp.html#cb34-19"></a><span class="co">## Assists      1.6135259</span></span>
<span id="cb34-20"><a href="reg-comp.html#cb34-20"></a><span class="co">## Errors      -0.3425902</span></span>
<span id="cb34-21"><a href="reg-comp.html#cb34-21"></a><span class="co">## NewLeagueN  -0.1798022</span></span></code></pre></div></li>
<li><p>Retrouver ces coefficients en utilisant la fonction <code>plsr</code>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="reg-comp.html#cb35-1"></a><span class="op">&gt;</span><span class="st"> </span>pls.fit &lt;-<span class="st"> </span><span class="kw">plsr</span>(Salary<span class="op">~</span>.,<span class="dt">data=</span>Hitters,<span class="dt">scale=</span><span class="ot">TRUE</span>)</span>
<span id="cb35-2"><a href="reg-comp.html#cb35-2"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">coefficients</span>(pls.fit,<span class="dt">ncomp =</span> <span class="dv">1</span>)</span>
<span id="cb35-3"><a href="reg-comp.html#cb35-3"></a><span class="co">## , , 1 comps</span></span>
<span id="cb35-4"><a href="reg-comp.html#cb35-4"></a><span class="co">## </span></span>
<span id="cb35-5"><a href="reg-comp.html#cb35-5"></a><span class="co">##                 Salary</span></span>
<span id="cb35-6"><a href="reg-comp.html#cb35-6"></a><span class="co">## AtBat       25.0420570</span></span>
<span id="cb35-7"><a href="reg-comp.html#cb35-7"></a><span class="co">## Hits        27.8270677</span></span>
<span id="cb35-8"><a href="reg-comp.html#cb35-8"></a><span class="co">## HmRun       21.7597795</span></span>
<span id="cb35-9"><a href="reg-comp.html#cb35-9"></a><span class="co">## Runs        26.6334747</span></span>
<span id="cb35-10"><a href="reg-comp.html#cb35-10"></a><span class="co">## RBI         28.5110396</span></span>
<span id="cb35-11"><a href="reg-comp.html#cb35-11"></a><span class="co">## Walks       28.1564522</span></span>
<span id="cb35-12"><a href="reg-comp.html#cb35-12"></a><span class="co">## Years       25.4154350</span></span>
<span id="cb35-13"><a href="reg-comp.html#cb35-13"></a><span class="co">## CAtBat      33.3750764</span></span>
<span id="cb35-14"><a href="reg-comp.html#cb35-14"></a><span class="co">## CHits       34.8197471</span></span>
<span id="cb35-15"><a href="reg-comp.html#cb35-15"></a><span class="co">## CHmRun      33.2986538</span></span>
<span id="cb35-16"><a href="reg-comp.html#cb35-16"></a><span class="co">## CRuns       35.6931216</span></span>
<span id="cb35-17"><a href="reg-comp.html#cb35-17"></a><span class="co">## CRBI        35.9651267</span></span>
<span id="cb35-18"><a href="reg-comp.html#cb35-18"></a><span class="co">## CWalks      31.0715657</span></span>
<span id="cb35-19"><a href="reg-comp.html#cb35-19"></a><span class="co">## LeagueN     -0.9059591</span></span>
<span id="cb35-20"><a href="reg-comp.html#cb35-20"></a><span class="co">## DivisionW  -12.2120349</span></span>
<span id="cb35-21"><a href="reg-comp.html#cb35-21"></a><span class="co">## PutOuts     19.0607903</span></span>
<span id="cb35-22"><a href="reg-comp.html#cb35-22"></a><span class="co">## Assists      1.6135259</span></span>
<span id="cb35-23"><a href="reg-comp.html#cb35-23"></a><span class="co">## Errors      -0.3425902</span></span>
<span id="cb35-24"><a href="reg-comp.html#cb35-24"></a><span class="co">## NewLeagueN  -0.1798022</span></span></code></pre></div></li>
</ol>
</div>
<div id="comparaison-pcr-vs-pls." class="section level2">
<h2><span class="header-section-number">2.3</span> Comparaison : PCR vs PLS.</h2>
<ol style="list-style-type: decimal">
<li><p>Séparer le jeu de données en un échantillon d’apprentissage de taille 200 et un échantillon test de taille 63.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="reg-comp.html#cb36-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb36-2"><a href="reg-comp.html#cb36-2"></a><span class="op">&gt;</span><span class="st"> </span>perm &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">nrow</span>(Hitters))</span>
<span id="cb36-3"><a href="reg-comp.html#cb36-3"></a><span class="op">&gt;</span><span class="st"> </span>dapp &lt;-<span class="st"> </span>Hitters[perm[<span class="dv">1</span><span class="op">:</span><span class="dv">200</span>],]</span>
<span id="cb36-4"><a href="reg-comp.html#cb36-4"></a><span class="op">&gt;</span><span class="st"> </span>dtest &lt;-<span class="st"> </span>Hitters[perm[<span class="dv">201</span><span class="op">:</span><span class="kw">nrow</span>(Hitters)],]</span></code></pre></div></li>
<li><p>Avec les données d’apprentissage uniquement construire les régressions PCR et PLS. On choisira les nombres de composantes par validation croisée.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="reg-comp.html#cb37-1"></a><span class="op">&gt;</span><span class="st"> </span>choix.pcr &lt;-<span class="st"> </span><span class="kw">pcr</span>(Salary<span class="op">~</span>.,<span class="dt">data=</span>dapp,<span class="dt">validation=</span><span class="st">&quot;CV&quot;</span>)</span>
<span id="cb37-2"><a href="reg-comp.html#cb37-2"></a><span class="op">&gt;</span><span class="st"> </span>ncomp.pcr &lt;-<span class="st"> </span><span class="kw">which.min</span>(choix.pcr<span class="op">$</span>validation<span class="op">$</span>PRESS)</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="reg-comp.html#cb38-1"></a><span class="op">&gt;</span><span class="st"> </span>choix.pls &lt;-<span class="st"> </span><span class="kw">plsr</span>(Salary<span class="op">~</span>.,<span class="dt">data=</span>dapp,<span class="dt">validation=</span><span class="st">&quot;CV&quot;</span>)</span>
<span id="cb38-2"><a href="reg-comp.html#cb38-2"></a><span class="op">&gt;</span><span class="st"> </span>ncomp.pls &lt;-<span class="st"> </span><span class="kw">which.min</span>(choix.pls<span class="op">$</span>validation<span class="op">$</span>PRESS)</span></code></pre></div></li>
<li><p>Comparer les deux méthodes en utilisant l’échantillon de validation. On pourra également utiliser un modèle linéaire classique.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="reg-comp.html#cb39-1"></a><span class="op">&gt;</span><span class="st"> </span>mod.lin &lt;-<span class="st"> </span><span class="kw">lm</span>(Salary<span class="op">~</span>.,<span class="dt">data=</span>dapp)</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="reg-comp.html#cb40-1"></a><span class="op">&gt;</span><span class="st"> </span>prev &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb40-2"><a href="reg-comp.html#cb40-2"></a><span class="op">+</span><span class="st">   </span><span class="dt">lin=</span><span class="kw">predict</span>(mod.lin,<span class="dt">newdata=</span>dtest),</span>
<span id="cb40-3"><a href="reg-comp.html#cb40-3"></a><span class="op">+</span><span class="st">   </span><span class="dt">pcr=</span><span class="kw">as.vector</span>(<span class="kw">predict</span>(choix.pcr,<span class="dt">newdata =</span> dtest,<span class="dt">ncomp=</span>ncomp.pcr)),</span>
<span id="cb40-4"><a href="reg-comp.html#cb40-4"></a><span class="op">+</span><span class="st">   </span><span class="dt">pls=</span><span class="kw">as.vector</span>(<span class="kw">predict</span>(choix.pls,<span class="dt">newdata =</span> dtest,<span class="dt">ncomp=</span>ncomp.pls)),</span>
<span id="cb40-5"><a href="reg-comp.html#cb40-5"></a><span class="op">+</span><span class="st">   </span><span class="dt">obs=</span>dtest<span class="op">$</span>Salary</span>
<span id="cb40-6"><a href="reg-comp.html#cb40-6"></a><span class="op">+</span><span class="st"> </span>)</span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="reg-comp.html#cb41-1"></a><span class="op">&gt;</span><span class="st"> </span>prev <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize_at</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="op">~</span>(<span class="kw">mean</span>((.<span class="op">-</span>obs)<span class="op">^</span><span class="dv">2</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sqrt</span>()</span>
<span id="cb41-2"><a href="reg-comp.html#cb41-2"></a><span class="co">##        lin      pcr      pls</span></span>
<span id="cb41-3"><a href="reg-comp.html#cb41-3"></a><span class="co">## 1 334.8819 348.3943 342.7771</span></span></code></pre></div></li>
<li><p>Comparer ces méthodes en faisant une validation croisée 10 blocs.</p>
<div class="corR">
<p>
On définit d’abord les 10 blocs pour la validation croisée.
</p>
</div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="reg-comp.html#cb42-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb42-2"><a href="reg-comp.html#cb42-2"></a><span class="op">&gt;</span><span class="st"> </span>bloc &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="kw">nrow</span>(Hitters),<span class="dt">replace=</span><span class="ot">TRUE</span>)</span>
<span id="cb42-3"><a href="reg-comp.html#cb42-3"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">table</span>(bloc)</span>
<span id="cb42-4"><a href="reg-comp.html#cb42-4"></a><span class="co">## bloc</span></span>
<span id="cb42-5"><a href="reg-comp.html#cb42-5"></a><span class="co">##  1  2  3  4  5  6  7  8  9 10 </span></span>
<span id="cb42-6"><a href="reg-comp.html#cb42-6"></a><span class="co">## 19 22 31 29 28 39 19 26 25 25</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="reg-comp.html#cb43-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">set.seed</span>(<span class="dv">4321</span>)</span>
<span id="cb43-2"><a href="reg-comp.html#cb43-2"></a><span class="op">&gt;</span><span class="st"> </span>prev &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="kw">nrow</span>(Hitters),<span class="dt">ncol=</span><span class="dv">3</span>))</span>
<span id="cb43-3"><a href="reg-comp.html#cb43-3"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">names</span>(prev) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;lin&quot;</span>,<span class="st">&quot;PCR&quot;</span>,<span class="st">&quot;PLS&quot;</span>)</span>
<span id="cb43-4"><a href="reg-comp.html#cb43-4"></a><span class="op">&gt;</span><span class="st"> </span><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</span>
<span id="cb43-5"><a href="reg-comp.html#cb43-5"></a><span class="op">+</span><span class="st"> </span><span class="co">#  print(k)</span></span>
<span id="cb43-6"><a href="reg-comp.html#cb43-6"></a><span class="op">+</span><span class="st">   </span>ind.test &lt;-<span class="st"> </span>bloc<span class="op">==</span>k</span>
<span id="cb43-7"><a href="reg-comp.html#cb43-7"></a><span class="op">+</span><span class="st">   </span>dapp &lt;-<span class="st"> </span>Hitters[<span class="op">!</span>ind.test,]</span>
<span id="cb43-8"><a href="reg-comp.html#cb43-8"></a><span class="op">+</span><span class="st">   </span>dtest &lt;-<span class="st"> </span>Hitters[ind.test,]</span>
<span id="cb43-9"><a href="reg-comp.html#cb43-9"></a><span class="op">+</span><span class="st">   </span>choix.pcr &lt;-<span class="st"> </span><span class="kw">pcr</span>(Salary<span class="op">~</span>.,<span class="dt">data=</span>dapp,<span class="dt">validation=</span><span class="st">&quot;CV&quot;</span>)</span>
<span id="cb43-10"><a href="reg-comp.html#cb43-10"></a><span class="op">+</span><span class="st">   </span>ncomp.pcr &lt;-<span class="st"> </span><span class="kw">which.min</span>(choix.pcr<span class="op">$</span>validation<span class="op">$</span>PRESS)</span>
<span id="cb43-11"><a href="reg-comp.html#cb43-11"></a><span class="op">+</span><span class="st">   </span>choix.pls &lt;-<span class="st"> </span><span class="kw">plsr</span>(Salary<span class="op">~</span>.,<span class="dt">data=</span>dapp,<span class="dt">validation=</span><span class="st">&quot;CV&quot;</span>)</span>
<span id="cb43-12"><a href="reg-comp.html#cb43-12"></a><span class="op">+</span><span class="st">   </span>ncomp.pls &lt;-<span class="st"> </span><span class="kw">which.min</span>(choix.pls<span class="op">$</span>validation<span class="op">$</span>PRESS)</span>
<span id="cb43-13"><a href="reg-comp.html#cb43-13"></a><span class="op">+</span><span class="st">   </span>mod.lin &lt;-<span class="st"> </span><span class="kw">lm</span>(Salary<span class="op">~</span>.,<span class="dt">data=</span>dapp)</span>
<span id="cb43-14"><a href="reg-comp.html#cb43-14"></a><span class="op">+</span><span class="st">   </span>prev[ind.test,] &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb43-15"><a href="reg-comp.html#cb43-15"></a><span class="op">+</span><span class="st"> </span><span class="dt">lin=</span><span class="kw">predict</span>(mod.lin,<span class="dt">newdata=</span>dtest),</span>
<span id="cb43-16"><a href="reg-comp.html#cb43-16"></a><span class="op">+</span><span class="st"> </span><span class="dt">PCR=</span><span class="kw">as.vector</span>(<span class="kw">predict</span>(choix.pcr,<span class="dt">newdata =</span> dtest,<span class="dt">ncomp=</span>ncomp.pcr)),</span>
<span id="cb43-17"><a href="reg-comp.html#cb43-17"></a><span class="op">+</span><span class="st"> </span><span class="dt">PLS=</span><span class="kw">as.vector</span>(<span class="kw">predict</span>(choix.pls,<span class="dt">newdata =</span> dtest,<span class="dt">ncomp=</span>ncomp.pls)))</span>
<span id="cb43-18"><a href="reg-comp.html#cb43-18"></a><span class="op">+</span><span class="st"> </span>}</span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="reg-comp.html#cb44-1"></a><span class="op">&gt;</span><span class="st"> </span>prev <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">obs=</span>Hitters<span class="op">$</span>Salary) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize_at</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="op">~</span>(<span class="kw">mean</span>((.<span class="op">-</span>obs)<span class="op">^</span><span class="dv">2</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sqrt</span>()</span>
<span id="cb44-2"><a href="reg-comp.html#cb44-2"></a><span class="co">##        lin      PCR      PLS</span></span>
<span id="cb44-3"><a href="reg-comp.html#cb44-3"></a><span class="co">## 1 340.0631 343.8019 350.6712</span></span></code></pre></div>
<div class="corR">
<p>
On compare à un modèle qui prédit toujours la moyenne :
</p>
</div>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="reg-comp.html#cb45-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">var</span>(Hitters<span class="op">$</span>Salary) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sqrt</span>()</span>
<span id="cb45-2"><a href="reg-comp.html#cb45-2"></a><span class="co">## [1] 451.1187</span></span></code></pre></div>
<div class="corR">
<p>
On peut retenter l’analyse en considérant toutes les interactions d’ordre 2 :
</p>
</div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="reg-comp.html#cb46-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">set.seed</span>(<span class="dv">54321</span>)</span>
<span id="cb46-2"><a href="reg-comp.html#cb46-2"></a><span class="op">&gt;</span><span class="st"> </span>prev1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="kw">nrow</span>(Hitters),<span class="dt">ncol=</span><span class="dv">3</span>))</span>
<span id="cb46-3"><a href="reg-comp.html#cb46-3"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">names</span>(prev1) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;lin&quot;</span>,<span class="st">&quot;PCR&quot;</span>,<span class="st">&quot;PLS&quot;</span>)</span>
<span id="cb46-4"><a href="reg-comp.html#cb46-4"></a><span class="op">&gt;</span><span class="st"> </span><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</span>
<span id="cb46-5"><a href="reg-comp.html#cb46-5"></a><span class="op">+</span><span class="st"> </span><span class="co">#  print(k)</span></span>
<span id="cb46-6"><a href="reg-comp.html#cb46-6"></a><span class="op">+</span><span class="st">   </span>ind.test &lt;-<span class="st"> </span>bloc<span class="op">==</span>k</span>
<span id="cb46-7"><a href="reg-comp.html#cb46-7"></a><span class="op">+</span><span class="st">   </span>dapp &lt;-<span class="st"> </span>Hitters[<span class="op">!</span>ind.test,]</span>
<span id="cb46-8"><a href="reg-comp.html#cb46-8"></a><span class="op">+</span><span class="st">   </span>dtest &lt;-<span class="st"> </span>Hitters[ind.test,]</span>
<span id="cb46-9"><a href="reg-comp.html#cb46-9"></a><span class="op">+</span><span class="st">   </span>choix.pcr &lt;-<span class="st"> </span><span class="kw">pcr</span>(Salary<span class="op">~</span>.<span class="op">^</span><span class="dv">2</span>,<span class="dt">data=</span>dapp,<span class="dt">validation=</span><span class="st">&quot;CV&quot;</span>)</span>
<span id="cb46-10"><a href="reg-comp.html#cb46-10"></a><span class="op">+</span><span class="st">   </span>ncomp.pcr &lt;-<span class="st"> </span><span class="kw">which.min</span>(choix.pcr<span class="op">$</span>validation<span class="op">$</span>PRESS)</span>
<span id="cb46-11"><a href="reg-comp.html#cb46-11"></a><span class="op">+</span><span class="st">   </span>choix.pls &lt;-<span class="st"> </span><span class="kw">plsr</span>(Salary<span class="op">~</span>.<span class="op">^</span><span class="dv">2</span>,<span class="dt">data=</span>dapp,<span class="dt">validation=</span><span class="st">&quot;CV&quot;</span>)</span>
<span id="cb46-12"><a href="reg-comp.html#cb46-12"></a><span class="op">+</span><span class="st">   </span>ncomp.pls &lt;-<span class="st"> </span><span class="kw">which.min</span>(choix.pls<span class="op">$</span>validation<span class="op">$</span>PRESS)</span>
<span id="cb46-13"><a href="reg-comp.html#cb46-13"></a><span class="op">+</span><span class="st">   </span>mod.lin &lt;-<span class="st"> </span><span class="kw">lm</span>(Salary<span class="op">~</span>.<span class="op">^</span><span class="dv">2</span>,<span class="dt">data=</span>dapp)</span>
<span id="cb46-14"><a href="reg-comp.html#cb46-14"></a><span class="op">+</span><span class="st">   </span>prev1[ind.test,] &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb46-15"><a href="reg-comp.html#cb46-15"></a><span class="op">+</span><span class="st"> </span><span class="dt">lin=</span><span class="kw">predict</span>(mod.lin,<span class="dt">newdata=</span>dtest),</span>
<span id="cb46-16"><a href="reg-comp.html#cb46-16"></a><span class="op">+</span><span class="st"> </span><span class="dt">PCR=</span><span class="kw">as.vector</span>(<span class="kw">predict</span>(choix.pcr,<span class="dt">newdata =</span> dtest,<span class="dt">ncomp=</span>ncomp.pcr)),</span>
<span id="cb46-17"><a href="reg-comp.html#cb46-17"></a><span class="op">+</span><span class="st"> </span><span class="dt">PLS=</span><span class="kw">as.vector</span>(<span class="kw">predict</span>(choix.pls,<span class="dt">newdata =</span> dtest,<span class="dt">ncomp=</span>ncomp.pls)))</span>
<span id="cb46-18"><a href="reg-comp.html#cb46-18"></a><span class="op">+</span><span class="st"> </span>}</span></code></pre></div>
<div class="corR">
<p>
On obtient les performances suivantes :
</p>
</div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="reg-comp.html#cb47-1"></a><span class="op">&gt;</span><span class="st"> </span>prev1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">obs=</span>Hitters<span class="op">$</span>Salary) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize_at</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="op">~</span>(<span class="kw">mean</span>((.<span class="op">-</span>obs)<span class="op">^</span><span class="dv">2</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sqrt</span>()</span>
<span id="cb47-2"><a href="reg-comp.html#cb47-2"></a><span class="co">##        lin      PCR      PLS</span></span>
<span id="cb47-3"><a href="reg-comp.html#cb47-3"></a><span class="co">## 1 1494.847 330.0474 349.1116</span></span></code></pre></div>
<div class="corR">
<p>
On mesure bien l’intérêt de réduire la dimension dans ce nouveau contexte.
</p>
</div></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro-grande-dim.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reg-pen.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["TUTO_GRANDE_DIM.pdf", "TUTO_GRANDE_DIM.epub"],
"toc": {
"collapse": "subsection",
"fontsettings": {
"theme": "white",
"size": 2,
"family": "sans"
},
"sharing": {
"facebook": true,
"github": true,
"twitter": true
}
},
"highlight": "default"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
