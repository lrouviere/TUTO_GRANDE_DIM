<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 4 Modèle additif | Régression en grande dimension</title>
  <meta name="description" content="Chapitre 4 Modèle additif | Régression en grande dimension" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 4 Modèle additif | Régression en grande dimension" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 4 Modèle additif | Régression en grande dimension" />
  
  
  

<meta name="author" content="Laurent Rouvière" />


<meta name="date" content="2020-12-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="reg-pen.html"/>
<link rel="next" href="références.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Régression en grande dimension<br> <br> L. Rouvière</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Présentation</a></li>
<li class="chapter" data-level="1" data-path="intro-grande-dim.html"><a href="intro-grande-dim.html"><i class="fa fa-check"></i><b>1</b> Introduction à la grande dimension</a><ul>
<li class="chapter" data-level="1.1" data-path="intro-grande-dim.html"><a href="intro-grande-dim.html#fléau-de-la-dimension-pour-les-plus-proches-voisins"><i class="fa fa-check"></i><b>1.1</b> Fléau de la dimension pour les plus proches voisins</a></li>
<li class="chapter" data-level="1.2" data-path="intro-grande-dim.html"><a href="intro-grande-dim.html#influence-de-la-dimension-dans-le-modèle-linéaire"><i class="fa fa-check"></i><b>1.2</b> Influence de la dimension dans le modèle linéaire</a></li>
<li class="chapter" data-level="1.3" data-path="intro-grande-dim.html"><a href="intro-grande-dim.html#exercices"><i class="fa fa-check"></i><b>1.3</b> Exercices</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reg-comp.html"><a href="reg-comp.html"><i class="fa fa-check"></i><b>2</b> Régression sur composantes</a><ul>
<li class="chapter" data-level="2.1" data-path="reg-comp.html"><a href="reg-comp.html#sélection-de-variables"><i class="fa fa-check"></i><b>2.1</b> Sélection de variables</a></li>
<li class="chapter" data-level="2.2" data-path="reg-comp.html"><a href="reg-comp.html#régression-sur-composantes-principales-méthodo"><i class="fa fa-check"></i><b>2.2</b> Régression sur composantes principales (méthodo)</a></li>
<li class="chapter" data-level="2.3" data-path="reg-comp.html"><a href="reg-comp.html#régression-pls-méthodo"><i class="fa fa-check"></i><b>2.3</b> Régression PLS : méthodo</a></li>
<li class="chapter" data-level="2.4" data-path="reg-comp.html"><a href="reg-comp.html#comparaison-pcr-vs-pls."><i class="fa fa-check"></i><b>2.4</b> Comparaison : PCR vs PLS.</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="reg-pen.html"><a href="reg-pen.html"><i class="fa fa-check"></i><b>3</b> Régressions pénalisées (ou sous contraintes)</a><ul>
<li class="chapter" data-level="3.1" data-path="reg-pen.html"><a href="reg-pen.html#ridge-et-lasso-avec-glmnet"><i class="fa fa-check"></i><b>3.1</b> Ridge et lasso avec glmnet</a></li>
<li class="chapter" data-level="3.2" data-path="reg-pen.html"><a href="reg-pen.html#reconstruction-dun-signal"><i class="fa fa-check"></i><b>3.2</b> Reconstruction d’un signal</a></li>
<li class="chapter" data-level="3.3" data-path="reg-pen.html"><a href="reg-pen.html#régression-logistique-pénalisée"><i class="fa fa-check"></i><b>3.3</b> Régression logistique pénalisée</a></li>
<li class="chapter" data-level="3.4" data-path="reg-pen.html"><a href="reg-pen.html#exo-ridgelasso"><i class="fa fa-check"></i><b>3.4</b> Exercices</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mod-add.html"><a href="mod-add.html"><i class="fa fa-check"></i><b>4</b> Modèle additif</a><ul>
<li class="chapter" data-level="4.1" data-path="mod-add.html"><a href="mod-add.html#pseudo-backfitting"><i class="fa fa-check"></i><b>4.1</b> Pseudo backfitting</a></li>
<li class="chapter" data-level="4.2" data-path="mod-add.html"><a href="mod-add.html#modèle-gam"><i class="fa fa-check"></i><b>4.2</b> Modèle GAM</a></li>
<li class="chapter" data-level="4.3" data-path="mod-add.html"><a href="mod-add.html#régression-logistique-additive"><i class="fa fa-check"></i><b>4.3</b> Régression logistique additive</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="références.html"><a href="références.html"><i class="fa fa-check"></i>Références</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Régression en grande dimension</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mod-add" class="section level1">
<h1><span class="header-section-number">Chapitre 4</span> Modèle additif</h1>
<p>Le modèle additif (modèle GAM) peut être vu comme un compromis entre une modélisation linéaire et non paramétrique de la fonction de régression. Il suppose que cette fonction s’écrit
<span class="math display">\[m(x)=m(x_1,\dots,x_d)=\alpha+g_1(x_1)+\dots+g_d(x_d).\]</span></p>
<div id="pseudo-backfitting" class="section level2">
<h2><span class="header-section-number">4.1</span> Pseudo backfitting</h2>
<p>L’algorithme du backfitting est souvent utilisé pour estimer les composantes du modèle additif. Etant donné un échantillon <span class="math inline">\((x_i,y_i),i=1,\dots,n\)</span> on note <span class="math inline">\(\bar{\mathbb Y}\)</span> le vecteur des <span class="math inline">\(y_i\)</span> et <span class="math inline">\(\mathbb X_k\)</span> le vecteur contenant les observations de la variable <span class="math inline">\(k\)</span> pour <span class="math inline">\(k=1,\dots,d\)</span>. L’algorithme se résume ainsi</p>
<div class="correction">
<ol style="list-style-type: decimal">
<li>
Initialisation : <span class="math inline"><span class="math inline">\(\widehat\alpha=\bar{\mathbb Y}\)</span></span>, <span class="math inline"><span class="math inline">\(\widehat g_k(x_k)=\bar{\mathbb X}_k\)</span></span>.
</li>
<li>
Pour <span class="math inline"><span class="math inline">\(k=1,\dots,d\)</span></span> :
<ul>
<li>
<span class="math inline"><span class="math inline">\(\mathbb Y^{(k)}=\mathbb Y-\widehat\alpha-\sum_{j\neq k}\widehat g_j(\mathbb X_j)\)</span></span> (résidus partiels)
</li>
<li>
<span class="math inline"><span class="math inline">\(\widehat g_k\)</span></span> : lissage non paramétrique de <span class="math inline"><span class="math inline">\(\mathbb Y^{(k)}\)</span></span> sur <span class="math inline"><span class="math inline">\(\mathbb X_k\)</span></span>.
</li>
</ul>
</li>
<li>
Répéter l’étape précédente tant que les <span class="math inline"><span class="math inline">\(\widehat g_k\)</span></span> changent.
</li>
</ol>
</div>
<p>On propose dans cette partie d’utiliser cet algorithme pour estimer les paramètres du modèle linéaire en remplaçant le lissage non paramétrique par un estimateur MCO. On considère le modèle de régression linéaire</p>
<p><span class="math display">\[Y=\beta_0+\beta_1X_1+\beta_2X_2+\varepsilon\]</span>
avec <span class="math inline">\(X_1\)</span> et <span class="math inline">\(X_2\)</span> de lois uniformes sur <span class="math inline">\([0,1]\)</span> et <span class="math inline">\(\varepsilon\)</span> de loi <span class="math inline">\(\mathcal N(0,1)\)</span> (<span class="math inline">\(\varepsilon\)</span> est indépendante de <span class="math inline">\((X_1,X_2)^\prime\)</span>).</p>
<ol style="list-style-type: decimal">
<li><p>Générer un échantillon <span class="math inline">\((x_i,y_i)\)</span> de taille <span class="math inline">\(n=300\)</span> selon le modèle ci-dessus pour <span class="math inline">\(\beta_0=1,\beta_1=3,\beta_2=5\)</span>.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="mod-add.html#cb98-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb98-2"><a href="mod-add.html#cb98-2"></a>n &lt;-<span class="st"> </span><span class="dv">300</span></span>
<span id="cb98-3"><a href="mod-add.html#cb98-3"></a>X1&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb98-4"><a href="mod-add.html#cb98-4"></a>X2&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb98-5"><a href="mod-add.html#cb98-5"></a>bruit&lt;-<span class="kw">rnorm</span>(n)</span>
<span id="cb98-6"><a href="mod-add.html#cb98-6"></a>Y&lt;-<span class="dv">1</span><span class="op">+</span><span class="dv">3</span><span class="op">*</span>X1<span class="op">+</span><span class="dv">5</span><span class="op">*</span>X2<span class="op">+</span>bruit</span>
<span id="cb98-7"><a href="mod-add.html#cb98-7"></a>donnees&lt;-<span class="kw">data.frame</span>(Y,X1,X2)</span></code></pre></div></li>
<li><p>Créer une fonction <strong>R</strong> qui admet en entrée un jeu de données et qui fournit en sortie les estimateurs par la méthode du backfitting.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="mod-add.html#cb99-1"></a>pseudo_back &lt;-<span class="st"> </span><span class="cf">function</span>(df,<span class="dt">eps=</span><span class="fl">0.00001</span>){</span>
<span id="cb99-2"><a href="mod-add.html#cb99-2"></a>  mat.X &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(Y<span class="op">~</span>.,<span class="dt">data=</span>df)</span>
<span id="cb99-3"><a href="mod-add.html#cb99-3"></a>  beta_i &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="kw">ncol</span>(mat.X))</span>
<span id="cb99-4"><a href="mod-add.html#cb99-4"></a>  beta &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>,<span class="kw">ncol</span>(mat.X))</span>
<span id="cb99-5"><a href="mod-add.html#cb99-5"></a>  <span class="cf">while</span> (<span class="kw">min</span>(<span class="kw">abs</span>(beta_i<span class="op">-</span>beta))<span class="op">&gt;</span>eps){</span>
<span id="cb99-6"><a href="mod-add.html#cb99-6"></a>beta_i &lt;-<span class="st"> </span>beta</span>
<span id="cb99-7"><a href="mod-add.html#cb99-7"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(mat.X)){</span>
<span id="cb99-8"><a href="mod-add.html#cb99-8"></a>  Yk &lt;-<span class="st"> </span>Y<span class="op">-</span>mat.X[,<span class="op">-</span>k]<span class="op">%*%</span>(beta[<span class="op">-</span>k])</span>
<span id="cb99-9"><a href="mod-add.html#cb99-9"></a>  dfk &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Yk=</span>Yk,<span class="dt">Xk=</span>mat.X[,k])</span>
<span id="cb99-10"><a href="mod-add.html#cb99-10"></a>  beta[k]&lt;-<span class="kw">coef</span>(<span class="kw">lm</span>(Yk<span class="op">~</span>Xk<span class="dv">-1</span>,<span class="dt">data=</span>dfk))</span>
<span id="cb99-11"><a href="mod-add.html#cb99-11"></a>}</span>
<span id="cb99-12"><a href="mod-add.html#cb99-12"></a>  }</span>
<span id="cb99-13"><a href="mod-add.html#cb99-13"></a>  <span class="kw">return</span>(beta)</span>
<span id="cb99-14"><a href="mod-add.html#cb99-14"></a>}</span></code></pre></div></li>
<li><p>En déduire les estimateurs backfitting pour le problème considéré.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="mod-add.html#cb100-1"></a><span class="kw">pseudo_back</span>(donnees)</span>
<span id="cb100-2"><a href="mod-add.html#cb100-2"></a>[<span class="dv">1</span>] <span class="fl">1.021341</span> <span class="fl">2.864543</span> <span class="fl">4.980367</span></span></code></pre></div></li>
<li><p>Comparer aux estimateurs <strong>MCO</strong>.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="mod-add.html#cb101-1"></a><span class="kw">lm</span>(Y<span class="op">~</span>.,<span class="dt">data=</span>donnees)</span>
<span id="cb101-2"><a href="mod-add.html#cb101-2"></a></span>
<span id="cb101-3"><a href="mod-add.html#cb101-3"></a>Call<span class="op">:</span></span>
<span id="cb101-4"><a href="mod-add.html#cb101-4"></a><span class="kw">lm</span>(<span class="dt">formula =</span> Y <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> donnees)</span>
<span id="cb101-5"><a href="mod-add.html#cb101-5"></a></span>
<span id="cb101-6"><a href="mod-add.html#cb101-6"></a>Coefficients<span class="op">:</span></span>
<span id="cb101-7"><a href="mod-add.html#cb101-7"></a>(Intercept)           X1           X2  </span>
<span id="cb101-8"><a href="mod-add.html#cb101-8"></a>      <span class="fl">1.021</span>        <span class="fl">2.865</span>        <span class="fl">4.981</span>  </span></code></pre></div>
<div class="corR">
<p>
On obtient les mêmes estimateurs.
</p>
</div></li>
</ol>
</div>
<div id="modèle-gam" class="section level2">
<h2><span class="header-section-number">4.2</span> Modèle GAM</h2>
<p>On considère les données générées selon</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="mod-add.html#cb102-1"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb102-2"><a href="mod-add.html#cb102-2"></a><span class="kw">set.seed</span>(<span class="dv">1465</span>)</span>
<span id="cb102-3"><a href="mod-add.html#cb102-3"></a>X1 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">runif</span>(n)</span>
<span id="cb102-4"><a href="mod-add.html#cb102-4"></a>X2 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">runif</span>(n)</span>
<span id="cb102-5"><a href="mod-add.html#cb102-5"></a>bruit &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)</span>
<span id="cb102-6"><a href="mod-add.html#cb102-6"></a>Y &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>X1<span class="op">+</span><span class="kw">sin</span>(<span class="dv">8</span><span class="op">*</span>pi<span class="op">*</span>X2)<span class="op">+</span>bruit</span>
<span id="cb102-7"><a href="mod-add.html#cb102-7"></a>donnees&lt;-<span class="kw">data.frame</span>(Y,X1,X2)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p>Écrire le modèle</p>
<div class="corR">
<p>
Il s’agit d’un modèle additif
</p>
<p>
<span class="math display"><span class="math display">\[Y=2X_1+\sin(8\pi X_2)+\varepsilon\]</span></span> où <span class="math inline"><span class="math inline">\(X_1\)</span></span> et <span class="math inline"><span class="math inline">\(X_2\)</span></span> sont uniformes sur <span class="math inline"><span class="math inline">\([0,1]\)</span></span> et <span class="math inline"><span class="math inline">\(\varepsilon\)</span></span> suit une <span class="math inline"><span class="math inline">\(\mathcal N(0,1)\)</span></span>.
</p>
</div></li>
<li><p>A l’aide du package <strong>gam</strong> visualiser les estimateurs des composantes additives du modèle. On utilisera tout d’abord un lissage par <strong>spline</strong> avec 1 ddl pour la première composante et 24.579 ddl pour la seconde.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="mod-add.html#cb103-1"></a><span class="kw">library</span>(gam)</span>
<span id="cb103-2"><a href="mod-add.html#cb103-2"></a>model1 &lt;-<span class="st"> </span><span class="kw">gam</span>(Y<span class="op">~</span><span class="kw">s</span>(X1,<span class="dt">df=</span><span class="dv">1</span>)<span class="op">+</span><span class="kw">s</span>(X2,<span class="dt">df=</span><span class="fl">24.579</span>)<span class="op">-</span><span class="dv">1</span>,<span class="dt">data=</span>donnees)</span>
<span id="cb103-3"><a href="mod-add.html#cb103-3"></a><span class="kw">plot</span>(model1)</span></code></pre></div>
<p><img src="TUTO_GRANDE_DIM_files/figure-html/unnamed-chunk-181-1.png" width="672" style="display: block; margin: auto;" /><img src="TUTO_GRANDE_DIM_files/figure-html/unnamed-chunk-181-2.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Faire varier les degrés de liberté, interpréter.</p>
<div class="corR">
<p>
On prend d’abord peu de degrés de liberté.
</p>
</div>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="mod-add.html#cb104-1"></a>model2 &lt;-<span class="st"> </span><span class="kw">gam</span>(Y<span class="op">~</span><span class="kw">s</span>(X1,<span class="dt">df=</span><span class="fl">0.001</span>)<span class="op">+</span><span class="kw">s</span>(X2,<span class="dt">df=</span><span class="fl">0.001</span>)<span class="op">-</span><span class="dv">1</span>,<span class="dt">data=</span>donnees)</span>
<span id="cb104-2"><a href="mod-add.html#cb104-2"></a><span class="kw">plot</span>(model2)</span></code></pre></div>
<p><img src="TUTO_GRANDE_DIM_files/figure-html/unnamed-chunk-183-1.png" width="672" style="display: block; margin: auto;" /><img src="TUTO_GRANDE_DIM_files/figure-html/unnamed-chunk-183-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="corR">
<p>
Le sinus n’est pas bien estimé. On prend maintenant un grand nombre de degrés de liberté.
</p>
</div>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="mod-add.html#cb105-1"></a>model2 &lt;-<span class="st"> </span><span class="kw">gam</span>(Y<span class="op">~</span><span class="kw">s</span>(X1,<span class="dt">df=</span><span class="dv">100</span>)<span class="op">+</span><span class="kw">s</span>(X2,<span class="dt">df=</span><span class="dv">100</span>)<span class="op">-</span><span class="dv">1</span>,<span class="dt">data=</span>donnees)</span>
<span id="cb105-2"><a href="mod-add.html#cb105-2"></a><span class="kw">plot</span>(model2)</span></code></pre></div>
<p><img src="TUTO_GRANDE_DIM_files/figure-html/unnamed-chunk-185-1.png" width="672" style="display: block; margin: auto;" /><img src="TUTO_GRANDE_DIM_files/figure-html/unnamed-chunk-185-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="corR">
<p>
Le modèle est trop flexible, risque de sur-ajustement.
</p>
</div></li>
<li><p>Faire le même travail avec le lisseur <strong>loess</strong>. On commencera avec <code>degree=2</code> et <code>span=0.15</code> puis on fera varier le paramètre <code>span</code>.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="mod-add.html#cb106-1"></a>model4 &lt;-<span class="st"> </span><span class="kw">gam</span>(Y<span class="op">~</span><span class="kw">lo</span>(X1,<span class="dt">span=</span><span class="dv">3</span>)<span class="op">+</span><span class="kw">lo</span>(X2,<span class="dt">span=</span><span class="fl">0.15</span>,<span class="dt">degree=</span><span class="dv">2</span>)<span class="op">-</span><span class="dv">1</span>,<span class="dt">data=</span>donnees)</span>
<span id="cb106-2"><a href="mod-add.html#cb106-2"></a><span class="kw">plot</span>(model4)</span></code></pre></div>
<p><img src="TUTO_GRANDE_DIM_files/figure-html/unnamed-chunk-187-1.png" width="672" style="display: block; margin: auto;" /><img src="TUTO_GRANDE_DIM_files/figure-html/unnamed-chunk-187-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="corR">
<p>
On fait varier <code>span</code> :
</p>
</div>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="mod-add.html#cb107-1"></a>model5 &lt;-<span class="st"> </span><span class="kw">gam</span>(Y<span class="op">~</span><span class="kw">lo</span>(X1,<span class="dt">span=</span><span class="dv">5</span>)<span class="op">+</span><span class="kw">lo</span>(X2,<span class="dt">span=</span><span class="dv">5</span>,<span class="dt">degree=</span><span class="dv">2</span>)<span class="op">-</span><span class="dv">1</span>,<span class="dt">data=</span>donnees)</span>
<span id="cb107-2"><a href="mod-add.html#cb107-2"></a><span class="kw">plot</span>(model5)</span></code></pre></div>
<p><img src="TUTO_GRANDE_DIM_files/figure-html/unnamed-chunk-189-1.png" width="672" style="display: block; margin: auto;" /><img src="TUTO_GRANDE_DIM_files/figure-html/unnamed-chunk-189-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="mod-add.html#cb108-1"></a>model6 &lt;-<span class="st"> </span><span class="kw">gam</span>(Y<span class="op">~</span><span class="kw">lo</span>(X1,<span class="dt">span=</span><span class="fl">0.01</span>)<span class="op">+</span><span class="kw">lo</span>(X2,<span class="dt">span=</span><span class="fl">0.01</span>,<span class="dt">degree=</span><span class="dv">2</span>)<span class="op">-</span><span class="dv">1</span>,<span class="dt">data=</span>donnees)</span>
<span id="cb108-2"><a href="mod-add.html#cb108-2"></a><span class="kw">plot</span>(model6)</span></code></pre></div>
<p><img src="TUTO_GRANDE_DIM_files/figure-html/unnamed-chunk-190-1.png" width="672" style="display: block; margin: auto;" /><img src="TUTO_GRANDE_DIM_files/figure-html/unnamed-chunk-190-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="corR">
<p>
On a les mêmes remarques que pour les splines.
</p>
</div></li>
<li><p>Estimer le degrés de liberté avec la fonction <code>gam</code> du package <strong>mgcv</strong> (Il n’est pas nécessaire de charger le package pour éviter les conflits).</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="mod-add.html#cb109-1"></a>mod.mgcv &lt;-<span class="st"> </span>mgcv<span class="op">::</span><span class="kw">gam</span>(Y<span class="op">~</span><span class="kw">s</span>(X1)<span class="op">+</span><span class="kw">s</span>(X2),<span class="dt">data=</span>donnees)</span>
<span id="cb109-2"><a href="mod-add.html#cb109-2"></a><span class="kw">plot</span>(mod.mgcv)</span></code></pre></div>
<p><img src="TUTO_GRANDE_DIM_files/figure-html/unnamed-chunk-192-1.png" width="672" style="display: block; margin: auto;" /><img src="TUTO_GRANDE_DIM_files/figure-html/unnamed-chunk-192-2.png" width="672" style="display: block; margin: auto;" /></p></li>
</ol>
</div>
<div id="régression-logistique-additive" class="section level2">
<h2><span class="header-section-number">4.3</span> Régression logistique additive</h2>
<p>On considère le jeu de données <strong>panne.txt</strong> qui recense des pannes de machine (<code>etat=1</code>) en fonction de leur âge et de leur marque.</p>
<ol style="list-style-type: decimal">
<li><p>Faire une régression logistique permettant d’expliquer la variable <code>etat</code> par la variable <code>age</code> uniquement. Critiquer le modèle.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="mod-add.html#cb110-1"></a>panne &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;data/panne.txt&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>)</span>
<span id="cb110-2"><a href="mod-add.html#cb110-2"></a>mod1 &lt;-<span class="st"> </span><span class="kw">glm</span>(etat<span class="op">~</span>age,<span class="dt">data=</span>panne,<span class="dt">family=</span>binomial)</span>
<span id="cb110-3"><a href="mod-add.html#cb110-3"></a><span class="kw">summary</span>(mod1)</span>
<span id="cb110-4"><a href="mod-add.html#cb110-4"></a></span>
<span id="cb110-5"><a href="mod-add.html#cb110-5"></a>Call<span class="op">:</span></span>
<span id="cb110-6"><a href="mod-add.html#cb110-6"></a><span class="kw">glm</span>(<span class="dt">formula =</span> etat <span class="op">~</span><span class="st"> </span>age, <span class="dt">family =</span> binomial, <span class="dt">data =</span> panne)</span>
<span id="cb110-7"><a href="mod-add.html#cb110-7"></a></span>
<span id="cb110-8"><a href="mod-add.html#cb110-8"></a>Deviance Residuals<span class="op">:</span><span class="st"> </span></span>
<span id="cb110-9"><a href="mod-add.html#cb110-9"></a><span class="st">   </span>Min      1Q  Median      3Q     Max  </span>
<span id="cb110-10"><a href="mod-add.html#cb110-10"></a><span class="fl">-1.253</span>  <span class="fl">-1.199</span>   <span class="fl">1.015</span>   <span class="fl">1.183</span>   <span class="fl">1.210</span>  </span>
<span id="cb110-11"><a href="mod-add.html#cb110-11"></a></span>
<span id="cb110-12"><a href="mod-add.html#cb110-12"></a>Coefficients<span class="op">:</span></span>
<span id="cb110-13"><a href="mod-add.html#cb110-13"></a><span class="st">            </span>Estimate Std. Error z value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>z<span class="op">|</span>)</span>
<span id="cb110-14"><a href="mod-add.html#cb110-14"></a>(Intercept) <span class="fl">-0.10748</span>    <span class="fl">0.59864</span>  <span class="fl">-0.180</span>    <span class="fl">0.858</span></span>
<span id="cb110-15"><a href="mod-add.html#cb110-15"></a>age          <span class="fl">0.03141</span>    <span class="fl">0.09117</span>   <span class="fl">0.345</span>    <span class="fl">0.730</span></span>
<span id="cb110-16"><a href="mod-add.html#cb110-16"></a></span>
<span id="cb110-17"><a href="mod-add.html#cb110-17"></a>(Dispersion parameter <span class="cf">for</span> binomial family taken to be <span class="dv">1</span>)</span>
<span id="cb110-18"><a href="mod-add.html#cb110-18"></a></span>
<span id="cb110-19"><a href="mod-add.html#cb110-19"></a>    Null deviance<span class="op">:</span><span class="st"> </span><span class="fl">45.717</span>  on <span class="dv">32</span>  degrees of freedom</span>
<span id="cb110-20"><a href="mod-add.html#cb110-20"></a>Residual deviance<span class="op">:</span><span class="st"> </span><span class="fl">45.598</span>  on <span class="dv">31</span>  degrees of freedom</span>
<span id="cb110-21"><a href="mod-add.html#cb110-21"></a>AIC<span class="op">:</span><span class="st"> </span><span class="fl">49.598</span></span>
<span id="cb110-22"><a href="mod-add.html#cb110-22"></a></span>
<span id="cb110-23"><a href="mod-add.html#cb110-23"></a>Number of Fisher Scoring iterations<span class="op">:</span><span class="st"> </span><span class="dv">3</span></span></code></pre></div>
<div class="corR">
<p>
Le modèle n’est pas pertinent. On accepte la nullité du coefficient <code>age</code>, ce qui signifie que le modèle constant est meilleur que le modèle avec la variable <code>age</code>.
</p>
</div></li>
<li><p>Ajuster un modèle additif, toujours avec uniquement la variable <code>age</code>.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="mod-add.html#cb111-1"></a>mod.panne &lt;-<span class="st"> </span>mgcv<span class="op">::</span><span class="kw">gam</span>(etat<span class="op">~</span><span class="kw">s</span>(age),<span class="dt">data=</span>panne)</span>
<span id="cb111-2"><a href="mod-add.html#cb111-2"></a><span class="kw">plot</span>(mod.panne)</span></code></pre></div>
<p><img src="TUTO_GRANDE_DIM_files/figure-html/unnamed-chunk-195-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>En utilisant le modèle additif, proposer un nouveau modèle logistique plus pertinent.</p>
<div class="corR">
<p>
Il semble que l’âge agisse de façon quadratique. Cela peut s’expliquer par le fait que les pannes interviennent souvent au début (phase de rodage) et à la fin (vieillissement de la machine).
</p>
</div>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="mod-add.html#cb112-1"></a>mod2 &lt;-<span class="st"> </span><span class="kw">glm</span>(etat<span class="op">~</span>age<span class="op">+</span><span class="kw">I</span>(age<span class="op">^</span><span class="dv">2</span>),<span class="dt">data=</span>panne,<span class="dt">family=</span>binomial)</span>
<span id="cb112-2"><a href="mod-add.html#cb112-2"></a><span class="kw">summary</span>(mod2)</span>
<span id="cb112-3"><a href="mod-add.html#cb112-3"></a></span>
<span id="cb112-4"><a href="mod-add.html#cb112-4"></a>Call<span class="op">:</span></span>
<span id="cb112-5"><a href="mod-add.html#cb112-5"></a><span class="kw">glm</span>(<span class="dt">formula =</span> etat <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(age<span class="op">^</span><span class="dv">2</span>), <span class="dt">family =</span> binomial, <span class="dt">data =</span> panne)</span>
<span id="cb112-6"><a href="mod-add.html#cb112-6"></a></span>
<span id="cb112-7"><a href="mod-add.html#cb112-7"></a>Deviance Residuals<span class="op">:</span><span class="st"> </span></span>
<span id="cb112-8"><a href="mod-add.html#cb112-8"></a><span class="st">     </span>Min        1Q    Median        3Q       Max  </span>
<span id="cb112-9"><a href="mod-add.html#cb112-9"></a><span class="fl">-1.54043</span>  <span class="fl">-0.74739</span>   <span class="fl">0.00033</span>   <span class="fl">0.64877</span>   <span class="fl">1.88091</span>  </span>
<span id="cb112-10"><a href="mod-add.html#cb112-10"></a></span>
<span id="cb112-11"><a href="mod-add.html#cb112-11"></a>Coefficients<span class="op">:</span></span>
<span id="cb112-12"><a href="mod-add.html#cb112-12"></a><span class="st">            </span>Estimate Std. Error z value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>z<span class="op">|</span>)   </span>
<span id="cb112-13"><a href="mod-add.html#cb112-13"></a>(Intercept)  <span class="fl">4.18501</span>    <span class="fl">1.73860</span>   <span class="fl">2.407</span>  <span class="fl">0.01608</span> <span class="op">*</span><span class="st"> </span></span>
<span id="cb112-14"><a href="mod-add.html#cb112-14"></a>age         <span class="fl">-2.03343</span>    <span class="fl">0.77401</span>  <span class="fl">-2.627</span>  <span class="fl">0.00861</span> <span class="op">**</span></span>
<span id="cb112-15"><a href="mod-add.html#cb112-15"></a><span class="kw">I</span>(age<span class="op">^</span><span class="dv">2</span>)     <span class="fl">0.17601</span>    <span class="fl">0.07044</span>   <span class="fl">2.499</span>  <span class="fl">0.01247</span> <span class="op">*</span><span class="st"> </span></span>
<span id="cb112-16"><a href="mod-add.html#cb112-16"></a><span class="op">---</span></span>
<span id="cb112-17"><a href="mod-add.html#cb112-17"></a>Signif. codes<span class="op">:</span><span class="st">  </span></span>
<span id="cb112-18"><a href="mod-add.html#cb112-18"></a><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span>
<span id="cb112-19"><a href="mod-add.html#cb112-19"></a></span>
<span id="cb112-20"><a href="mod-add.html#cb112-20"></a>(Dispersion parameter <span class="cf">for</span> binomial family taken to be <span class="dv">1</span>)</span>
<span id="cb112-21"><a href="mod-add.html#cb112-21"></a></span>
<span id="cb112-22"><a href="mod-add.html#cb112-22"></a>    Null deviance<span class="op">:</span><span class="st"> </span><span class="fl">45.717</span>  on <span class="dv">32</span>  degrees of freedom</span>
<span id="cb112-23"><a href="mod-add.html#cb112-23"></a>Residual deviance<span class="op">:</span><span class="st"> </span><span class="fl">31.279</span>  on <span class="dv">30</span>  degrees of freedom</span>
<span id="cb112-24"><a href="mod-add.html#cb112-24"></a>AIC<span class="op">:</span><span class="st"> </span><span class="fl">37.279</span></span>
<span id="cb112-25"><a href="mod-add.html#cb112-25"></a></span>
<span id="cb112-26"><a href="mod-add.html#cb112-26"></a>Number of Fisher Scoring iterations<span class="op">:</span><span class="st"> </span><span class="dv">6</span></span></code></pre></div>
<div class="corR">
<p>
On remarque ici que l’âge devient “significatif” !
</p>
</div></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="reg-pen.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="références.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["TUTO_GRANDE_DIM.pdf"],
"toc": {
"collapse": "subsection",
"fontsettings": {
"theme": "white",
"size": 2,
"family": "sans"
},
"sharing": {
"facebook": true,
"github": true,
"twitter": true
}
},
"highlight": "default"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
