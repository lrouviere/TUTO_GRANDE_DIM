<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Statistique en grande dimension - 1&nbsp; Les problèmes de la grande dimension</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./02-reg-comp.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Les problèmes de la grande dimension</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistique en grande dimension</a> 
        <div class="sidebar-tools-main">
    <a href="" title="Download" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-download"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="./Statistique-en-grande-dimension.pdf">
            <i class="bi bi-bi-file-pdf pe-1"></i>
          Download PDF
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="./Statistique-en-grande-dimension.epub">
            <i class="bi bi-bi-journal pe-1"></i>
          Download ePub
          </a>
        </li>
    </ul>
    <a href="" title="Share" id="sidebar-tool-dropdown-1" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-share"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-1">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
            <i class="bi bi-bi-twitter pe-1"></i>
          Twitter
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
            <i class="bi bi-bi-facebook pe-1"></i>
          Facebook
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Présentation</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro-grande-dim.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Les problèmes de la grande dimension</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-reg-comp.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Régression sur composantes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-ridge-lasso.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Régressions pénalisées (ou sous contraintes)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-mod-add.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Modèle additif</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">Références</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table des matières</h2>
   
  <ul>
  <li><a href="#fléau-de-la-dimension-pour-les-plus-proches-voisins" id="toc-fléau-de-la-dimension-pour-les-plus-proches-voisins" class="nav-link active" data-scroll-target="#fléau-de-la-dimension-pour-les-plus-proches-voisins"> <span class="header-section-number">1.1</span> Fléau de la dimension pour les plus proches voisins</a></li>
  <li><a href="#influence-de-la-dimension-dans-le-modèle-linéaire" id="toc-influence-de-la-dimension-dans-le-modèle-linéaire" class="nav-link" data-scroll-target="#influence-de-la-dimension-dans-le-modèle-linéaire"> <span class="header-section-number">1.2</span> Influence de la dimension dans le modèle linéaire</a></li>
  <li><a href="#exercices" id="toc-exercices" class="nav-link" data-scroll-target="#exercices"> <span class="header-section-number">1.3</span> Exercices</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="intro-grande-dim" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Les problèmes de la grande dimension</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div>
<div class="cell">

</div>
<style>
div.correction {
  color: black;
  background-color: #F0F0F0;
  font-style: normal;
  /*display: none;*/
}

.corR {
  font-style: italic;
  /*display: none;*/
}
</style>
</div>
<div class="cell">

</div>
<p>Nous proposons ici d’illustrer le problème de la grande dimension en régression. On commencera par étudier, à l’aide de simulation, ce problème pour l’estimateur des <span class="math inline">\(k\)</span> plus proches voisins, puis pour les estimateurs des moindres carrés dans le modèle linéaire. Quelques exercices sont ensuite proposées pour calculer les vitesses de convergence de ces estimateurs dans des modèles simples.</p>
<section id="fléau-de-la-dimension-pour-les-plus-proches-voisins" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="fléau-de-la-dimension-pour-les-plus-proches-voisins"><span class="header-section-number">1.1</span> Fléau de la dimension pour les plus proches voisins</h2>
<p>La fonction suivante permet de générer un échantillon d’apprentissage et un échantillon test selon le modèle <span class="math display">\[Y=X_1^2+\dots+X_p^2+\varepsilon\]</span> où les <span class="math inline">\(X_j\)</span> sont uniformes i.i.d de loi uniforme sur <span class="math inline">\([0,1]\)</span> et le bruit <span class="math inline">\(\varepsilon\)</span> suit une loi <span class="math inline">\(\mathcal N(0,0.5^2)\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>simu <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">napp=</span><span class="dv">300</span>,<span class="at">ntest=</span><span class="dv">500</span>,<span class="at">p=</span><span class="dv">3</span>,<span class="at">graine=</span><span class="dv">1234</span>){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(graine)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> napp<span class="sc">+</span>ntest</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n<span class="sc">*</span>p),<span class="at">ncol=</span>p)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">apply</span>(X<span class="sc">^</span><span class="dv">2</span>,<span class="dv">1</span>,sum)<span class="sc">+</span><span class="fu">rnorm</span>(n,<span class="at">sd=</span><span class="fl">0.5</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  Yapp <span class="ot">&lt;-</span> Y[<span class="dv">1</span><span class="sc">:</span>napp]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  Ytest <span class="ot">&lt;-</span> Y[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>napp)]</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  Xapp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X[<span class="dv">1</span><span class="sc">:</span>napp,])</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  Xtest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>napp),])</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">Xapp=</span>Xapp,<span class="at">Yapp=</span>Yapp,<span class="at">Xtest=</span>Xtest,<span class="at">Ytest=</span>Ytest))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">simu</span>(<span class="at">napp=</span><span class="dv">300</span>,<span class="at">ntest=</span><span class="dv">500</span>,<span class="at">p=</span><span class="dv">3</span>,<span class="at">graine=</span><span class="dv">1234</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La fonction <strong>knn.reg</strong> du package <strong>FNN</strong> permet de construire des estimateurs des <span class="math inline">\(k\)</span> plus proches voisins en régression. On peut par exemple faire du 3 plus proches voisins avec</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FNN)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>mod3ppv <span class="ot">&lt;-</span> <span class="fu">knn.reg</span>(<span class="at">train=</span>df<span class="sc">$</span>Xapp,<span class="at">y=</span>df<span class="sc">$</span>Yapp,<span class="at">k=</span><span class="dv">3</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Parmi toutes les sorties proposées par cette fonction on a notamment</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mod3ppv<span class="sc">$</span>PRESS</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 98.98178</code></pre>
</div>
</div>
<p>qui renvoie la somme des carrés des erreurs de prévision par validation croisée Leave-One-Out (LOO). On peut ainsi obtenir l’erreur quadratique moyenne par LOO</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>mod3ppv<span class="sc">$</span>PRESS<span class="sc">/</span><span class="fu">max</span>(<span class="fu">c</span>(<span class="fu">nrow</span>(df<span class="sc">$</span>Xapp),<span class="dv">1</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3299393</code></pre>
</div>
</div>
<ol type="1">
<li><p>Construire la fonction <strong>sel.k</strong> qui admet en entrée :</p>
<ul>
<li>une grille de valeurs possibles de plus proches voisins (un vecteur).</li>
<li>une matrice <strong>Xapp</strong> de dimension <span class="math inline">\(n\times p\)</span> qui contient les valeurs variables explicatives.</li>
<li>un vecteur <strong>Yapp</strong> de dimension <span class="math inline">\(n\)</span> qui contient les valeurs de la variable à expliquer</li>
</ul>
<p>et qui renvoie en sortie la valeur de <span class="math inline">\(k\)</span> dans la grille qui minimise l’erreur LOO présentée ci-dessus.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>sel.k <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">K_cand=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">50</span>,<span class="at">by=</span><span class="dv">5</span>),Xapp,Yapp){</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  ind <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  err <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(K_cand))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> K_cand){</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    modkppv <span class="ot">&lt;-</span> <span class="fu">knn.reg</span>(<span class="at">train=</span>Xapp,<span class="at">y=</span>Yapp,<span class="at">k=</span>k)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    err[ind] <span class="ot">&lt;-</span> modkppv<span class="sc">$</span>PRESS<span class="sc">/</span><span class="fu">max</span>(<span class="fu">c</span>(<span class="fu">nrow</span>(Xapp),<span class="dv">1</span>))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    ind <span class="ot">&lt;-</span> ind<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(K_cand[<span class="fu">which.min</span>(err)])</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Une fois la fonction créée, on peut calculer l’erreur de l’estimateur sélectionné sur un échantillon test avec</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>k.opt <span class="ot">&lt;-</span> <span class="fu">sel.k</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">50</span>,<span class="at">by=</span><span class="dv">5</span>),df<span class="sc">$</span>Xapp,df<span class="sc">$</span>Yapp)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>k.opt</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 31</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>prev <span class="ot">&lt;-</span> <span class="fu">knn.reg</span>(<span class="at">train=</span>df<span class="sc">$</span>Xapp,<span class="at">y=</span>df<span class="sc">$</span>Yapp,<span class="at">test=</span>df<span class="sc">$</span>Xtest,<span class="at">k=</span>k.opt)<span class="sc">$</span>pred</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((prev<span class="sc">-</span>df<span class="sc">$</span>Ytest)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.283869</code></pre>
</div>
</div></li>
<li><p>On souhaite comparer les erreurs des règles des <span class="math inline">\(k\)</span> plus proches voisins en fonction de la dimension. On considère 4 dimensions collectées dans le vecteur <code>DIM</code> et la grille de valeurs de <span class="math inline">\(k\)</span> suivantes :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>DIM <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">50</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>K_cand <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">50</span>,<span class="at">by=</span><span class="dv">5</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pour chaque valeur de dimension répéter <span class="math inline">\(B=100\)</span> fois :</p>
<ul>
<li>simuler un échantillon d’apprentissage de taille 300 et test de taille 500</li>
<li>calculer la valeur optimale de <span class="math inline">\(k\)</span> dans <strong>K_cand</strong> grâce à <strong>sel.k</strong></li>
<li>calculer l’erreur de l’estimateur sélectionné sur un échantillon test.</li>
</ul>
<p>On pourra stocker les résultats dans une matrice de dimension <span class="math inline">\(B\times 4\)</span>.</p>
<div class="cell" data-teacher="true" data-hash="01-intro-grande-dim_cache/html/simu-err-kppv_9194a8880924c88cdd066e1c28f6665c">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>mat.err <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">ncol=</span><span class="fu">length</span>(DIM),<span class="at">nrow=</span>B)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DIM)){</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">simu</span>(<span class="at">napp=</span><span class="dv">300</span>,<span class="at">ntest=</span><span class="dv">500</span>,<span class="at">p=</span>DIM[p],<span class="at">graine=</span><span class="dv">1234</span><span class="sc">*</span>p<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>i)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    k.opt <span class="ot">&lt;-</span> <span class="fu">sel.k</span>(K_cand,df<span class="sc">$</span>Xapp,df<span class="sc">$</span>Yapp)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    prev <span class="ot">&lt;-</span> <span class="fu">knn.reg</span>(<span class="at">train=</span>df<span class="sc">$</span>Xapp,<span class="at">y=</span>df<span class="sc">$</span>Yapp,<span class="at">test=</span>df<span class="sc">$</span>Xtest,<span class="at">k=</span>k.opt)<span class="sc">$</span>pred</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    mat.err[i,p] <span class="ot">&lt;-</span> <span class="fu">mean</span>((prev<span class="sc">-</span>df<span class="sc">$</span>Ytest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>A l’aide d’indicateurs numériques et de boxplots, comparer la distribution des erreurs en fonction de la dimension.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mat.err)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>nom.dim <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"D"</span>,DIM,<span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df) <span class="ot">&lt;-</span> nom.dim</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">summarise_all</span>(mean)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        D1        D5     D10      D50
1 0.258003 0.3243574 0.52247 3.191055</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">summarise_all</span>(var)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            D1           D5         D10        D50
1 0.0002556399 0.0005417109 0.001857967 0.06749414</code></pre>
</div>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(df,<span class="at">cols=</span><span class="fu">everything</span>(),<span class="at">names_to=</span><span class="st">"dim"</span>,<span class="at">values_to=</span><span class="st">"erreur"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df1 <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">dim=</span><span class="fu">fct_relevel</span>(dim,nom.dim))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>dim,<span class="at">y=</span>erreur)<span class="sc">+</span><span class="fu">geom_boxplot</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01-intro-grande-dim_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div></li>
<li><p>Conclure</p>
<div class="corR">
<p>Les estimateurs sont moins précis lorsque la dimension augmente. C’est le <strong>fléau de la dimension</strong>.</p>
</div></li>
</ol>
</section>
<section id="influence-de-la-dimension-dans-le-modèle-linéaire" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="influence-de-la-dimension-dans-le-modèle-linéaire"><span class="header-section-number">1.2</span> Influence de la dimension dans le modèle linéaire</h2>
<p>En vous basant sur l’exercice précédent, proposer une illustration qui peut mettre en évidence la précision d’estimation dans le modèle linéaire en fonction de la dimension. On pourra par exemple considérer le modèle linaire suivant <span class="math display">\[Y=X_1+0X_2+\dots+0X_p+\varepsilon\]</span> et étudier la performance de l’estimateur MCO du coefficient de <span class="math inline">\(X_1\)</span> pour différentes valeurs de <span class="math inline">\(p\)</span>. Par exemple avec <span class="math inline">\(p\)</span> dans le vecteur</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>DIM <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Les données pourront être générées avec la fonction suivante</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">250</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n<span class="sc">*</span>p),<span class="at">ncol=</span>p)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>simu.lin <span class="ot">&lt;-</span> <span class="cf">function</span>(X,graine){</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(graine)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> X[,<span class="dv">1</span>]<span class="sc">+</span><span class="fu">rnorm</span>(<span class="fu">nrow</span>(X),<span class="at">sd=</span><span class="fl">0.5</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Y,X)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="corR">
<p>On s’intéresse à la distribution de <span class="math inline">\(\widehat\beta_1\)</span> en fonction de la dimension. Pour ce faire, on calcule un grand nombre d’estimateurs de <span class="math inline">\(\widehat\beta_1\)</span> pour différentes valeurs de <span class="math inline">\(p\)</span>.</p>
</div>
<div class="cell" data-teacher="true" data-hash="01-intro-grande-dim_cache/html/simu-err-mod-lin_50bc5afb4f9bebb5b6001b05080c9cae">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>matbeta1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>B,<span class="at">ncol=</span><span class="fu">length</span>(DIM))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  dftot <span class="ot">&lt;-</span> <span class="fu">simu.lin</span>(X,i<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DIM)){</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    dfp <span class="ot">&lt;-</span> dftot[,(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span><span class="sc">+</span>DIM[p]))]</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>.,<span class="at">data=</span>dfp)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    matbeta1[i,p] <span class="ot">&lt;-</span> <span class="fu">coef</span>(mod)[<span class="dv">2</span>]</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="corR">
<p>On met en forme les résultats</p>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(matbeta1)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>nom.dim <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"D"</span>,DIM,<span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df) <span class="ot">&lt;-</span> nom.dim</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="corR">
<p>Puis on compare, pour chaque dimension considérée, les distributions de <span class="math inline">\(\widehat\beta_1\)</span> :</p>
<ul>
<li><p>en étudiant le biais et la variance</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">summarise_all</span>(mean)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        D0       D50      D100    D200
1 0.992891 0.9960811 0.9959025 0.98173</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">summarise_all</span>(var)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          D0      D50       D100       D200
1 0.01266578 0.016072 0.02023046 0.06939837</code></pre>
</div>
</div></li>
<li><p>en visualisant la distribution avec un boxplot</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">gather</span>(df,<span class="at">key=</span><span class="st">"dim"</span>,<span class="at">value=</span><span class="st">"erreur"</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df1 <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">dim=</span><span class="fu">fct_relevel</span>(dim,nom.dim))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>dim,<span class="at">y=</span>erreur)<span class="sc">+</span><span class="fu">geom_boxplot</span>()<span class="sc">+</span><span class="fu">theme_classic</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01-intro-grande-dim_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>On retrouve bien que la dimension impacte notamment la variance des estimateurs.</p></li>
</ul>
</div>
</section>
<section id="exercices" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="exercices"><span class="header-section-number">1.3</span> Exercices</h2>
<div id="exr-exo-dist-points" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 1.1 (Distances entre deux points) </strong></span>Cet exercice est fortement inspiré de <span class="citation" data-cites="gir15">Giraud (<a href="references.html#ref-gir15" role="doc-biblioref">2015</a>)</span>. Soit <span class="math inline">\(X^{(1)}=(X_1^{(1)},\dots,X_p^{(1)})\)</span> et <span class="math inline">\(X^{(2)}=(X_1^{(2)},\dots,X_p^{(2)})\)</span> deux variables aléatoires indépendantes de loi uniforme sur l’hypercube <span class="math inline">\([0,1]^p\)</span>. Montrer que <span class="math display">\[\mathbf E[\|X^{(1)}-X^{(2)}\|^2]=\frac{p}{6}\quad\text{et}\quad\sigma[\|X^{(1)}-X^{(2)}\|^2]\approx 0.2\sqrt{p}.\]</span></p>
<div class="correction">
<p>Soit <span class="math inline">\(U\)</span> et <span class="math inline">\(U^\prime\)</span> deux variables aléatoires indépendantes de loi uniforme sur <span class="math inline">\([0,1]\)</span>. On a <span class="math display">\[\mathbf E[\|X^{(1)}-X^{(2)}\|^2]=\sum_{k=1}^p\mathbf E\left[\left(X_k^{(1)}-X_k^{(2)}\right)\right]=p\mathbf E[(U-U^\prime)^2]=p(2\mathbf E[U^2]-2\mathbf E[U]^2)=\frac{p}{6}\]</span> car <span class="math inline">\(\mathbf E[U^2]=1/3\)</span> et <span class="math inline">\(\mathbf E[U]=1/2\)</span>. De même <span class="math display">\[\sigma[\|X^{(1)}-X^{(2)}\|^2]=\sqrt{\sum_{k=1}^p\mathbf V\left[\left(X_k^{(1)}-X_k^{(2)}\right)\right]}=\sqrt{p\mathbf V[(U^\prime-U)^2]}\approx 0.2\sqrt{p}\]</span> car <span class="math display">\[\mathbf E\left[(U^\prime-U)^4\right]=\int_0^1\int_0^1(x-y)^4\,\mathrm{d}x\mathrm{d}y=\frac{1}{15}\]</span> et donc <span class="math inline">\(\mathbf V[(U^\prime-U)^2]=1/15-1/36\approx 0.04\)</span>.</p>
</div>
</div>
<div id="exr-exo-noyau-curse" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 1.2 (Vitesse de convergence pour l’estimateur à noyau) </strong></span>On considère le modèle de régression <span class="math display">\[Y_i=m(x_i)+\varepsilon_i,\quad i=1,\dots,n\]</span> où <span class="math inline">\(x_1,\dots,x_n\in\mathbb R^d\)</span> sont déterministes et <span class="math inline">\(\varepsilon_1,\dots,\varepsilon_n\)</span> sont des variables i.i.d. d’espérance nulle et de variance <span class="math inline">\(\sigma^2&lt;+\infty\)</span>. On désigne par <span class="math inline">\(\|\,.\,\|\)</span> la norme Euclidienne dans <span class="math inline">\(\mathbb R^d\)</span>. On définit l’estimateur localement constant de <span class="math inline">\(m\)</span> en <span class="math inline">\(x\in\mathbb R^d\)</span> par : <span class="math display">\[\hat m(x)=\mathop{\mathrm{argmin}}_{a\in\mathbb R}\sum_{i=1}^n(Y_i-a)^2K\left(\frac{\|x_i-x\|}{h}\right)\]</span> où <span class="math inline">\(h&gt;0\)</span> et pour <span class="math inline">\(u\in\mathbb R,K(u)=\mathbf 1_{[0,1]}(u)\)</span>. On suppose que <span class="math inline">\(\sum_{i=1}^nK\left(\frac{\|x_i-x\|}{h}\right)&gt;0\)</span>.</p>
<ol type="1">
<li><p>Donner la forme explicite de <span class="math inline">\(\hat m(x)\)</span>.</p>
<div class="correction">
<p>En annulant la dérivée par rapport à <span class="math inline">\(a\)</span>, on obtient <span class="math display">\[\hat m(x)=\frac{\sum_{i=1}^nY_iK\left(\frac{\|x_i-x\|}{h}\right)}{\sum_{i=1}^nK\left(\frac{\|x_i-x\|}{h}\right)}.\]</span></p>
</div></li>
<li><p>Montrer que <span class="math display">\[\mathbf V[\hat m(x)]= \frac{\sigma^2}{\sum_{i=1}^nK\left(\frac{\|x_i-x\|}{h}\right)}\]</span> et <span class="math display">\[\mathbf E[\hat m(x)]-m(x)=\frac{\sum_{i=1}^n(m(x_i)-m(x))K\left(\frac{\|x_i-x\|}{h}\right)}{\sum_{i=1}^nK\left(\frac{\|x_i-x\|}{h}\right)}.\]</span></p>
<div class="correction">
<p>Ces propriétés se déduisent directement en remarquant que <span class="math inline">\(\mathbf V[Y_i]=\sigma^2\)</span> et <span class="math inline">\(\mathbf E[Y_i]=m(x_i)\)</span>.</p>
</div></li>
<li><p>On suppose maintenant que <span class="math inline">\(m\)</span> est Lipschitzienne de constante <span class="math inline">\(L\)</span>, c’est-à-dire que <span class="math inline">\(\forall (x_1,x_2)\in\mathbb R^d\times\mathbb R^d\)</span> <span class="math display">\[|m(x_1)-m(x_2)|\leq L\|x_1-x_2\|.\]</span> Montrer que <span class="math display">\[|\textrm{biais}[\hat m(x)]|\leq Lh.\]</span></p>
<div class="correction">
<p>On a <span class="math inline">\(|m(x_i)-m(x)|\leq L\|x_i-x\|\)</span>. Or <span class="math display">\[K\left(\frac{\|x_i-x\|}{h}\right)\]</span> est non nul si et seulement si <span class="math inline">\(\|x_i-x\|\leq h\)</span>. Donc pour tout <span class="math inline">\(i=1,\dots,n\)</span> <span class="math display">\[L\|x_i-x\|K\left(\frac{\|x_i-x\|}{h}\right)\leq Lh K\left(\frac{\|x_i-x\|}{h}\right).\]</span> D’où le résultat.</p>
</div></li>
<li><p>On suppose de plus qu’il existe une constante <span class="math inline">\(C_1\)</span> telle que <span class="math display">\[C_1\leq\frac{\sum_{i=1}^n\mathbf 1_{B_h}(x_i-x)}{n\textrm{Vol}(B_h)},\]</span> où <span class="math inline">\(B_h=\{u\in\mathbb R^d:\|u\|\leq h\}\)</span> est la boule de rayon <span class="math inline">\(h\)</span> dans <span class="math inline">\(\mathbb R^d\)</span> et <span class="math inline">\(\textrm{Vol}(A)\)</span> désigne le volume d’un ensemble <span class="math inline">\(A\subset\mathbb R^d\)</span>. Montrer que <span class="math display">\[\mathbf V[\hat m(x)]\leq\frac{C_2\sigma^2}{nh^d},\]</span> où <span class="math inline">\(C_2\)</span> est une constante dépendant de <span class="math inline">\(C_1\)</span> et <span class="math inline">\(d\)</span> à préciser.</p>
<div class="correction">
<p>On a <span class="math display">\[\mathbf V[\hat m(x)]= \frac{\sigma^2}{\sum_{i=1}^nK\left(\frac{\|x_i-x\|}{h}\right)}=\frac{\sigma^2}{\sum_{i=1}^n\mathbf 1_{B_h}(x_i-x)}.\]</span> Or <span class="math display">\[\sum_{i=1}^n\mathbf 1_{B_h}(x_i-x)\geq C_1n\textrm{Vol}(B_h)\geq C_1\gamma_dnh^d\]</span> où <span class="math inline">\(\gamma_d\)</span> désigne le volume de la boule unité en dimension <span class="math inline">\(d\)</span>. On a donc <span class="math display">\[\mathbf V[\hat m(x)]\leq \frac{\sigma^2}{C_1\gamma_dnh^d}.\]</span></p>
</div></li>
<li><p>Déduire des questions précédentes un majorant de l’erreur quadratique moyenne de <span class="math inline">\(\hat m(x)\)</span>.</p>
<div class="correction">
<p>On déduit <span class="math display">\[\mathbf E[(\hat m(x)-m(x))^2]\leq L^2h^2+\frac{C_2\sigma^2}{nh^d}.\]</span></p>
</div></li>
<li><p>Calculer <span class="math inline">\(h_{\text{opt}}\)</span> la valeur de <span class="math inline">\(h\)</span> qui minimise ce majorant. Que vaut ce majorant lorsque <span class="math inline">\(h=h_{\text{opt}}\)</span> ? Comment varie cette vitesse lorsque <span class="math inline">\(d\)</span> augmente ? Interpréter.</p>
<div class="correction">
<p>Soit <span class="math inline">\(M(h)\)</span> le majorant. On a <span class="math display">\[M(h)^\prime=2hL^2-\frac{C_2\sigma^2d}{n}h^{-d-1}.\]</span> La dérivée s’annule pour <span class="math display">\[h_{\text{opt}}=\frac{2L^2}{C_2\sigma^2d}n^{-\frac{1}{d+2}}.\]</span> Lorsque <span class="math inline">\(h=h_{\text{opt}}\)</span> l’erreur quadratique vérifie <span class="math display">\[\mathbf E[(\hat m(x)-m(x))^2]=\mathrm{O}\left(n^{-\frac{2}{d+2}}\right).\]</span></p>
</div></li>
</ol>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-gir15" class="csl-entry" role="doc-biblioentry">
Giraud, C. 2015. <em>Introduction to High-Dimensional Statistics</em>. CRC Press.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Présentation</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./02-reg-comp.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Régression sur composantes</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>